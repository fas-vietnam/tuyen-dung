(window.webpackJsonp=window.webpackJsonp||[]).push([[20],{1009:function(t,e,r){"use strict";var n=this&&this.__awaiter||function(t,e,r,n){return new(r||(r=Promise))((function(o,i){function l(t){try{u(n.next(t))}catch(t){i(t)}}function s(t){try{u(n.throw(t))}catch(t){i(t)}}function u(t){var e;t.done?o(t.value):(e=t.value,e instanceof r?e:new r((function(t){t(e)}))).then(l,s)}u((n=n.apply(t,e||[])).next())}))},o=this&&this.__generator||function(t,e){var r,n,o,i,l={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(r)throw new TypeError("Generator is already executing.");for(;l;)try{if(r=1,n&&(o=2&i[0]?n.return:i[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,i[1])).done)return o;switch(n=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return l.label++,{value:i[1],done:!1};case 5:l.label++,n=i[1],i=[0];continue;case 7:i=l.ops.pop(),l.trys.pop();continue;default:if(!(o=l.trys,(o=o.length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){l=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){l.label=i[1];break}if(6===i[0]&&l.label<o[1]){l.label=o[1],o=i;break}if(o&&l.label<o[2]){l.label=o[2],l.ops.push(i);break}o[2]&&l.ops.pop(),l.trys.pop();continue}i=e.call(t,l)}catch(t){i=[6,t],n=0}finally{r=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}};Object.defineProperty(e,"__esModule",{value:!0}),e.Renderer=void 0;var i=r(968),l=r(1010),s=r(1012),u=function(){function t(t){void 0===t&&(t=new s.CellTemplatePool),this.cellTemplatePool=t}return t.prototype.render=function(t,e){return n(this,void 0,void 0,(function(){var r,n,i,s;return o(this,(function(o){switch(o.label){case 0:return[4,t()];case 1:return r=o.sent(),[4,t()];case 2:for(n=o.sent(),i=JSON.parse(JSON.stringify(e)),s=new l.Scope(r,n,i);!s.isFinished();)this.cellTemplatePool.match(s.getCurrentTemplateCell()).apply(s);return[2,n]}}))}))},t.prototype.renderFromFile=function(t,e){return n(this,void 0,void 0,(function(){var r=this;return o(this,(function(l){switch(l.label){case 0:return[4,this.render((function(){return n(r,void 0,void 0,(function(){return o(this,(function(e){switch(e.label){case 0:return[4,(new i.Workbook).xlsx.readFile(t)];case 1:return[2,e.sent()]}}))}))}),e)];case 1:return[4,l.sent()];case 2:return[2,l.sent()]}}))}))},t.prototype.renderFromArrayBuffer=function(t,e){return n(this,void 0,void 0,(function(){var r=this;return o(this,(function(l){switch(l.label){case 0:return[4,this.render((function(){return n(r,void 0,void 0,(function(){return o(this,(function(e){switch(e.label){case 0:return[4,(new i.Workbook).xlsx.load(t)];case 1:return[2,e.sent()]}}))}))}),e)];case 1:return[4,l.sent()];case 2:return[2,l.sent()]}}))}))},t}();e.Renderer=u},1010:function(t,e,r){"use strict";var n=this&&this.__assign||function(){return n=Object.assign||function(t){for(var e,r=1,n=arguments.length;r<n;r++)for(var o in e=arguments[r])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t},n.apply(this,arguments)},o=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0}),e.Scope=void 0;var i=o(r(979)),l=function(){function t(t,e,r){this.template=t,this.output=e,this.vm=r,this.outputCell=Object.freeze({r:1,c:1,ws:0}),this.templateCell=Object.freeze({r:1,c:1,ws:0}),this.frozen=0,this.finished=!1}return t.prototype.getCurrentTemplateString=function(){var t;return(null===(t=this.getCurrentTemplateValue())||void 0===t?void 0:t.toString())||""},t.prototype.getCurrentTemplateValue=function(){return this.getCurrentTemplateCell().value},t.prototype.getCurrentTemplateCell=function(){return this.template.worksheets[this.templateCell.ws].getCell(this.templateCell.r,this.templateCell.c)},t.prototype.setCurrentOutputValue=function(t){this.frozen||(this.output.worksheets[this.outputCell.ws].getCell(this.outputCell.r,this.outputCell.c).value=t)},t.prototype.applyStyles=function(){if(!this.frozen){var t=this.templateCell,e=this.template.worksheets[t.ws],r=this.outputCell,n=this.output.worksheets[r.ws];n.getRow(r.r).height=e.getRow(t.r).height,n.getCell(r.r,r.c).style=e.getCell(t.r,t.c).style,e.getColumn(t.c).isCustomWidth&&(n.getColumn(r.c).width=e.getColumn(t.c).width)}},t.prototype.applyMerge=function(){var t=this.template.worksheets[this.templateCell.ws],e=t.getCell(this.templateCell.r,this.templateCell.c),r=this.output.worksheets[this.outputCell.ws];if(e.isMerged&&e.address===(e.master&&e.master.address)){var n=t._merges[e.master.address],o=n.top,l=n.bottom,s=t._merges[e.master.address],u=s.left,a=s.right,p=this.outputCell.r-o;o+=p,l+=p;var c=new i.default(o,u,l,a).shortRange;r.unMergeCells(c),r.mergeCells(c)}},t.prototype.incrementCol=function(){this.finished||(this.templateCell=Object.freeze(n(n({},this.templateCell),{c:this.templateCell.c+1}))),this.outputCell=Object.freeze(n(n({},this.outputCell),{c:this.outputCell.c+1}))},t.prototype.incrementRow=function(){this.finished||(this.templateCell=Object.freeze(n(n({},this.templateCell),{r:this.templateCell.r+1,c:1}))),this.frozen?this.outputCell=Object.freeze(n(n({},this.outputCell),{c:1})):this.outputCell=Object.freeze(n(n({},this.outputCell),{r:this.outputCell.r+1,c:1}))},t.prototype.freezeOutput=function(){this.frozen++},t.prototype.unfreezeOutput=function(){this.frozen=Math.max(this.frozen-1,0)},t.prototype.isFrozen=function(){return this.frozen>0},t.prototype.finish=function(){this.finished=!0,this.unfreezeOutput()},t.prototype.isFinished=function(){return this.finished},t.prototype.isOutOfColLimit=function(){return this.outputCell.c>16383},t}();e.Scope=l},1011:function(t,e){const r=/^[A-Z]+\d+$/,n={_dictionary:["A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"],_l2nFill:0,_l2n:{},_n2l:[],_level:t=>t<=26?1:t<=676?2:3,_fill(t){let e,r,n,o,i,l=1;if(t>=4)throw new Error("Out of bounds. Excel supports columns from 1 to 16384");if(this._l2nFill<1&&t>=1){for(;l<=26;)e=this._dictionary[l-1],this._n2l[l]=e,this._l2n[e]=l,l++;this._l2nFill=1}if(this._l2nFill<2&&t>=2){for(l=27;l<=702;)r=l-27,n=r%26,o=Math.floor(r/26),e=this._dictionary[o]+this._dictionary[n],this._n2l[l]=e,this._l2n[e]=l,l++;this._l2nFill=2}if(this._l2nFill<3&&t>=3){for(l=703;l<=16384;)r=l-703,n=r%26,o=Math.floor(r/26)%26,i=Math.floor(r/676),e=this._dictionary[i]+this._dictionary[o]+this._dictionary[n],this._n2l[l]=e,this._l2n[e]=l,l++;this._l2nFill=3}},l2n(t){if(this._l2n[t]||this._fill(t.length),!this._l2n[t])throw new Error(`Out of bounds. Invalid column letter: ${t}`);return this._l2n[t]},n2l(t){if(t<1||t>16384)throw new Error(`${t} is out of bounds. Excel supports columns from 1 to 16384`);return this._n2l[t]||this._fill(this._level(t)),this._n2l[t]},_hash:{},validateAddress(t){if(!r.test(t))throw new Error(`Invalid Address: ${t}`);return!0},decodeAddress(t){const e=t.length<5&&this._hash[t];if(e)return e;let r=!1,n="",o=0,i=!1,l="",s=0;for(let e,u=0;u<t.length;u++)if(e=t.charCodeAt(u),!i&&e>=65&&e<=90)r=!0,n+=t[u],o=26*o+e-64;else if(e>=48&&e<=57)i=!0,l+=t[u],s=10*s+e-48;else if(i&&r&&36!==e)break;if(r){if(o>16384)throw new Error(`Out of bounds. Invalid column letter: ${n}`)}else o=void 0;i||(s=void 0);const u={address:t=n+l,col:o,row:s,$col$row:`$${n}$${l}`};return o<=100&&s<=100&&(this._hash[t]=u,this._hash[u.$col$row]=u),u},getAddress(t,e){if(e){const r=this.n2l(e)+t;return this.decodeAddress(r)}return this.decodeAddress(t)},decode(t){const e=t.split(":");if(2===e.length){const t=this.decodeAddress(e[0]),r=this.decodeAddress(e[1]),n={top:Math.min(t.row,r.row),left:Math.min(t.col,r.col),bottom:Math.max(t.row,r.row),right:Math.max(t.col,r.col)};return n.tl=this.n2l(n.left)+n.top,n.br=this.n2l(n.right)+n.bottom,n.dimensions=`${n.tl}:${n.br}`,n}return this.decodeAddress(t)},decodeEx(t){const e=t.match(/(?:(?:(?:'((?:[^']|'')*)')|([^'^ !]*))!)?(.*)/),r=e[1]||e[2],n=e[3],o=n.split(":");if(o.length>1){let t=this.decodeAddress(o[0]),e=this.decodeAddress(o[1]);const n=Math.min(t.row,e.row),i=Math.min(t.col,e.col),l=Math.max(t.row,e.row),s=Math.max(t.col,e.col);return t=this.n2l(i)+n,e=this.n2l(s)+l,{top:n,left:i,bottom:l,right:s,sheetName:r,tl:{address:t,col:i,row:n,$col$row:`$${this.n2l(i)}$${n}`,sheetName:r},br:{address:e,col:s,row:l,$col$row:`$${this.n2l(s)}$${l}`,sheetName:r},dimensions:`${t}:${e}`}}if(n.startsWith("#"))return r?{sheetName:r,error:n}:{error:n};const i=this.decodeAddress(n);return r?{sheetName:r,...i}:i},encodeAddress:(t,e)=>n.n2l(e)+t,encode(){switch(arguments.length){case 2:return n.encodeAddress(arguments[0],arguments[1]);case 4:return`${n.encodeAddress(arguments[0],arguments[1])}:${n.encodeAddress(arguments[2],arguments[3])}`;default:throw new Error("Can only encode with 2 or 4 arguments")}},inRange(t,e){const[r,n,,o,i]=t,[l,s]=e;return l>=r&&l<=o&&s>=n&&s<=i}};t.exports=n},1012:function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.CellTemplatePool=void 0;var n=r(1013),o=r(1014),i=r(1015),l=r(1016),s=r(1017),u=r(980),a=r(1018),p=r(1019),c=r(1020),h=r(1021),f=r(1022),d=r(1023),m=r(1024),_=r(1025),y=r(1026),g=r(1027),v=function(){function t(){this.cells=[n.NormalCell,c.EndRowCell,l.VariableCell,i.TemplateStringCell,o.TemplateFormulaCell,g.FormulaCell,y.HyperlinkCell,u.ForEachCell,s.FinishCell,p.EndLoopCell,a.ContinueCell,m.DumpColsCell,h.SumCell,f.AverageCell,_.WsNameCell,d.DeleteCell],this.instances=new Map}return t.prototype.match=function(t){var e=this.cells.find((function(e){return e.match(t)}))||n.NormalCell;return this.instances.has(e)||this.instances.set(e,new e),this.instances.get(e)},t}();e.CellTemplatePool=v},1013:function(t,e,r){"use strict";var n,o=this&&this.__extends||(n=function(t,e){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])},n(t,e)},function(t,e){function r(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)});Object.defineProperty(e,"__esModule",{value:!0}),e.NormalCell=void 0;var i=r(968),l=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return o(e,t),e.match=function(t){return t&&t.type===i.ValueType.String&&"string"==typeof t.value&&!["##","#!","#=","#`"].includes(t.value.substring(0,2))},e.prototype.apply=function(e){return t.prototype.apply.call(this,e),e.incrementCol(),this},e}(r(969).BaseCell);e.NormalCell=l},1014:function(t,e,r){"use strict";var n,o=this&&this.__extends||(n=function(t,e){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])},n(t,e)},function(t,e){function r(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)});Object.defineProperty(e,"__esModule",{value:!0}),e.TemplateFormulaCell=void 0;var i=r(969),l=r(968),s=/\${[^{]+?}/g,u=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return o(e,t),e.match=function(t){return t&&t.type===l.ValueType.String&&(!t.isMerged||t.master.address===t.address)&&"string"==typeof t.value&&"#= "===t.value.substring(0,3)},e.prototype.apply=function(e){t.prototype.apply.call(this,e);var r=e.getCurrentTemplateString().substring(3).replace(s,(function(t){var r=t.slice(2,-1).split("."),n=r.reduce((function(t,e){return"object"==typeof t?t[e]:t}),e.vm);return void 0!==n||e.isFrozen()||console.warn("WARN: "+r+" is undefined for template formula output: "+JSON.stringify(e.outputCell)+" when template is:"+JSON.stringify(e.templateCell)),n}));return e.setCurrentOutputValue({formula:r}),e.incrementCol(),this},e}(i.BaseCell);e.TemplateFormulaCell=u},1015:function(t,e,r){"use strict";var n,o=this&&this.__extends||(n=function(t,e){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])},n(t,e)},function(t,e){function r(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)});Object.defineProperty(e,"__esModule",{value:!0}),e.TemplateStringCell=void 0;var i=r(969),l=r(968),s=/\${[^{]+?}/g,u=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return o(e,t),e.match=function(t){return t&&t.type===l.ValueType.String&&(!t.isMerged||t.master.address===t.address)&&"string"==typeof t.value&&"#` "===t.value.substring(0,3)},e.prototype.apply=function(e){t.prototype.apply.call(this,e);var r=e.getCurrentTemplateString().substring(3).replace(s,(function(t){var r=t.slice(2,-1).split("."),n=r.reduce((function(t,e){return"object"==typeof t?t[e]:t}),e.vm);return void 0!==n||e.isFrozen()||console.warn("WARN: "+r+" is undefined for template string output: "+JSON.stringify(e.outputCell)+" when template is:"+JSON.stringify(e.templateCell)),n}));return e.setCurrentOutputValue(r),e.incrementCol(),this},e}(i.BaseCell);e.TemplateStringCell=u},1016:function(t,e,r){"use strict";var n,o=this&&this.__extends||(n=function(t,e){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])},n(t,e)},function(t,e){function r(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)});Object.defineProperty(e,"__esModule",{value:!0}),e.VariableCell=void 0;var i=r(969),l=r(968),s=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return o(e,t),e.match=function(t){return t&&t.type===l.ValueType.String&&(!t.isMerged||t.master.address===t.address)&&"string"==typeof t.value&&"##"===t.value.substring(0,2)},e.prototype.apply=function(e){t.prototype.apply.call(this,e);var r=e.getCurrentTemplateString().substring(3).split("."),n=r.reduce((function(t,e){return"object"==typeof t?t[e]:t}),e.vm);return void 0!==n||e.isFrozen()||console.warn("WARN: "+r+" is undefined for output: "+JSON.stringify(e.outputCell)+" when template is:"+JSON.stringify(e.templateCell)),e.setCurrentOutputValue(n),e.incrementCol(),this},e}(i.BaseCell);e.VariableCell=s},1017:function(t,e,r){"use strict";var n,o=this&&this.__extends||(n=function(t,e){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])},n(t,e)},function(t,e){function r(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__assign||function(){return i=Object.assign||function(t){for(var e,r=1,n=arguments.length;r<n;r++)for(var o in e=arguments[r])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t},i.apply(this,arguments)};Object.defineProperty(e,"__esModule",{value:!0}),e.FinishCell=void 0;var l=r(969),s=r(968),u=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return o(e,t),e.match=function(t){return t&&t.type===s.ValueType.String&&"string"==typeof t.value&&"#! FINISH"===t.value.substring(0,9)},e.getCondition=function(t){var e=t.getCurrentTemplateString().split(" ");return e.length<3||!!e[2].split(".").reduce((function(t,e){return void 0===t||void 0===t[e]||t[e]}),t.vm)},e.prototype.apply=function(r){t.prototype.apply.call(this,r),r.setCurrentOutputValue(null);var n=r.template.worksheets[r.templateCell.ws];if(e.getCondition(r)){var o=r.templateCell.ws+1;(n=r.template.worksheets[o])?(r.templateCell=Object.freeze(i(i({},r.templateCell),{ws:r.templateCell.ws+1,r:1,c:1})),r.outputCell=Object.freeze(i(i({},r.outputCell),{ws:r.outputCell.ws+1,r:1,c:1})),r.unfreezeOutput()):r.finish()}else{var l=r.output.addWorksheet("Sheet "+(r.outputCell.ws+1),n);r.templateCell=Object.freeze(i(i({},r.templateCell),{r:1,c:1})),r.outputCell=Object.freeze(i(i({},r.outputCell),{ws:r.outputCell.ws+1,r:1,c:1})),n.getImages().forEach((function(t){return l.addImage(+t.imageId,t.range)}))}return this},e}(l.BaseCell);e.FinishCell=u},1018:function(t,e,r){"use strict";var n,o=this&&this.__extends||(n=function(t,e){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])},n(t,e)},function(t,e){function r(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)});Object.defineProperty(e,"__esModule",{value:!0}),e.ContinueCell=void 0;var i=r(980),l=r(968),s=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return o(e,t),e.match=function(t){return t&&t.type===l.ValueType.String&&"string"==typeof t.value&&"#! CONTINUE"===t.value.substring(0,11)},e.prototype.getSourceParam=function(t){var e=i.ForEachCell.getTargetParam(t);return t.vm[e]&&t.vm[e].__from},e}(i.ForEachCell);e.ContinueCell=s},1019:function(t,e,r){"use strict";var n,o=this&&this.__extends||(n=function(t,e){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])},n(t,e)},function(t,e){function r(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__assign||function(){return i=Object.assign||function(t){for(var e,r=1,n=arguments.length;r<n;r++)for(var o in e=arguments[r])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t},i.apply(this,arguments)};Object.defineProperty(e,"__esModule",{value:!0}),e.EndLoopCell=void 0;var l=r(969),s=r(968),u=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return o(e,t),e.match=function(t){return t&&t.type===s.ValueType.String&&"string"==typeof t.value&&"#! END_LOOP"===t.value.substring(0,11)},e.prototype.apply=function(e){t.prototype.apply.call(this,e);var r=e.getCurrentTemplateString().split(" ")[2],n=e.vm[r]&&e.vm[r].__start,o=e.vm[r]&&e.vm[r].__iterated;e.unfreezeOutput();return e.vm[r]=Object.freeze(i(i({},e.vm[r]),{__end:e.templateCell,__insetRows:true,__insertRows:true})),n&&!o?e.templateCell=n:e.incrementRow(),this},e}(l.BaseCell);e.EndLoopCell=u},1020:function(t,e,r){"use strict";var n,o=this&&this.__extends||(n=function(t,e){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])},n(t,e)},function(t,e){function r(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)});Object.defineProperty(e,"__esModule",{value:!0}),e.EndRowCell=void 0;var i=r(969),l=r(968),s=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return o(e,t),e.match=function(t){return t&&t.type===l.ValueType.String&&"string"==typeof t.value&&"#! END_ROW"===t.value},e.prototype.apply=function(e){return t.prototype.apply.call(this,e),e.setCurrentOutputValue(null),e.incrementRow(),this},e}(i.BaseCell);e.EndRowCell=s},1021:function(t,e,r){"use strict";var n,o=this&&this.__extends||(n=function(t,e){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])},n(t,e)},function(t,e){function r(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)});Object.defineProperty(e,"__esModule",{value:!0}),e.SumCell=void 0;var i=r(969),l=r(968),s=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return o(e,t),e.match=function(t){return t&&t.type===l.ValueType.String&&"string"==typeof t.value&&"#! SUM"===t.value.substring(0,6)},e.getTargetParam=function(t){return t.getCurrentTemplateString().split(" ")[2]},e.prototype.apply=function(r){t.prototype.apply.call(this,r);var n=e.getTargetParam(r),o=r.vm[n]&&r.vm[n].__startOutput,i=r.vm[n]&&r.vm[n].__endOutput;if(o&&i){var l=r.output.worksheets[r.outputCell.ws].getCell(o,r.outputCell.c).address,s=r.output.worksheets[r.outputCell.ws].getCell(i,r.outputCell.c).address;r.setCurrentOutputValue({formula:"sum("+l+":"+s+")"})}return r.incrementCol(),this},e}(i.BaseCell);e.SumCell=s},1022:function(t,e,r){"use strict";var n,o=this&&this.__extends||(n=function(t,e){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])},n(t,e)},function(t,e){function r(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)});Object.defineProperty(e,"__esModule",{value:!0}),e.AverageCell=void 0;var i=r(969),l=r(968),s=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return o(e,t),e.match=function(t){return t&&t.type===l.ValueType.String&&"string"==typeof t.value&&"#! AVERAGE"===t.value.substring(0,10)},e.getTargetParam=function(t){return t.getCurrentTemplateString().split(" ")[2]},e.prototype.apply=function(r){t.prototype.apply.call(this,r);var n=e.getTargetParam(r),o=r.vm[n]&&r.vm[n].__startOutput,i=r.vm[n]&&r.vm[n].__endOutput;if(o&&i){var l=r.output.worksheets[r.outputCell.ws].getCell(o,r.outputCell.c).address,s=r.output.worksheets[r.outputCell.ws].getCell(i,r.outputCell.c).address;r.setCurrentOutputValue({formula:"average("+l+":"+s+")"})}return r.incrementCol(),this},e}(i.BaseCell);e.AverageCell=s},1023:function(t,e,r){"use strict";var n,o=this&&this.__extends||(n=function(t,e){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])},n(t,e)},function(t,e){function r(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)});Object.defineProperty(e,"__esModule",{value:!0}),e.DeleteCell=void 0;var i=r(969),l=r(968),s=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return o(e,t),e.match=function(t){return t&&t.type===l.ValueType.String&&"string"==typeof t.value&&"#! DELETE"===t.value.substring(0,9)},e.prototype.apply=function(e){t.prototype.apply.call(this,e);var r=e.getCurrentTemplateString().split(" ")[2];return void 0!==r&&(e.vm[r]=void 0),e.setCurrentOutputValue(null),e.incrementCol(),this},e}(i.BaseCell);e.DeleteCell=s},1024:function(t,e,r){"use strict";var n,o=this&&this.__extends||(n=function(t,e){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])},n(t,e)},function(t,e){function r(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__assign||function(){return i=Object.assign||function(t){for(var e,r=1,n=arguments.length;r<n;r++)for(var o in e=arguments[r])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t},i.apply(this,arguments)};Object.defineProperty(e,"__esModule",{value:!0}),e.DumpColsCell=void 0;var l=r(969),s=r(968),u=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return o(e,t),e.match=function(t){return t&&t.type===s.ValueType.String&&"string"==typeof t.value&&"#! DUMP_COLS"===t.value.substring(0,12)},e.prototype.apply=function(e){t.prototype.apply.call(this,e);var r=e.getCurrentTemplateString().substring(13).split("."),n=Array.from(r).reduce((function(t,e){return t[e]||[]}),e.vm);return e.setCurrentOutputValue(null),n.forEach((function(t){e.setCurrentOutputValue(t),e.applyStyles(),e.outputCell=Object.freeze(i(i({},e.outputCell),{c:e.outputCell.c+1}))})),e.incrementCol(),this},e}(l.BaseCell);e.DumpColsCell=u},1025:function(t,e,r){"use strict";var n,o=this&&this.__extends||(n=function(t,e){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])},n(t,e)},function(t,e){function r(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)});Object.defineProperty(e,"__esModule",{value:!0}),e.WsNameCell=void 0;var i=r(969),l=r(968),s=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return o(e,t),e.match=function(t){return t&&t.type===l.ValueType.String&&"string"==typeof t.value&&"#! WS_NAME"===t.value.substring(0,10)},e._getName=function(t){var r=e._getTargetValue(t)||e._getTarget(t);return r=r.replace(/[\\\/*\[\]?]/g,"."),t.output.worksheets.find((function(t){return t.name===r}))&&(r+=" "+t.outputCell.ws),r=r.length>31?r.substr(r.length-31):r},e._getTargetValue=function(t){return e._getTarget(t).split(".").reduce((function(t,e){return t[e]||""}),t.vm)},e._getTarget=function(t){return t.getCurrentTemplateString().split(" ")[2]},e.prototype.apply=function(r){return t.prototype.apply.call(this,r),r.setCurrentOutputValue(null),r.output.worksheets[r.outputCell.ws].name=e._getName(r),r.incrementCol(),this},e}(i.BaseCell);e.WsNameCell=s},1026:function(t,e,r){"use strict";var n,o=this&&this.__extends||(n=function(t,e){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])},n(t,e)},function(t,e){function r(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)});Object.defineProperty(e,"__esModule",{value:!0}),e.HyperlinkCell=void 0;var i=r(969),l=r(968),s=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return o(e,t),e.match=function(t){return t&&t.type===l.ValueType.String&&"string"==typeof t.value&&"#! HYPERLINK"===t.value.substring(0,12)},e.getLabelParam=function(t){return t.getCurrentTemplateString().split(" ")[2]},e.getUrlParam=function(t){return t.getCurrentTemplateString().split(" ")[3]},e.prototype.apply=function(r){t.prototype.apply.call(this,r),r.setCurrentOutputValue(null);var n=e.getUrlParam(r).split(".").reduce((function(t,e){return t[e]||{}}),r.vm);if("string"==typeof n){var o=e.getLabelParam(r).split(".").reduce((function(t,e){return t[e]||{}}),r.vm)||n;r.setCurrentOutputValue({text:o,hyperlink:n})}return r.incrementCol(),this},e}(i.BaseCell);e.HyperlinkCell=s},1027:function(t,e,r){"use strict";var n,o=this&&this.__extends||(n=function(t,e){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])},n(t,e)},function(t,e){function r(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)});Object.defineProperty(e,"__esModule",{value:!0}),e.FormulaCell=void 0;var i=r(969),l=r(968),s=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return o(e,t),e.match=function(t){return t&&t.type===l.ValueType.Formula},e.prototype.apply=function(e){t.prototype.apply.call(this,e);for(var r=e.outputCell.r-e.templateCell.r,n=/([a-zA-Z]+)([1-9][0-9]*)/g,o=e.getCurrentTemplateValue().formula,i=[];;){var l=n.exec(o);if(null===l)break;i.push({index:l.index,col:l[1],row:+l[2],len:l[0].length})}i.reverse();var s=Array.from(o);return i.forEach((function(t){return s.splice(t.index,t.len,""+t.col+(t.row+r))})),o=s.join(""),e.setCurrentOutputValue({formula:o}),e.incrementCol(),this},e}(i.BaseCell);e.FormulaCell=s},969:function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.BaseCell=void 0;var n=function(){function t(){if("BaseCell"===this.constructor.name)throw new TypeError("Cannot construct "+t.name+" instances directly. It's abstract.")}return t.match=function(t){return!1},t.isMasterCell=function(t){var e=t.template.worksheets[t.templateCell.ws].getCell(t.templateCell.r,t.templateCell.c);return!(e&&e.isMerged&&e.master&&e.master.address!==e.address)},t.prototype.apply=function(e){return e.isOutOfColLimit()&&e.finish(),t.isMasterCell(e)&&(e.setCurrentOutputValue(e.getCurrentTemplateValue()),e.applyStyles()),e.applyMerge(),this},t}();e.BaseCell=n},979:function(t,e,r){const n=r(1011);class o{constructor(){this.decode(arguments)}setTLBR(t,e,r,o,i){if(arguments.length<4){const o=n.decodeAddress(t),l=n.decodeAddress(e);this.model={top:Math.min(o.row,l.row),left:Math.min(o.col,l.col),bottom:Math.max(o.row,l.row),right:Math.max(o.col,l.col),sheetName:r},this.setTLBR(o.row,o.col,l.row,l.col,i)}else this.model={top:Math.min(t,r),left:Math.min(e,o),bottom:Math.max(t,r),right:Math.max(e,o),sheetName:i}}decode(t){switch(t.length){case 5:this.setTLBR(t[0],t[1],t[2],t[3],t[4]);break;case 4:this.setTLBR(t[0],t[1],t[2],t[3]);break;case 3:this.setTLBR(t[0],t[1],t[2]);break;case 2:this.setTLBR(t[0],t[1]);break;case 1:{const e=t[0];if(e instanceof o)this.model={top:e.model.top,left:e.model.left,bottom:e.model.bottom,right:e.model.right,sheetName:e.sheetName};else if(e instanceof Array)this.decode(e);else if(e.top&&e.left&&e.bottom&&e.right)this.model={top:e.top,left:e.left,bottom:e.bottom,right:e.right,sheetName:e.sheetName};else{const t=n.decodeEx(e);t.top?this.model={top:t.top,left:t.left,bottom:t.bottom,right:t.right,sheetName:t.sheetName}:this.model={top:t.row,left:t.col,bottom:t.row,right:t.col,sheetName:t.sheetName}}break}case 0:this.model={top:0,left:0,bottom:0,right:0};break;default:throw new Error(`Invalid number of arguments to _getDimensions() - ${t.length}`)}}get top(){return this.model.top||1}set top(t){this.model.top=t}get left(){return this.model.left||1}set left(t){this.model.left=t}get bottom(){return this.model.bottom||1}set bottom(t){this.model.bottom=t}get right(){return this.model.right||1}set right(t){this.model.right=t}get sheetName(){return this.model.sheetName}set sheetName(t){this.model.sheetName=t}get _serialisedSheetName(){const{sheetName:t}=this.model;return t?/^[a-zA-Z0-9]*$/.test(t)?`${t}!`:`'${t}'!`:""}expand(t,e,r,n){(!this.model.top||t<this.top)&&(this.top=t),(!this.model.left||e<this.left)&&(this.left=e),(!this.model.bottom||r>this.bottom)&&(this.bottom=r),(!this.model.right||n>this.right)&&(this.right=n)}expandRow(t){if(t){const{dimensions:e,number:r}=t;e&&this.expand(r,e.min,r,e.max)}}expandToAddress(t){const e=n.decodeEx(t);this.expand(e.row,e.col,e.row,e.col)}get tl(){return n.n2l(this.left)+this.top}get $t$l(){return`$${n.n2l(this.left)}$${this.top}`}get br(){return n.n2l(this.right)+this.bottom}get $b$r(){return`$${n.n2l(this.right)}$${this.bottom}`}get range(){return`${this._serialisedSheetName+this.tl}:${this.br}`}get $range(){return`${this._serialisedSheetName+this.$t$l}:${this.$b$r}`}get shortRange(){return this.count>1?this.range:this._serialisedSheetName+this.tl}get $shortRange(){return this.count>1?this.$range:this._serialisedSheetName+this.$t$l}get count(){return(1+this.bottom-this.top)*(1+this.right-this.left)}toString(){return this.range}intersects(t){return(!t.sheetName||!this.sheetName||t.sheetName===this.sheetName)&&(!(t.bottom<this.top)&&(!(t.top>this.bottom)&&(!(t.right<this.left)&&!(t.left>this.right))))}contains(t){const e=n.decodeEx(t);return this.containsEx(e)}containsEx(t){return(!t.sheetName||!this.sheetName||t.sheetName===this.sheetName)&&(t.row>=this.top&&t.row<=this.bottom&&t.col>=this.left&&t.col<=this.right)}forEachAddress(t){for(let e=this.left;e<=this.right;e++)for(let r=this.top;r<=this.bottom;r++)t(n.encodeAddress(r,e),r,e)}}t.exports=o},980:function(t,e,r){"use strict";var n,o=this&&this.__extends||(n=function(t,e){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])},n(t,e)},function(t,e){function r(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__assign||function(){return i=Object.assign||function(t){for(var e,r=1,n=arguments.length;r<n;r++)for(var o in e=arguments[r])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t},i.apply(this,arguments)},l=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0}),e.ForEachCell=void 0;var s=r(969),u=r(968),a=l(r(979)),p=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return o(e,t),e.match=function(t){return t&&t.type===u.ValueType.String&&"string"==typeof t.value&&"#! FOR_EACH"===t.value.substring(0,11)},e.getTargetParam=function(t){return t.getCurrentTemplateString().split(" ")[2]},e.shiftMergedCells=function(t,e,r){var n=t.r-e.r,o=r.output.worksheets[r.outputCell.ws],i=o._merges;o._merges=Object.keys(i).reduce((function(e,r){if(i[r].top>t.r){var o=i[r].model,l=o.top,s=o.bottom,u=i[r].model,p=u.left,c=u.right,h=u.sheetName;l+=n,s+=n;var f=new a.default(l,p,s,c,h);e[f.tl]=f}else e[r]=i[r];return e}),{})},e.prototype.apply=function(r){var n=e.getTargetParam(r),o=this.getSourceParam(r),l=(r.vm[n]&&r.vm[n].__index||0)+1;1===l&&t.prototype.apply.call(this,r);var s=r.vm[n]&&r.vm[n].__start||r.templateCell,u=r.vm[n]&&r.vm[n].__startOutput||r.outputCell.r+1,a=r.vm[n]&&r.vm[n].__end,p=void 0===o.split(".").reduce((function(t,e){return t[e]||{}}),r.vm)[l],c=r.vm[n]&&r.vm[n].__endOutput,h=r.vm[n]&&r.vm[n].__insertRows||!1,f=o.split(".").reduce((function(t,e){return t[e]||{}}),r.vm)[l-1],d=r.vm[n]&&r.vm[n].__iterated;if(d=void 0!==d&&d,r.setCurrentOutputValue(null),d||f||(d=!0,r.freezeOutput()),f=f||{},h&&(h=!1,!r.isFrozen())){for(var m=a.r;m>s.r;m--)r.output.worksheets[r.outputCell.ws].spliceRows(r.outputCell.r+1,0,[]);e.shiftMergedCells(a,s,r)}return d&&(c=c||r.outputCell.r),r.incrementRow(),r.vm[n]=Object.freeze(i(i({},f),{__from:o,__index:l,__start:s,__end:a,__iterated:d,__insetRows:h,__insertRows:h,__startOutput:u,__endOutput:c,__last:p})),this},e.prototype.getSourceParam=function(t){return t.getCurrentTemplateString().split(" ")[3]},e}(s.BaseCell);e.ForEachCell=p}}]);
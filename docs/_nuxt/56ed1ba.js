(window.webpackJsonp=window.webpackJsonp||[]).push([[14],{1030:function(t,e,a){"use strict";a(982)},1031:function(t,e,a){var i=a(12)(!1);i.push([t.i,".tbl-kaikei-header{background-color:#0ff!important;color:#00008b}.row-kaikei-all td{background-color:#ff0;font-weight:bolder;font-size:1.2rem!important}.row-kaikei-jikan td{background-color:#d3d3d3;font-weight:700}.row-note td{font-size:.7rem!important;font-style:italic;background-color:#ffefd5}.cell-kaikei-percent{font-weight:700}.cell-kaikei-percent-all{font-weight:700;color:red}#page-thuc-tich-ircs-hinban{font-family:ＭＳ Ｐゴシック}#page-thuc-tich-ircs-hinban .tbl-header{background-color:#deb887!important;font-size:1.2rem!important;padding:0 8px!important;color:#00008b}#page-thuc-tich-ircs-hinban .text--center{text-align:center!important}#page-thuc-tich-ircs-hinban .cell-boilder{text-align:left;font-weight:bolder}#page-thuc-tich-ircs-hinban .cell-normal{padding:0 3px!important;text-align:left;font-size:1.1rem}#page-thuc-tich-ircs-hinban .cell-sub{padding:0!important;background-color:#40e0d0}#page-thuc-tich-ircs-hinban .cell-number{padding:0 3px!important;text-align:right;font-size:1.6rem}#page-thuc-tich-ircs-hinban .cell-percent{padding:0 3px!important;font-size:1.5rem}#page-thuc-tich-ircs-hinban .cell-shiji{text-align:right;font-size:1.8rem;color:#f0f;background-color:#fdf5e6}#page-thuc-tich-ircs-hinban .cell-total{text-align:right;font-size:1.8rem;color:green;background-color:#fdf5e6}#page-thuc-tich-ircs-hinban .cell-new-hin{background-color:orange!important}#page-thuc-tich-ircs-hinban .cell-comback-hin{background-color:#ff69b4!important}#page-thuc-tich-ircs-hinban .row-normal td{font-size:1.8rem!important}#page-thuc-tich-ircs-hinban .row-sum td{background-color:#d3d3d3}#page-thuc-tich-ircs-hinban .cell-zero{color:#00f}#page-thuc-tich-ircs-hinban .cell-negative{color:red}#page-thuc-tich-ircs-hinban .tbl-sub td{border:1px solid tomato;padding:0 2px}#page-thuc-tich-ircs-hinban table{border-collapse:collapse}#page-thuc-tich-ircs-hinban .v-data-footer__select .v-select{margin-top:1px!important;margin-bottom:1px!important}#page-thuc-tich-ircs-hinban.mobile .tbl-header{font-size:.6rem!important}#page-thuc-tich-ircs-hinban.mobile .lineHeader{min-width:50px}#page-thuc-tich-ircs-hinban.mobile .assyDateHeader{min-width:65px}#page-thuc-tich-ircs-hinban.mobile .cell-normal,#page-thuc-tich-ircs-hinban.mobile .cell-number{font-size:.7rem}#page-thuc-tich-ircs-hinban.mobile .cell-shiji,#page-thuc-tich-ircs-hinban.mobile .cell-total{font-size:.8rem;font-weight:700}#page-thuc-tich-ircs-hinban.mobile .row-normal td{font-size:.7rem!important}",""]),t.exports=i},1051:function(t,e,a){"use strict";a.r(e),a.d(e,"timeMask",(function(){return _})),a.d(e,"timeRangeMask",(function(){return u}));a(8),a(9),a(10);var i,n=a(1),l=a(43),r=a(20);a(130),a(26),a(28),a(83),a(7),a(4),a(5),a(25),a(54),a(163),a(584),a(52),a(585),a(586),a(587),a(588),a(589),a(590),a(591),a(592),a(593),a(594),a(595),a(596),a(597),a(598),a(599),a(600),a(68),a(38),a(6),a(36),a(259),a(57);function s(t,e){var a=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),a.push.apply(a,i)}return a}function o(t){for(var e=1;e<arguments.length;e++){var a=null!=arguments[e]?arguments[e]:{};e%2?s(Object(a),!0).forEach((function(e){Object(n.a)(t,e,a[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(a)):s(Object(a)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(a,e))}))}return t}var c=a(970);function _(t){var e=[/[0-2]/,"2"===t.charAt(0)?/[0-3]/:/[0-9]/];return t.length>2?[].concat(e,[":"],[/[0-5]/,/[0-9]/]):e}function u(t){var e=t.replace(/[^0-9]/g,"");return e.length>4?[].concat(Object(r.a)(_(e.substring(0,4))),["-"],Object(r.a)(_(e.substring(4)))):Object(r.a)(_(e))}var d,C=(i={head:{title:"品番-IRCS 実績"},data:function(){return{timeRangeMask:u,alert:!1,kameStyle:!1,ttIrcsHinbanData:[],nhanCongData:[],selectedDate:null,selectedSGDate:null,selectedLine:null,mSelectDate:!1,mSelectSGDate:null,mSelecMasterKaikeiDate:null,mSelecKaikeiExpDate:null,kaikeiDialog:!1,dateScope:[],rawFile:null,xlsData:[],title:"品番-IRCS 実績 - Thực tích IRCS theo Sản Phẩm",initData:null,loading:!1,today:(new Date).toISOString().substring(0,10),maxNichiCol:3,selectedStatus:"ALL",statusOptionsItems:[{text:"ALL",value:"ALL"},{text:"中",value:"中"},{text:"完成",value:"完成"},{text:"未完成",value:"未完成"},{text:"まだ",value:"まだ"}],percentFormatter:new Intl.NumberFormat("en-US",{style:"percent",maximumFractionDigits:2}),kaikei:{d_assy:null,ca:null,line:null,masterRes:[],selectedMasterItems:[],editingMasterItem:{},masterHeader:[{value:"ACTION",text:"ACTION",class:["tbl-kaikei-header"],width:50},{value:"D_ASSY",text:"Ngày Assy",class:["tbl-kaikei-header"],width:70},{value:"C_LINE",text:"LINE",class:["tbl-kaikei-header"],width:70},{value:"C_CA",text:"CA",class:["tbl-kaikei-header"],width:70},{value:"C_START",text:"START",class:["tbl-kaikei-header"],width:70},{value:"C_END",text:"END",class:["tbl-kaikei-header"],width:70},{value:"SUB_NGUOI",text:"SUB - 人",class:["tbl-kaikei-header"],width:70},{value:"SUB_TG",text:"SUB - 時間(phút)",class:["tbl-kaikei-header"],width:70},{value:"ASSY_NGUOI",text:"ASSY - 人",class:["tbl-kaikei-header"],width:70},{value:"ASSY_TG",text:"ASSY - 時間(phút)",class:["tbl-kaikei-header"],width:70},{value:"QC_NGUOI",text:"QC - 人",class:["tbl-kaikei-header"],width:70},{value:"QC_TG",text:"QC - 時間(phút)",class:["tbl-kaikei-header"],width:70},{value:"C_USER",text:"User",class:["tbl-kaikei-header"],width:70},{value:"D_UPDATE",text:"Ngày Update",class:["tbl-kaikei-header"],width:70}]},kaikeiExp:{kaikeiRes:[],kaikeiHeader:[{value:"SUB_NGUOI",text:"SUB - 人",class:["tbl-kaikei-header"],width:"2%",excelHeader:"SUB - 人"},{value:"SUB_TG",text:"SUB - 時間(phút)",class:["tbl-kaikei-header"],width:"2%",excelHeader:"SUB - 時間(phút)"},{value:"ASSY_NGUOI",text:"ASSY - 人",class:["tbl-kaikei-header"],width:"2%",excelHeader:"ASSY - 人"},{value:"ASSY_TG",text:"ASSY - 時間(phút)",class:["tbl-kaikei-header"],width:"2%",excelHeader:"ASSY - 時間(phút)"},{value:"QC_NGUOI",text:"QC - 人",class:["tbl-kaikei-header"],width:"2%",excelHeader:"QC - 人"},{value:"QC_TG",text:"QC - 時間(phút)",class:["tbl-kaikei-header"],width:"2%",excelHeader:"QC - 時間(phút)"},{value:"L_NHAN_CONG_SUB",text:"C.Số TT SUB",class:["tbl-kaikei-header"],width:"4%",excelHeader:"C.Số TT SUB"},{value:"L_NHAN_CONG_ASSY",text:"C.Số TT ASSY",class:["tbl-kaikei-header"],width:"4%",excelHeader:"C.Số TT ASSY"},{value:"L_NHAN_CONG_QC",text:"C.Số TT KT",class:["tbl-kaikei-header"],width:"4%",excelHeader:"C.Số TT KT"},{value:"L_NHAN_CONG_ALL",text:"C.Số Thực Tế",class:["tbl-kaikei-header"],width:"8%",excelHeader:"C.Số Thực Tế"},{value:"C_START",text:"START",class:["tbl-kaikei-header"],width:"2%",excelHeader:"START"},{value:"C_END",text:"END",class:["tbl-kaikei-header"],width:"2%",excelHeader:"END"},{value:"C_HIN",text:"HIN",align:"left",class:["tbl-kaikei-header"],width:"10%",excelHeader:"HIN"},{value:"LOT",text:"LOT",align:"left",class:["tbl-kaikei-header"],width:"10%",excelHeader:"LOT"},{value:"L_SAN_LUONG_IRCS",text:"Sản Lượng IRCS",class:["tbl-kaikei-header"],width:"2%",excelHeader:"Sản Lượng IRCS"},{value:"CA_CQ",text:"C.Số chuẩn SUB",class:["tbl-kaikei-header"],width:"4%",excelHeader:"C.Số chuẩn SUB"},{value:"DA_DP",text:"C.Số chuẩn Assy",class:["tbl-kaikei-header"],width:"4%",excelHeader:"C.Số chuẩn Assy"},{value:"EA_EP",text:"C.Số chuẩn KT",class:["tbl-kaikei-header"],width:"4%",excelHeader:"C.Số chuẩn KT"},{value:"ST_ALL",text:"C.Số Chuẩn",class:["tbl-kaikei-header"],width:"4%",excelHeader:"C.Số Chuẩn"},{value:"SUB_PERCENT",text:"SUB%",class:["tbl-kaikei-header"],width:"2%",excelHeader:"SUB%"},{value:"ASSY_PERCENT",text:"ASSY%",class:["tbl-kaikei-header"],width:"2%",excelHeader:"ASSY%"},{value:"QC_PERCENT",text:"KIEM TRA%",class:["tbl-kaikei-header"],width:"2%",excelHeader:"K.TRA%"},{value:"ALL_PERCENT",text:"ALL%",class:["tbl-kaikei-header"],width:"2%",excelHeader:"ALL%"}]}}},components:{},created:function(){},mounted:(d=Object(l.a)(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return this.$nuxt.$emit("page-info",{title:this.title,version:"1.1.1",options:{replace:!0}}),t.next=3,this.getInit();case 3:if(!this.$route.query.expDate||!/^\d+-\d+-\d+$/.test(this.$route.query.expDate)&&"yesterday"!=this.$route.query.expDate){t.next=11;break}return this.selectedSGDate="yesterday"==this.$route.query.expDate?this.$moment().add(-1,"days").format("YYYY-MM-DD"):this.$route.query.expDate,t.next=7,this.getData();case 7:return t.next=9,this.excelDownload("TT_IRCS_Hinban_"+this.selectedSGDate);case 9:t.next=14;break;case 11:return this.selectedSGDate=(new Date).toISOString().substring(0,10),t.next=14,this.getData();case 14:case"end":return t.stop()}}),t,this)}))),function(){return d.apply(this,arguments)}),computed:{searchKey:function(){return this.keyWorld.toUpperCase()},kameHeader:function(){var t=[];return t.push(this.createTTHeader("1日目","1日目","1日目残","1日目SUB")),t.push(this.createTTHeader("2日目","2日目","2日目残","2日目SUB")),t.push(this.createTTHeader("3日目","3日目","3日目残","3日目SUB")),this.maxNichiCol>=4&&t.push(this.createTTHeader("4日目","4日目","4日目残","4日目SUB")),this.maxNichiCol>=5&&t.push(this.createTTHeader("5日目","5日目","5日目残","5日目SUB")),this.maxNichiCol>=6&&t.push(this.createTTHeader("6日目","6日目","6日目残","6日目SUB")),this.maxNichiCol>=7&&t.push(this.createTTHeader("7日目","7日目","7日目残","7日目SUB")),t},excelHeader:function(){var t=this,e={type:"pattern",pattern:"solid",fgColor:{argb:"FF9933FF"}},a={color:{argb:"FFFFFFFF"},bold:!0},i=[{text:"FAP品番",value:"FAP品番",width:18},{text:"ロットNO",value:"ロットNO",width:10},{text:"回路",value:"回路",width:10},this.selectedSGDate?{text:"ST SUB",value:"CA_CQ",width:10,headerFill:e,font:a}:void 0,this.selectedSGDate?{text:"ST ASSY",value:"DA_DP",width:10,headerFill:e,font:a}:void 0,this.selectedSGDate?{text:"ST K.TRA",value:"EA_EP",width:10,headerFill:e,font:a}:void 0,this.selectedSGDate?{text:"ST ALL",value:"ST_ALL",width:10,headerFill:e,font:a}:void 0,this.selectedSGDate?{text:"DON_GIA",value:"DON_GIA",width:10,headerFill:e,font:a}:void 0,{text:"ラインNO",value:"ラインNO",width:10},{text:"ASSY日",value:"ASSY日",width:13},{text:"D_START",value:"D_START",width:16},{text:"D_END",value:"D_END",width:16},{text:"指示数",value:"指示数",width:8},{text:"生産合計",value:"生産合計",width:9},{text:"生産合計_CA4",value:"生産合計_CA4",width:14},{text:"生産合計_CA3",value:"生産合計_CA3",width:14}];return i=i.filter((function(t){return t})),this.kameStyle?i=[].concat(Object(r.a)(i),Object(r.a)(this.kameHeader)):this.dateScope.forEach((function(n){i.push({text:n,value:n}),i.push({text:n+"_CA4",value:n+"_CA4"}),n==t.selectedSGDate&&i.push({text:"ST_SUB",value:"ST_SUB%CA4",width:12,headerFill:e,font:a},{text:"ST_ASSY",value:"ST_ASSY%CA4",width:12,headerFill:e,font:a},{text:"ST_K.TRA",value:"ST_QC%CA4",width:12,headerFill:e,font:a},{text:"ST_ALL",value:"ST_ALL%CA4",width:12,headerFill:e,font:a},{text:"NGUOI SUB",value:"L_CA4_SUB_NGUOI",width:13,headerFill:e,font:a},{text:"THOI GIAN",value:"L_CA4_SUB_TG",width:13,headerFill:e,font:a},{text:"NGUOI ASSY",value:"L_CA4_ASSY_NGUOI",width:13,headerFill:e,font:a},{text:"THOI GIAN",value:"L_CA4_ASSY_TG",width:13,headerFill:e,font:a},{text:"NGUOI K.TRA",value:"L_CA4_QC_NGUOI",width:13,headerFill:e,font:a},{text:"THOI GIAN",value:"L_CA4_QC_TG",width:13,headerFill:e,font:a},{text:"DOANH THU",value:"DOANH_THU",width:13,headerFill:e,font:a},{text:"LUONG",value:"L_CA4_LUONG",width:13,headerFill:e,font:a},{text:"LUONG",value:"LUONG",width:13,headerFill:e,font:a}),i.push({text:n+"_CA3",value:n+"_CA3"}),n==t.selectedSGDate&&i.push({text:"ST_SUB",value:"ST_SUB%CA3",width:12,headerFill:e,font:a},{text:"ST_ASSY",value:"ST_ASSY%CA3",width:12,headerFill:e,font:a},{text:"ST_K.TRA",value:"ST_QC%CA3",width:12,headerFill:e,font:a},{text:"ST_ALL",value:"ST_ALL%CA3",width:12,headerFill:e,font:a},{text:"NGUOI SUB",value:"L_CA3_SUB_NGUOI",width:13,headerFill:e,font:a},{text:"THOI GIAN",value:"L_CA3_SUB_TG",width:13,headerFill:e,font:a},{text:"NGUOI ASSY",value:"L_CA3_ASSY_NGUOI",width:13,headerFill:e,font:a},{text:"THOI GIAN",value:"L_CA3_ASSY_TG",width:13,headerFill:e,font:a},{text:"NGUOI K.TRA",value:"L_CA3_QC_NGUOI",width:13,headerFill:e,font:a},{text:"THOI GIAN",value:"L_CA3_QC_TG",width:13,headerFill:e,font:a},{text:"DOANH THU",value:"DOANH_THU",width:13,headerFill:e,font:a},{text:"LUONG",value:"L_CA3_LUONG",width:13,headerFill:e,font:a},{text:"LUONG",value:"LUONG",width:13,headerFill:e,font:a}),i.push({text:n+"_残",value:n+"_残"}),i.push({text:n+"_START",value:n+"_START"}),i.push({text:n+"_END",value:n+"_END"})})),i.push({text:"IP_SUB_LIST",value:"IP_SUB_LIST",width:10},{text:"S01",value:"S01",width:5},{text:"S02",value:"S02",width:5},{text:"S03",value:"S03",width:5},{text:"S04",value:"S04",width:5},{text:"S05",value:"S05",width:5},{text:"S06",value:"S06",width:5},{text:"S07",value:"S07",width:5},{text:"S08",value:"S08",width:5},{text:"S09",value:"S09",width:5},{text:"S10",value:"S10",width:5},{text:"S11",value:"S11",width:5},{text:"S12",value:"S12",width:5},{text:"S13",value:"S13",width:5},{text:"S14",value:"S14",width:5},{text:"S15",value:"S15",width:5},{text:"S16",value:"S16",width:5},{text:"S17",value:"S17",width:5},{text:"S18",value:"S18",width:5},{text:"S19",value:"S19",width:5},{text:"S20",value:"S20",width:5}),i},headers:function(){var t=this,e=[{text:"FAP品番",value:"FAP品番",width:200,class:["tbl-header","fixed"],cellClass:["cell-normal","cell-boilder","cell-hinban","fixed"],fixed:!0},{text:"ロットNO",value:"ロットNO",width:80,class:["tbl-header","fixed"],cellClass:["cell-normal","cell-boilder","fixed"],fixed:!0},"ALL"!=this.selectedStatus?{text:"ラインNO",value:"ラインNO",width:10,class:["tbl-header","fixed"],cellClass:["cell-normal","cell-boilder","fixed"]}:void 0,{text:"回路",value:"回路",width:80,class:["tbl-header","fixed"],cellClass:["cell-normal","cell-boilder","fixed"],fixed:!0},{text:"ASSY日",value:"ASSY日",width:110,class:["tbl-header","assyDateHeader","fixed"],cellClass:["cell-normal","fixed"],fixed:!0},{text:"D_START",value:"D_START",width:120,class:["tbl-header","assyDateHeader"],cellClass:["cell-normal"],fixed:!0},{text:"D_END",value:"D_END",width:120,class:["tbl-header","assyDateHeader"],cellClass:["cell-normal"],fixed:!0},this.kameStyle?{text:"SCOPE",value:"SCOPE",width:180,class:["tbl-header","assyDateHeader"],cellClass:["cell-normal"],fixed:!0}:void 0,{text:"指示数",value:"指示数",width:90,class:["tbl-header","fixed"],cellClass:["cell-normal","cell-shiji","fixed"],fixed:!0},{text:"生産合計",value:"生産合計",width:90,class:["tbl-header","fixed"],cellClass:["cell-normal","cell-total","fixed"],fixed:!0},{text:"SUB",value:"SUB",width:150,class:["tbl-header","fixed"],cellClass:["cell-sub","fixed"],fixed:!0}];return e=e.filter((function(t){return t})),this.kameStyle?e=[].concat(Object(r.a)(e),Object(r.a)(this.kameHeader)):this.dateScope.forEach((function(a){e.push(t.createTTHeader(a.substring(5),a,a+"_残",a+"_SUB")),a==t.selectedSGDate&&e.push({text:"ST_SUB<br/>%CA4",value:"ST_SUB%CA4",width:100,class:["tbl-header","text--center"],cellClass:["cell-normal","text--center","cell-percent"]},{text:"ST_ASSY<br/>%CA4",value:"ST_ASSY%CA4",width:100,class:["tbl-header","text--center"],cellClass:["cell-normal","text--center","cell-percent"]},{text:"ST_K.TRA<br/>%CA4",value:"ST_QC%CA4",width:100,class:["tbl-header","text--center"],cellClass:["cell-normal","text--center","cell-percent"]},{text:"ST_ALL<br/>%CA4",value:"ST_ALL%CA4",width:100,class:["tbl-header","text--center"],cellClass:["cell-normal","text--center","cell-percent"]},{text:"ST_SUB<br/>%CA3",value:"ST_SUB%CA3",width:100,class:["tbl-header","text--center"],cellClass:["cell-normal","text--center","cell-percent"]},{text:"ST_ASSY<br/>%CA3",value:"ST_ASSY%CA3",width:100,class:["tbl-header","text--center"],cellClass:["cell-normal","text--center","cell-percent"]},{text:"ST_K.TRA<br/>%CA3",value:"ST_QC%CA3",width:100,class:["tbl-header","text--center"],cellClass:["cell-normal","text--center","cell-percent"]},{text:"ST_ALL<br/>%CA3",value:"ST_ALL%CA3",width:100,class:["tbl-header","text--center"],cellClass:["cell-normal","text--center","cell-percent"]})})),e},lineList:function(){var t=[];return this.initData&&this.initData.LIST_LINE&&(t=this.initData.LIST_LINE.map((function(t){return t.C_LINE}))),t},clientLine:function(){var t=null;return this.initData&&this.initData.CLIENT_LINE&&this.initData.CLIENT_LINE.length>0&&(t=this.initData.CLIENT_LINE[0].C_LINE),t},lineList_Exp:function(){var t=[];return this.initData&&this.initData.LIST_LINE&&(t=this.initData.LIST_LINE.map((function(t){return t.C_LINE}))),["ALL"].concat(Object(r.a)(t))},ircsSumPercent:function(){if(this.nhanCongData.length<1)return[]},ttIRCS_Data:function(){var t=this;this.dateScope=[];var e={};return this.ttIrcsHinbanData.filter((function(e){var a=t.$moment(e.ASSY日);return"中"==t.selectedStatus?0!=e.生産合計&&e.生産合計<e.L_SUU&&e.FAP品番&&a.isValid()&&Math.abs(a.diff(t.$moment(),"days"))<15:"完成"==t.selectedStatus?e.生産合計>=e.L_SUU&&e.FAP品番:"未完成"==t.selectedStatus?e.生産合計<e.L_SUU&&e.FAP品番&&a.isValid()&&Math.abs(a.diff(t.$moment(),"days"))<15:"まだ"!=t.selectedStatus||0==e.生産合計&&e.FAP品番&&a.isValid()&&Math.abs(a.diff(t.$moment(),"days"))<15})).map((function(a){t.maxNichiCol<4&&a["4日目"]>0&&(t.maxNichiCol=4),t.maxNichiCol<5&&a["5日目"]>0&&(t.maxNichiCol=5),t.maxNichiCol<6&&a["6日目"]>0&&(t.maxNichiCol=6),t.maxNichiCol<7&&a["7日目"]>0&&(t.maxNichiCol=7);var i={"FAP品番":a.FAP品番,"ロットNO":a.ロットNO,"ラインNO":a.ラインNO,"ASSY日":a.ASSY日,"指示数":a.L_SUU,D_START:a.D_START,D_END:a.D_END,SCOPE:a.SCOPE,"生産合計":a.生産合計,"生産合計_CA4":a.生産合計_CA4,"生産合計_CA3":a.生産合計_CA3,CA_CQ:a.CA_CQ,DA_DP:a.DA_DP,EA_EP:a.EA_EP,ST_ALL:a.ST_ALL,"回路":a.回路,D_LAST_ASSY:a.D_LAST_ASSY,"1日目":a["1日目"],"1日目_CA4":a["1日目_CA4"],"1日目_CA3":a["1日目_CA3"],"1日目_TOTAL":a["1日目_TOTAL"],"1日目残":a["1日目_ACC"]||0,"1日目_START":a["1日目_START"],"1日目_END":a["1日目_END"],"2日目":a["2日目"],"2日目_CA4":a["2日目_CA4"],"2日目_CA3":a["2日目_CA3"],"2日目_TOTAL":a["2日目_TOTAL"],"2日目残":a["2日目_ACC"]||0,"2日目_START":a["2日目_START"],"2日目_END":a["2日目_END"],"3日目":a["3日目"],"3日目_CA4":a["3日目_CA4"],"3日目_CA3":a["3日目_CA3"],"3日目_TOTAL":a["3日目_TOTAL"],"3日目残":a["3日目_ACC"]||0,"3日目_START":a["3日目_START"],"3日目_END":a["3日目_END"],"4日目":a["4日目"],"4日目_CA4":a["4日目_CA4"],"4日目_CA3":a["4日目_CA3"],"4日目_TOTAL":a["4日目_TOTAL"],"4日目残":a["4日目_ACC"]||0,"4日目_START":a["4日目_START"],"4日目_END":a["4日目_END"],"5日目":a["5日目"],"5日目_CA4":a["5日目_CA4"],"5日目_CA3":a["5日目_CA3"],"5日目_TOTAL":a["5日目_TOTAL"],"5日目残":a["5日目_ACC"]||0,"5日目_START":a["5日目_START"],"5日目_END":a["5日目_END"],"6日目":a["6日目"],"6日目_CA4":a["6日目_CA4"],"6日目_CA3":a["6日目_CA3"],"6日目_TOTAL":a["6日目_TOTAL"],"6日目残":a["6日目_ACC"]||0,"6日目_START":a["6日目_START"],"6日目_END":a["6日目_END"],"7日目":a["7日目"],"7日目_CA4":a["7日目_CA4"],"7日目_CA3":a["7日目_CA3"],"7日目_TOTAL":a["7日目_TOTAL"],"7日目残":a["7日目_ACC"]||0,"7日目_START":a["7日目_START"],"7日目_END":a["7日目_END"],IP_SUB_LIST:a.IP_SUB_LIST,S01:a.S01,S02:a.S02,S03:a.S03,S04:a.S04,S05:a.S05,S06:a.S06,S07:a.S07,S08:a.S08,S09:a.S09,S10:a.S10,S11:a.S11,S12:a.S12,S13:a.S13,S14:a.S14,S15:a.S15,S16:a.S16,S17:a.S17,S18:a.S18,S19:a.S19,S20:a.S20};if(a.FAP品番)if(a.D_LAST_ASSY){var n=t.$moment(a.D_LAST_ASSY),l=t.$moment(t.selectedDate||t.selectedSGDate);l.isValid()&&Math.abs(n.diff(l,"days"))>=13&&(i.hinStatus="comback-hin")}else i.hinStatus="new-hin";if(i.SCOPE){var s=i.SCOPE.split(";");t.dateScope=Object(r.a)(new Set([].concat(Object(r.a)(s),Object(r.a)(t.dateScope)))).sort(),s.forEach((function(a,n){switch(n){case 0:i[a]=i["1日目"],i[a+"_CA4"]=i["1日目_CA4"],i[a+"_CA3"]=i["1日目_CA3"],i[a+"_TOTAL"]=i["1日目_TOTAL"],i[a+"_残"]=i["1日目残"],i[a+"_START"]=i["1日目_START"],i[a+"_END"]=i["1日目_END"],e[a]=(e[a]||0)+(i["1日目"]||0),e[a+"_CA4"]=(e[a+"_CA4"]||0)+(i[a+"_CA4"]||0),e[a+"_CA3"]=(e[a+"_CA3"]||0)+(i[a+"_CA3"]||0),t.kameStyle||(e[a+"_残"]=(e[a+"_残"]||0)+(i[a+"_残"]||0));break;case 1:i[a]=i["2日目"],i[a+"_CA4"]=i["2日目_CA4"],i[a+"_CA3"]=i["2日目_CA3"],i[a+"_TOTAL"]=i["2日目_TOTAL"],i[a+"_残"]=i["2日目残"],i[a+"_START"]=i["2日目_START"],i[a+"_END"]=i["2日目_END"],e[a]=(e[a]||0)+(i["2日目"]||0),e[a+"_CA4"]=(e[a+"_CA4"]||0)+(i[a+"_CA4"]||0),e[a+"_CA3"]=(e[a+"_CA3"]||0)+(i[a+"_CA3"]||0),t.kameStyle||(e[a+"_残"]=(e[a+"_残"]||0)+(i[a+"_残"]||0));break;case 2:i[a]=i["3日目"],i[a+"_CA4"]=i["3日目_CA4"],i[a+"_CA3"]=i["3日目_CA3"],i[a+"_TOTAL"]=i["3日目_TOTAL"],i[a+"_残"]=i["3日目残"],i[a+"_START"]=i["3日目_START"],i[a+"_END"]=i["3日目_END"],e[a]=(e[a]||0)+(i["3日目"]||0),e[a+"_CA4"]=(e[a+"_CA4"]||0)+(i[a+"_CA4"]||0),e[a+"_CA3"]=(e[a+"_CA3"]||0)+(i[a+"_CA3"]||0),t.kameStyle||(e[a+"_残"]=(e[a+"_残"]||0)+(i[a+"_残"]||0));break;case 3:i[a]=i["4日目"],i[a+"_CA4"]=i["4日目_CA4"],i[a+"_CA3"]=i["4日目_CA3"],i[a+"_TOTAL"]=i["4日目_TOTAL"],i[a+"_残"]=i["4日目残"],i[a+"_START"]=i["4日目_START"],i[a+"_END"]=i["4日目_END"],e[a]=(e[a]||0)+(i["4日目"]||0),e[a+"_CA4"]=(e[a+"_CA4"]||0)+(i[a+"_CA4"]||0),e[a+"_CA3"]=(e[a+"_CA3"]||0)+(i[a+"_CA3"]||0),t.kameStyle||(e[a+"_残"]=(e[a+"_残"]||0)+(i[a+"_残"]||0));break;case 4:i[a]=i["5日目"],i[a+"_CA4"]=i["5日目_CA4"],i[a+"_CA3"]=i["5日目_CA3"],i[a+"_TOTAL"]=i["5日目_TOTAL"],i[a+"_残"]=i["5日目残"],i[a+"_START"]=i["5日目_START"],i[a+"_END"]=i["5日目_END"],e[a]=(e[a]||0)+(i["5日目"]||0),e[a+"_CA4"]=(e[a+"_CA4"]||0)+(i[a+"_CA4"]||0),e[a+"_CA3"]=(e[a+"_CA3"]||0)+(i[a+"_CA3"]||0),t.kameStyle||(e[a+"_残"]=(e[a+"_残"]||0)+(i[a+"_残"]||0));break;case 5:i[a]=i["6日目"],i[a+"_CA4"]=i["6日目_CA4"],i[a+"_CA3"]=i["6日目_CA3"],i[a+"_TOTAL"]=i["6日目_TOTAL"],i[a+"_残"]=i["6日目残"],i[a+"_START"]=i["6日目_START"],i[a+"_END"]=i["6日目_END"],e[a]=(e[a]||0)+(i["6日目"]||0),e[a+"_CA4"]=(e[a+"_CA4"]||0)+(i[a+"_CA4"]||0),e[a+"_CA3"]=(e[a+"_CA3"]||0)+(i[a+"_CA3"]||0),t.kameStyle||(e[a+"_残"]=(e[a+"_残"]||0)+(i[a+"_残"]||0));break;case 6:i[a]=i["7日目"],i[a+"_CA4"]=i["7日目_CA4"],i[a+"_CA3"]=i["7日目_CA3"],i[a+"_TOTAL"]=i["7日目_TOTAL"],i[a+"_残"]=i["7日目残"],i[a+"_START"]=i["7日目_START"],i[a+"_END"]=i["7日目_END"],e[a]=(e[a]||0)+(i["7日目"]||0),e[a+"_CA4"]=(e[a+"_CA4"]||0)+(i[a+"_CA4"]||0),e[a+"_CA3"]=(e[a+"_CA3"]||0)+(i[a+"_CA3"]||0),t.kameStyle||(e[a+"_残"]=(e[a+"_残"]||0)+(i[a+"_残"]||0))}})),!i[t.selectedDate+"_残"]&&t.selectedDate&&s.slice(-1)[0]<t.selectedDate&&(i[t.selectedDate+"_残"]=i[s.slice(-1)[0]+"_残"],e[t.selectedDate+"_残"]=(e[t.selectedDate+"_残"]||0)+(i[t.selectedDate+"_残"]||0)),t.selectedDate&&!i[t.selectedDate+"_残"]&&(s[0]<t.selectedDate?i[t.selectedDate+"_残"]=0:i[t.selectedDate+"_残"]=(i[t.selectedDate]||0)-(i.指示数||0),e[t.selectedDate+"_残"]=(e[t.selectedDate+"_残"]||0)+(i[t.selectedDate+"_残"]||0))}else if(i.FAP品番)t.selectedDate&&(i[t.selectedDate+"_残"]=-1*i.指示数,t.kameStyle||(e[t.selectedDate+"_残"]=(e[t.selectedDate+"_残"]||0)+(i[t.selectedDate+"_残"]||0)));else if(Object.keys(e).forEach((function(a){(t.selectedSGDate||t.selectedDate&&(a.substr(0,10)>=t.selectedDate||"_残"!=a.substr(-2)))&&(i[a]=e[a])})),e={},t.selectedSGDate&&t.nhanCongData.length>0){var o=t.nhanCongData.filter((function(t){return t.C_LINE==i.ラインNO}));if(o.length>0){i.L_CA4_SUB_NGUOI=o[0].L_CA4_SUB_NGUOI,i.L_CA4_SUB_TG=o[0].L_CA4_SUB_TG,i.L_CA4_ASSY_NGUOI=o[0].L_CA4_ASSY_NGUOI,i.L_CA4_ASSY_TG=o[0].L_CA4_ASSY_TG,i.L_CA4_QC_NGUOI=o[0].L_CA4_QC_NGUOI,i.L_CA4_QC_TG=o[0].L_CA4_QC_TG,i.L_CA4_LUONG=o[0].L_CA4_LUONG,i.L_CA4_LUONG_ALL=o[0].L_CA4_LUONG_ALL,i.CA4_NHAN_CONG_SUB=o[0].CA4_NHAN_CONG_SUB,i.CA4_NHAN_CONG_ASSY=o[0].CA4_NHAN_CONG_ASSY,i.CA4_NHAN_CONG_QC=o[0].CA4_NHAN_CONG_QC,i.CA4_NHAN_CONG_ALL=o[0].CA4_NHAN_CONG_ALL,i.L_CA3_SUB_NGUOI=o[0].L_CA3_SUB_NGUOI,i.L_CA3_SUB_TG=o[0].L_CA3_SUB_TG,i.L_CA3_ASSY_NGUOI=o[0].L_CA3_ASSY_NGUOI,i.L_CA3_ASSY_TG=o[0].L_CA3_ASSY_TG,i.L_CA3_QC_NGUOI=o[0].L_CA3_QC_NGUOI,i.L_CA3_QC_TG=o[0].L_CA3_QC_TG,i.L_CA3_LUONG=o[0].L_CA3_LUONG,i.L_CA3_LUONG_ALL=o[0].L_CA3_LUONG_ALL,i.CA3_NHAN_CONG_SUB=o[0].CA3_NHAN_CONG_SUB,i.CA3_NHAN_CONG_ASSY=o[0].CA3_NHAN_CONG_ASSY,i.CA3_NHAN_CONG_QC=o[0].CA3_NHAN_CONG_QC,i.CA3_NHAN_CONG_ALL=o[0].CA3_NHAN_CONG_ALL;var c=t.nhanCongData.filter((function(t){return t.C_LINE==i.ラインNO}));if(1==c.length){var _={};t.ttIrcsHinbanData.forEach((function(e){e.ラインNO==c[0].C_LINE&&e.SCOPE&&(e.SCOPE.split(";").forEach((function(a,i){if(a==t.selectedSGDate)switch(console.log(i),i){case 0:e[t.selectedSGDate+"_CA4"]=e["1日目_CA4"],e[t.selectedSGDate+"_CA3"]=e["1日目_CA3"];break;case 1:e[t.selectedSGDate+"_CA4"]=e["2日目_CA4"],e[t.selectedSGDate+"_CA3"]=e["2日目_CA3"];break;case 2:e[t.selectedSGDate+"_CA4"]=e["3日目_CA4"],e[t.selectedSGDate+"_CA3"]=e["3日目_CA3"];break;case 3:e[t.selectedSGDate+"_CA4"]=e["4日目_CA4"],e[t.selectedSGDate+"_CA3"]=e["4日目_CA3"];break;case 4:e[t.selectedSGDate+"_CA4"]=e["5日目_CA4"],e[t.selectedSGDate+"_CA3"]=e["5日目_CA3"];break;case 5:e[t.selectedSGDate+"_CA4"]=e["6日目_CA4"],e[t.selectedSGDate+"_CA3"]=e["6日目_CA3"];break;case 6:e[t.selectedSGDate+"_CA4"]=e["7日目_CA4"],e[t.selectedSGDate+"_CA3"]=e["7日目_CA3"]}})),_.ST_SUB_CA4_SUM=(_.ST_SUB_CA4_SUM||0)+(e.CA_CQ||0)*(e[t.selectedSGDate+"_CA4"]||0),_.ST_ASSY_CA4_SUM=(_.ST_ASSY_CA4_SUM||0)+(e.DA_DP||0)*(e[t.selectedSGDate+"_CA4"]||0),_.ST_QC_CA4_SUM=(_.ST_QC_CA4_SUM||0)+(e.EA_EP||0)*(e[t.selectedSGDate+"_CA4"]||0),_.ST_ALL_CA4_SUM=(_.ST_ALL_CA4_SUM||0)+(e.ST_ALL||0)*(e[t.selectedSGDate+"_CA4"]||0),_.ST_SUB_CA3_SUM=(_.ST_SUB_CA3_SUM||0)+(e.CA_CQ||0)*(e[t.selectedSGDate+"_CA3"]||0),_.ST_ASSY_CA3_SUM=(_.ST_ASSY_CA3_SUM||0)+(e.DA_DP||0)*(e[t.selectedSGDate+"_CA3"]||0),_.ST_QC_CA3_SUM=(_.ST_QC_CA3_SUM||0)+(e.EA_EP||0)*(e[t.selectedSGDate+"_CA3"]||0),_.ST_ALL_CA3_SUM=(_.ST_ALL_CA3_SUM||0)+(e.ST_ALL||0)*(e[t.selectedSGDate+"_CA3"]||0))})),i["ST_SUB%CA4"]=i.CA4_NHAN_CONG_SUB>0?_.ST_SUB_CA4_SUM/i.CA4_NHAN_CONG_SUB:0,i["ST_ASSY%CA4"]=i.CA4_NHAN_CONG_ASSY>0?_.ST_ASSY_CA4_SUM/i.CA4_NHAN_CONG_ASSY:0,i["ST_QC%CA4"]=i.CA4_NHAN_CONG_QC>0?_.ST_QC_CA4_SUM/i.CA4_NHAN_CONG_QC:0,i["ST_ALL%CA4"]=i.CA4_NHAN_CONG_ALL>0?_.ST_ALL_CA4_SUM/i.CA4_NHAN_CONG_ALL:0,i["ST_SUB%CA3"]=i.CA3_NHAN_CONG_SUB>0?_.ST_SUB_CA3_SUM/i.CA3_NHAN_CONG_SUB:0,i["ST_ASSY%CA3"]=i.CA3_NHAN_CONG_ASSY>0?_.ST_ASSY_CA3_SUM/i.CA3_NHAN_CONG_ASSY:0,i["ST_QC%CA3"]=i.CA3_NHAN_CONG_QC>0?_.ST_QC_CA3_SUM/i.CA3_NHAN_CONG_QC:0,i["ST_ALL%CA3"]=i.CA3_NHAN_CONG_ALL>0?_.ST_ALL_CA3_SUM/i.CA3_NHAN_CONG_ALL:0}}}i.IP_SUB_LIST&&i.IP_SUB_LIST.split(";").forEach((function(e,a){a<4?i.subTooltip1=(i.subTooltip1||"")+e+": "+i["S".concat(t.$pad(a+1))]+"<br>":a<8?i.subTooltip2=(i.subTooltip2||"")+e+": "+i["S".concat(t.$pad(a+1))]+"<br>":a<12?i.subTooltip3=(i.subTooltip3||"")+e+": "+i["S".concat(t.$pad(a+1))]+"<br>":a<16&&(i.subTooltip4=(i.subTooltip4||"")+e+": "+i["S".concat(t.$pad(a+1))]+"<br>")}));return i}))},masterKaikeiView:function(){return Object(r.a)(this.kaikei.masterRes)},kaikeiView:function(){return[{C_HIN:" ",SUB_NGUOI:"(1)",SUB_TG:"(2)",ASSY_NGUOI:"(3)",ASSY_TG:"(4)",QC_NGUOI:"(5)",QC_TG:"(6)",L_NHAN_CONG_SUB:"(7)= (1)*(2)",L_NHAN_CONG_ASSY:"(8)= (3)*(4)",L_NHAN_CONG_QC:"(9)= (5)*(6)",L_NHAN_CONG_ALL:"(10)= (7)+(8)+(9)",L_SAN_LUONG_IRCS:"(11)",ST_ALL:"(12)= sum((11)*(12))",ALL_PERCENT:"(13)= (12)/(10)"}].concat(Object(r.a)(this.kaikeiExp.kaikeiRes.map((function(t){return delete t.D_START,t.C_HIN&&(delete t.SUB_NGUOI,delete t.SUB_TG,delete t.ASSY_NGUOI,delete t.ASSY_TG,delete t.QC_NGUOI,delete t.QC_TG),t}))))}}},Object(n.a)(i,"created",(function(){})),Object(n.a)(i,"components",{}),Object(n.a)(i,"methods",{createTTHeader:function(t,e,a,i){return{text:t,divider:!0,class:["tbl-header","text--center"],width:150,children:[{text:"実",value:e,class:["tbl-header","text--center"],cellClass:["cell-number"],width:50},{text:"残",value:a,class:["tbl-header","text--center"],cellClass:["cell-number"],width:50}]}},createTTExcelHeader:function(t,e,a){return{text:t,divider:!0,class:["tbl-header","text--center"],width:100,children:[{text:"実",value:e,class:["tbl-header","text--center"],cellClass:["cell-number"],width:50},{text:"残",value:a,class:["tbl-header","text--center"],cellClass:["cell-number"],width:50}]}},allowedDatePicker:function(t){var e=new Date,a=new Date,i=new Date(t);return e.setDate(e.getDate()+30),a.setDate(a.getDate()-60),a<i&&i<=e},weekdayFormat:function(t){switch(new Date(t).getDay()){case 0:return"日";case 1:return"月";case 2:return"火";case 3:return"水";case 4:return"木";case 5:return"金";case 6:return"土"}},rowClass:function(t){return"row-normal"},getInit:function(){var t=this;return Object(l.a)(regeneratorRuntime.mark((function e(){var a;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,t.$axios.get("/tt-ircs/init");case 3:a=e.sent,t.initData=a.data,console.log(t.initData),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(0),console.log(e.t0);case 11:return e.prev=11,t.clientLine&&(t.kaikei.line=t.clientLine),e.finish(11);case 14:case"end":return e.stop()}}),e,null,[[0,8,11,14]])})))()},getSubHeader:function(t){var e=[];return t.filter((function(t){return t.children})).forEach((function(t){e=e.concat(t.children)})),e},getRows:function(t){var e=[];return this.headers.forEach((function(a,i){var n;a.children?a.children.forEach((function(a,i){n=t[a.value],e.push(o(o({},a),{},{colVal:n}))})):(n=t[a.value],e.push(o(o({},a),{},{colVal:n})))})),e},dayFormat:function(t){return t.substring(t.length-2)},handleUploadBtnClick:function(){this.$refs.uploadFile.value=null,this.$refs.uploadFile.click()},openMasterKaikei:function(){var t=this;return Object(l.a)(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t.kaikei.d_assy=t.today,t.kaikei.masterRes=[],t.searchMasterKaikei(),t.kaikeiDialog=!0;case 4:case"end":return e.stop()}}),e)})))()},btnMasterKaikeiIMPClick:function(){var t=this;return Object(l.a)(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.$LOGIN_CONFIRM(t,t.$route.name,"Q13");case 2:if(!e.sent){e.next=5;break}t.$refs.uploadKaikeiFile.value=null,t.$refs.uploadKaikeiFile.click();case 5:case"end":return e.stop()}}),e)})))()},handleFileChange:function(t){var e=this;return Object(l.a)(regeneratorRuntime.mark((function a(){var i,n,l,r,s;return regeneratorRuntime.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:if(e.$refs.uploadKaikeiFile.value){a.next=2;break}return a.abrupt("return");case 2:return e.rawFile=t.target.files[0],e.loading=!0,a.next=6,e.$readXLSX(e,e.rawFile);case 6:if(n=a.sent,l=[],r=[],e.xlsData=e.$XLSX.utils.sheet_to_json(n.Sheets[n.SheetNames[0]],{raw:!1,dateNF:"yyyy-mm-dd HH:mm:ss"}).filter((function(t){return""!=t.D_ASSY&&t.D_ASSY&&t.C_LINE&&t.C_CA&&t.C_START&&t.C_END&&(!i||i>t.D_ASSY)&&(i=t.D_ASSY),t.D_ASSY&&t.C_LINE&&t.C_CA&&t.C_START&&t.C_END})).filter((function(t){return/\d{4}-\d{2}-\d{2}/.test(t.D_ASSY)||r.push(t.D_ASSY),/\d{4}-\d{2}-\d{2}/.test(t.D_ASSY)})).filter((function(t){var a=e.$moment(t.C_START),i=e.$moment(t.C_END);return/\d{2}:\d{2}/.test(t.C_START.replace(/^\d{4}-\d{2}-\d{2}\s*/g,"").substring(0,5)||!a.isValid())||(l.push(t.C_START),console.log(t.C_START)),/\d{2}:\d{2}/.test(t.C_END.replace(/^\d{4}-\d{2}-\d{2}\s*/g,"").substring(0,5)||!i.isValid())||(l.push(t.C_END),console.log(t.C_END)),/\d{2}:\d{2}/.test(t.C_START.replace(/^\d{4}-\d{2}-\d{2}\s*/g,"").substring(0,5))&&/\d{2}:\d{2}/.test(t.C_END.replace(/^\d{4}-\d{2}-\d{2}\s*/g,"").substring(0,5))&&a.isValid()&&i.isValid()})),e.loading=!1,console.log(e.xlsData),!(e.xlsData.length<1)){a.next=15;break}return e.$toast.show("File import không đúng Format hoặc không có dữ liệu!",{duration:5e3,position:"bottom-center"}),a.abrupt("return");case 15:if(!(r.length>0)){a.next=19;break}return e.$toast.show("Có dữ liệu Ngày ASSY bị sai. Hãy kiểm tra lại file IMPORT!!!",{duration:8e3,position:"bottom-center"}),console.log(r),a.abrupt("return");case 19:if(!(l.length>0)){a.next=23;break}return e.$toast.show("Có dữ liệu giờ bị sai. Hãy kiểm tra lại file IMPORT!!!",{duration:8e3,position:"bottom-center"}),console.log(l),a.abrupt("return");case 23:if(!(i&&Math.abs(e.$moment(i).diff(e.$moment(),"days"))>20)){a.next=26;break}return e.$toast.show("Ngày Assy cách ngày hiện tại quá 20 ngày!",{duration:5e3,position:"bottom-center"}),a.abrupt("return");case 26:e.xlsData=e.xlsData.map((function(t){var a=parseFloat(t.SO_PHUT_GIAI_LAO)||0;if(console.log(a,t.SO_PHUT_GIAI_LAO),t.SUB_TG=t.SUB_TG||0,t.ASSY_TG=t.ASSY_TG||0,t.QC_TG=t.QC_TG||0,0==t.SUB_TG&&0==t.ASSY_TG&&0==t.QC_TG){var i=e.$moment(t.C_START),n=e.$moment(t.C_END);if(n.isValid()&&n.format("HH:mm")<"06:30"&&(n=n.add(1,"days")),i.isValid()&&i.format("HH:mm")<"06:30"&&(i=i.add(1,"days")),i.isValid()&&n.isValid()){var l=n.diff(i)/6e4;a>=0&&(l-=a,console.log(l)),l>=0?(t.SUB_TG=l,t.ASSY_TG=l,t.QC_TG=l):(t.SUB_TG=0,t.ASSY_TG=0,t.QC_TG=0)}}return t})),s={d_assy:e.xlsData.map((function(t){return t.D_ASSY.substring(0,10)})),line:e.xlsData.map((function(t){return t.C_LINE})),ca:e.xlsData.map((function(t){return t.C_CA})),start:e.xlsData.map((function(t){return t.C_START.replace(/^\d{4}-\d{2}-\d{2}\s*/g,"").substring(0,5)})),end:e.xlsData.map((function(t){return t.C_END.replace(/^\d{4}-\d{2}-\d{2}\s*/g,"").substring(0,5)})),sub_nguoi:e.xlsData.map((function(t){return parseFloat(t.SUB_NGUOI)})),sub_tg:e.xlsData.map((function(t){return parseFloat(t.SUB_TG)})),assy_nguoi:e.xlsData.map((function(t){return parseFloat(t.ASSY_NGUOI)})),assy_tg:e.xlsData.map((function(t){return parseFloat(t.ASSY_TG)})),qc_nguoi:e.xlsData.map((function(t){return parseFloat(t.QC_NGUOI)})),qc_tg:e.xlsData.map((function(t){return parseFloat(t.QC_TG)})),phut_giai_lao:e.xlsData.map((function(t){return parseFloat(t.SO_PHUT_GIAI_LAO)||0})),replace_all:1,user:e.$nuxt.context.confirmedUserInfo.C_EMPLOYEE||null},console.log(s),e.updateMaster(s);case 30:case"end":return a.stop()}}),a)})))()},updateMaster:function(t){var e=this;return Object(l.a)(regeneratorRuntime.mark((function a(){var i;return regeneratorRuntime.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return console.log(t),a.prev=1,e.loading=!0,a.next=5,e.$axios.post("tt-ircs-hinban/update-master-kaikei",t);case 5:i=a.sent,e.loading=!1,console.log(i,i.data.message),"success"!=i.data.message?e.$toast.show("Có lỗi xảy ra!\n".concat(i.data.message),{duration:5e3,position:"bottom-center"}):e.$toast.show("Đã đăng lục xong!",{duration:3e3,position:"bottom-center"}),a.next=14;break;case 11:a.prev=11,a.t0=a.catch(1),console.log(a.t0);case 14:return a.prev=14,e.loading=!1,e.searchMasterKaikei(),a.finish(14);case 18:case"end":return a.stop()}}),a,null,[[1,11,14,18]])})))()},editMasterKaikei:function(t){var e=this;return Object(l.a)(regeneratorRuntime.mark((function a(){return regeneratorRuntime.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return console.log(t),a.next=3,e.$LOGIN_CONFIRM(e,e.$route.name,"Q2");case 3:if(a.sent){a.next=5;break}return a.abrupt("return");case 5:t.state=1,e.kaikei.editingMasterItem=Object.assign({},t),e.kaikei.masterRes=Object.assign([],e.kaikei.masterRes);case 8:case"end":return a.stop()}}),a)})))()},cancelEditMasterKaikei:function(t){t.state=null,this.kaikei.editingMasterItem=[],this.kaikei.masterRes=Object.assign([],this.kaikei.masterRes)},saveEditingMasterKaikei:function(){var t=this;return Object(l.a)(regeneratorRuntime.mark((function e(){var a,i;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(Math.abs(t.$moment(t.kaikei.editingMasterItem.D_ASSY).diff(t.$moment(),"days"))>20)){e.next=3;break}return t.$toast.show("Không được chỉnh sửa/đăng lục Master Kaikei cho ngày Assy quá 20 ngày!",{duration:5e3,position:"bottom-center"}),e.abrupt("return");case 3:if(/^\d{2}:\d{2}$/g.test(t.kaikei.editingMasterItem.C_START)&&/^\d{2}:\d{2}$/g.test(t.kaikei.editingMasterItem.C_END)){e.next=6;break}return t.$toast.show("Không đúng định dạng HH:mm",{duration:5e3,position:"bottom-center"}),e.abrupt("return");case 6:if(!(t.kaikei.editingMasterItem.SUB_NGUOI<0||t.kaikei.editingMasterItem.SUB_TG<0||t.kaikei.editingMasterItem.ASSY_NGUOI<0||t.kaikei.editingMasterItem.ASSY_TG<0||t.kaikei.editingMasterItem.QC_NGUOI<0||t.kaikei.editingMasterItem.QC_TG<0)){e.next=9;break}return t.$toast.show("Không được nhập số âm!!",{duration:5e3,position:"bottom-center"}),e.abrupt("return");case 9:return a={d_assy:[t.kaikei.editingMasterItem.D_ASSY],line:[t.kaikei.editingMasterItem.C_LINE],ca:[t.kaikei.editingMasterItem.C_CA],start:[t.kaikei.editingMasterItem.C_START],end:[t.kaikei.editingMasterItem.C_END],sub_nguoi:[t.kaikei.editingMasterItem.SUB_NGUOI?parseFloat(t.kaikei.editingMasterItem.SUB_NGUOI):null],sub_tg:[t.kaikei.editingMasterItem.SUB_TG?parseFloat(t.kaikei.editingMasterItem.SUB_TG):null],assy_nguoi:[t.kaikei.editingMasterItem.ASSY_NGUOI?parseFloat(t.kaikei.editingMasterItem.ASSY_NGUOI):null],assy_tg:[t.kaikei.editingMasterItem.ASSY_TG?parseFloat(t.kaikei.editingMasterItem.ASSY_TG):null],qc_nguoi:[t.kaikei.editingMasterItem.QC_NGUOI?parseFloat(t.kaikei.editingMasterItem.QC_NGUOI):null],qc_tg:[t.kaikei.editingMasterItem.QC_TG?parseFloat(t.kaikei.editingMasterItem.QC_TG):null],replace_all:0,user:t.$nuxt.context.confirmedUserInfo.C_EMPLOYEE||null},e.prev=10,t.loading=!0,e.next=14,t.$axios.post("tt-ircs-hinban/update-master-kaikei",a);case 14:i=e.sent,t.loading=!1,console.log(i),"success"!=i.data.message?t.$toast.show("Có lỗi xảy ra!\n".concat(i.data.message),{duration:5e3,position:"bottom-center"}):t.$toast.show("Đã lưu!",{duration:3e3,position:"bottom-center"}),e.next=23;break;case 20:e.prev=20,e.t0=e.catch(10),console.log(e.t0);case 23:return e.prev=23,t.loading=!1,t.searchMasterKaikei(),e.finish(23);case 27:case"end":return e.stop()}}),e,null,[[10,20,23,27]])})))()},addNewMasterKaikei:function(){var t=this;return Object(l.a)(regeneratorRuntime.mark((function e(){var a;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.kaikei.d_assy&&t.kaikei.ca&&t.kaikei.line){e.next=3;break}return t.$toast.show("Hãy chọn [Ngày Assy], [Line], [CA] trước!!!!",{duration:5e3,position:"bottom-center"}),e.abrupt("return");case 3:return e.next=5,t.$LOGIN_CONFIRM(t,t.$route.name,"Q1");case 5:if(e.sent){e.next=7;break}return e.abrupt("return");case 7:a={state:2,D_ASSY:t.kaikei.d_assy,C_LINE:t.kaikei.line,C_CA:t.kaikei.ca},t.kaikei.masterRes.push(a),t.kaikei.editingMasterItem=a;case 10:case"end":return e.stop()}}),e)})))()},deleteSelectedMasterKaikeiItems:function(){var t=this;return Object(l.a)(regeneratorRuntime.mark((function e(){var a,i;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.kaikei.selectedMasterItems.forEach((function(t){(!a||a>t.D_ASSY)&&(a=t.D_ASSY)})),!(a&&Math.abs(t.$moment(a).diff(t.$moment(),"days"))>20)){e.next=4;break}return t.$toast.show("Không được xóa ngày Assy cách ngày hiện tại quá 20 ngày!",{duration:5e3,position:"bottom-center"}),e.abrupt("return");case 4:return e.next=6,t.$LOGIN_CONFIRM(t,t.$route.name,"Q3");case 6:if(e.sent){e.next=8;break}return e.abrupt("return");case 8:return e.next=10,t.$CONFIRM(t,"Cảnh Báo","<span class='text-h4'>Bạn có chắc muốn xóa?</span>\n\t\t\t\t",{persistent:!0,color:"red",okText:"OK",disableCancel:!1,width:550});case 10:if(e.sent){e.next=12;break}return e.abrupt("return");case 12:return e.prev=12,t.loading=!0,e.next=16,t.$axios.post("tt-ircs-hinban/delete-master-kaikei",{d_assy:t.kaikei.selectedMasterItems.map((function(t){return t.D_ASSY})),line:t.kaikei.selectedMasterItems.map((function(t){return t.C_LINE})),start:t.kaikei.selectedMasterItems.map((function(t){return t.C_START}))});case 16:i=e.sent,t.loading=!1,console.log(i),"success"!=i.data.message?t.$toast.show("Có lỗi xảy ra!\n".concat(i.data.message),{duration:5e3,position:"bottom-center"}):t.$toast.show("Đã xóa!",{duration:3e3,position:"bottom-center"}),e.next=25;break;case 22:e.prev=22,e.t0=e.catch(12),console.log(e.t0);case 25:return e.prev=25,t.loading=!1,t.searchMasterKaikei(),e.finish(25);case 29:case"end":return e.stop()}}),e,null,[[12,22,25,29]])})))()},searchMasterKaikei:function(){var t=this;return Object(l.a)(regeneratorRuntime.mark((function e(){var a,i;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a="/tt-ircs-hinban/search-master-kaikei?1=1",t.kaikei.d_assy&&""!==t.kaikei.d_assy&&(a=a+"&date="+t.kaikei.d_assy),t.kaikei.line&&""!==t.kaikei.line&&(a=a+"&line="+t.kaikei.line),t.kaikei.ca&&""!==t.kaikei.ca&&(a=a+"&ca="+t.kaikei.ca),e.prev=4,t.loading=!0,e.next=8,t.$axios.get(a);case 8:i=e.sent,console.log(i.data.data),t.kaikei.masterRes=i.data.data.map((function(t){return t.id=t.D_ASSY+t.C_LINE+t.C_START,t}))||[],t.loading=!1,t.kaikei.masterRes.length<1&&t.$toast.show("Không có dữ liệu!",{duration:4e3,position:"bottom-center"}),t.kaikei.editingMasterItem={},e.next=20;break;case 16:e.prev=16,e.t0=e.catch(4),console.log(e.t0),t.kaikei.masterRes.length<1&&t.$toast.show("Có lỗi xảy ra!!!",{duration:5e3,position:"bottom-center"});case 20:return e.prev=20,t.loading=!1,t.kaikei.selectedMasterItems=[],e.finish(20);case 24:case"end":return e.stop()}}),e,null,[[4,16,20,24]])})))()},searchKaikei:function(){var t=this;return Object(l.a)(regeneratorRuntime.mark((function e(){var a,i;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a="/tt-ircs-hinban/search-kaikei?1=1",t.kaikei.d_assy&&""!==t.kaikei.d_assy&&(a=a+"&date="+t.kaikei.d_assy),t.kaikei.line&&""!==t.kaikei.line&&(a=a+"&line="+t.kaikei.line),t.kaikei.ca&&""!==t.kaikei.ca&&(a=a+"&ca="+t.kaikei.ca),e.prev=4,t.loading=!0,e.next=8,t.$axios.get(a);case 8:i=e.sent,console.log(i.data.data),t.kaikeiExp.kaikeiRes=i.data.data||[],t.loading=!1,t.kaikeiExp.kaikeiRes.length<1&&t.$toast.show("Không có dữ liệu!",{duration:4e3,position:"bottom-center"}),e.next=19;break;case 15:e.prev=15,e.t0=e.catch(4),console.log(e.t0),t.kaikeiExp.kaikeiRes.length<1&&t.$toast.show("Có lỗi xảy ra!!!",{duration:5e3,position:"bottom-center"});case 19:return e.prev=19,t.loading=!1,e.finish(19);case 22:case"end":return e.stop()}}),e,null,[[4,15,19,22]])})))()},getData:function(){var t=this;return Object(l.a)(regeneratorRuntime.mark((function e(){var a,i,n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a="/tt-ircs-hinban-v3?1=1",t.selectedDate&&""!==t.selectedDate&&(a=a+"&date="+t.selectedDate),t.selectedSGDate&&""!==t.selectedSGDate&&(a=a+"&sgdate="+t.selectedSGDate),e.prev=3,t.loading=!0,!t.selectedSGDate){e.next=10;break}return e.next=8,t.$axios.get("/tt-ircs-hinban/get-nhan-cong?date=".concat(t.selectedSGDate));case 8:i=e.sent,t.nhanCongData=Object(r.a)(i.data.data);case 10:return e.next=12,t.$axios.get(a);case 12:n=e.sent,console.log(n.data.data),console.log("have data"),t.ttIrcsHinbanData=Object(r.a)(n.data.data),t.loading=!1,t.$forceUpdate(),e.next=23;break;case 20:e.prev=20,e.t0=e.catch(3),console.log(e.t0);case 23:return e.prev=23,t.loading=!1,e.finish(23);case 26:case"end":return e.stop()}}),e,null,[[3,20,23,26]])})))()},onDateChanged:function(t){t&&(this.selectedSGDate=null),this.getData()},onSGDateChanged:function(t){t&&(this.selectedDate=null),this.getData()},onClearDate:function(){this.selectedDate=null,this.getData()},onClearSGDate:function(){this.selectedSGDate=null,this.getData()},onSatusChange:function(t){this.getData()},onViewStyleChanged:function(t){},excelDownload:function(){var t=arguments,e=this;return Object(l.a)(regeneratorRuntime.mark((function a(){var i,n;return regeneratorRuntime.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:i=t.length>0&&void 0!==t[0]?t[0]:null,n=Object(r.a)(e.ttIRCS_Data).map((function(t){var a={"FAP品番":t.FAP品番,"ロットNO":t.ロットNO};return e.selectedSGDate&&(a.CA_CQ=t.CA_CQ),e.selectedSGDate&&(a.DA_DP=t.DA_DP),e.selectedSGDate&&(a.EA_EP=t.EA_EP),e.selectedSGDate&&(a.ST_ALL=t.ST_ALL),a["回路"]=t.回路,a["ラインNO"]=t.ラインNO,a["ASSY日"]=t.ASSY日,a.D_START=t.D_START,a.D_END=t.D_END,a["指示数"]=t.指示数,a["生産合計"]=t.生産合計,a["生産合計_CA4"]=t.生産合計_CA4,a["生産合計_CA3"]=t.生産合計_CA3,e.kameStyle?(a.SCOPE=t.SCOPE,a["1日目"]=t["1日目"],a["1CA4"]=t["1CA4"],a["1CA3"]=t["1CA3"],a["1日目残"]=t["1日目残"],a["1日目_START"]=t["1日目_START"],a["1日目_END"]=t["1日目_END"],a["2日目"]=t["2日目"],a["2CA4"]=t["2CA4"],a["2CA3"]=t["2CA3"],a["2日目残"]=t["2日目残"],a["2日目_START"]=t["2日目_START"],a["2日目_END"]=t["2日目_END"],a["3日目"]=t["3日目"],a["3CA4"]=t["3CA4"],a["3CA3"]=t["3CA3"],a["3日目残"]=t["3日目残"],a["3日目_START"]=t["3日目_START"],a["3日目_END"]=t["3日目_END"],e.maxNichiCol>=4&&(a["4日目"]=t["4日目"],a["4CA4"]=t["4CA4"],a["4CA3"]=t["4CA3"],a["4日目残"]=t["4日目残"],a["4日目_START"]=t["4日目_START"],a["4日目_END"]=t["4日目_END"]),e.maxNichiCol>=5&&(a["5日目"]=t["5日目"],a["5CA4"]=t["5CA4"],a["5CA3"]=t["5CA3"],a["5日目残"]=t["5日目残"],a["5日目_START"]=t["5日目_START"],a["5日目_END"]=t["5日目_END"]),e.maxNichiCol>=6&&(a["6日目"]=t["6日目"],a["6CA4"]=t["6CA4"],a["6CA3"]=t["6CA3"],a["6日目残"]=t["6日目残"],a["6日目_START"]=t["6日目_START"],a["6日目_END"]=t["6日目_END"]),7==e.maxNichiCol&&(a["7日目"]=t["7日目"],a["7CA4"]=t["7CA4"],a["7CA3"]=t["7CA3"],a["7日目残"]=t["7日目残"],a["7日目_START"]=t["7日目_START"],a["7日目_END"]=t["7日目_END"])):!a.ASSY日&&a.FAP品番||e.dateScope.forEach((function(i){a[i]=t[i],a[i+"_CA4"]=t[i+"_CA4"],a[i+"_CA3"]=t[i+"_CA3"],a[i+"_残"]=t[i+"_残"],a[i+"_START"]=t[i+"_START"],a[i+"_END"]=t[i+"_END"],e.selectedSGDate&&(a["ST_SUB%CA4"]=t["ST_SUB%CA4"],a["ST_ASSY%CA4"]=t["ST_ASSY%CA4"],a["ST_QC%CA4"]=t["ST_QC%CA4"],a["ST_ALL%CA4"]=t["ST_ALL%CA4"],a.L_CA4_SUB_NGUOI=t.L_CA4_SUB_NGUOI,a.L_CA4_SUB_TG=t.L_CA4_SUB_TG,a.L_CA4_ASSY_NGUOI=t.L_CA4_ASSY_NGUOI,a.L_CA4_ASSY_TG=t.L_CA4_ASSY_TG,a.L_CA4_QC_NGUOI=t.L_CA4_QC_NGUOI,a.L_CA4_QC_TG=t.L_CA4_QC_TG,a.L_CA4_LUONG=t.L_CA4_LUONG,a["ST_SUB%CA3"]=t["ST_SUB%CA3"],a["ST_ASSY%CA3"]=t["ST_ASSY%CA3"],a["ST_QC%CA3"]=t["ST_QC%CA3"],a["ST_ALL%CA3"]=t["ST_ALL%CA3"],a.L_CA3_SUB_NGUOI=t.L_CA3_SUB_NGUOI,a.L_CA3_SUB_TG=t.L_CA3_SUB_TG,a.L_CA3_ASSY_NGUOI=t.L_CA3_ASSY_NGUOI,a.L_CA3_ASSY_TG=t.L_CA3_ASSY_TG,a.L_CA3_QC_NGUOI=t.L_CA3_QC_NGUOI,a.L_CA3_QC_TG=t.L_CA3_QC_TG,a.L_CA3_LUONG=t.L_CA3_LUONG)})),a.IP_SUB_LIST=t.IP_SUB_LIST,a.S01=t.S01,a.S02=t.S02,a.S03=t.S03,a.S04=t.S04,a.S05=t.S05,a.S06=t.S06,a.S07=t.S07,a.S08=t.S08,a.S09=t.S09,a.S10=t.S10,a.S11=t.S11,a.S12=t.S12,a.S13=t.S13,a.S14=t.S14,a.S15=t.S15,a.S16=t.S16,a.S17=t.S17,a.S18=t.S18,a.S19=t.S19,a.S20=t.S20,a})),i||(i="TT_IRCS_Hinban_"+(e.selectedSGDate||"")+"_"+e.selectedStatus+"_"+e.$moment().format("YYYYMMDD_HHmmss")),c.excelJSExport((function(t){var a={style:"thin",color:{argb:"974706"}},i={type:"pattern",pattern:"solid",fgColor:{argb:"FFFFFF00"}},l={type:"pattern",pattern:"solid",fgColor:{argb:"0000FFFF"}};e.excelHeader.forEach((function(n,l){var r=t.getRow(1);r.getCell(l+1).font=n.font||{bold:!0},r.getCell(l+1).value=n.text,r.getCell(l+1).border={top:a,left:a,bottom:a,right:a},r.getCell(l+1).fill=n.headerFill||i,"L_CA4_LUONG"!=n.value&&"L_CA3_LUONG"!=n.value||(r.getCell(l+1).alignment={vertical:"middle",horizontal:"center"},t.mergeCells(e.$getExcelColumnName(l+1)+"1:"+e.$getExcelColumnName(l+2)+"1")),r.commit()})),e.selectedSGDate?t.views=[{state:"frozen",ySplit:1,xSplit:14}]:t.views=[{state:"frozen",ySplit:1,xSplit:9}],n.forEach((function(i,n){var r=t.getRow(2+n);e.excelHeader.forEach((function(t,e){r.getCell(e+1).value=i[t.value],r.getCell(e+1).border={top:a,left:a,bottom:a,right:a},i["FAP品番"]||(r.getCell(e+1).fill=l,r.getCell(e+1).font={bold:!0})})),r.commit()})),e.excelHeader.forEach((function(e,a){var i=t.getColumn(a+1),n=i.values.map((function(t){return t?t.toString().length:t})),l=Math.max.apply(Math,Object(r.a)(n.filter((function(t){return"number"==typeof t}))));l=e.width?e.width:l>e.text.length?l+3:e.text.length+3,i.width=l})),e.selectedSGDate&&function(){var a,i=2,n=2;do{t.getCell("I"+i).value!=a&&(a=t.getCell("I"+i).value,n=i),t.getCell("A"+i).value||(t.getCell("D"+i).value={formula:"AVERAGE(".concat("D").concat(n,":").concat("D").concat(i-1,")"),result:0},t.getCell("E"+i).value={formula:"AVERAGE(".concat("E").concat(n,":").concat("E").concat(i-1,")"),result:0},t.getCell("F"+i).value={formula:"AVERAGE(".concat("F").concat(n,":").concat("F").concat(i-1,")"),result:0},t.getCell("G"+i).value={formula:"AVERAGE(".concat("G").concat(n,":").concat("G").concat(i-1,")"),result:0},e.excelHeader.forEach((function(a,l){if(a.value==e.selectedSGDate+"_CA4"||a.value==e.selectedSGDate+"_CA3"){t.getCell(e.$getExcelColumnName(l+2)+n).value=t.getCell(e.$getExcelColumnName(l+2)+i).value,t.getCell(e.$getExcelColumnName(l+2)+n).numFmt="0.00%",t.mergeCells(e.$getExcelColumnName(l+2)+n+":"+(e.$getExcelColumnName(l+2)+(i-1))),t.getCell(e.$getExcelColumnName(l+2)+n).alignment={vertical:"middle",horizontal:"center"},t.getCell(e.$getExcelColumnName(l+2)+i).value=null,t.getCell(e.$getExcelColumnName(l+3)+n).value=t.getCell(e.$getExcelColumnName(l+3)+i).value,t.getCell(e.$getExcelColumnName(l+3)+n).numFmt="0.00%",t.mergeCells(e.$getExcelColumnName(l+3)+n+":"+(e.$getExcelColumnName(l+3)+(i-1))),t.getCell(e.$getExcelColumnName(l+3)+n).alignment={vertical:"middle",horizontal:"center"},t.getCell(e.$getExcelColumnName(l+3)+i).value=null,t.getCell(e.$getExcelColumnName(l+4)+n).value=t.getCell(e.$getExcelColumnName(l+4)+i).value,t.getCell(e.$getExcelColumnName(l+4)+n).numFmt="0.00%",t.mergeCells(e.$getExcelColumnName(l+4)+n+":"+(e.$getExcelColumnName(l+4)+(i-1))),t.getCell(e.$getExcelColumnName(l+4)+n).alignment={vertical:"middle",horizontal:"center"},t.getCell(e.$getExcelColumnName(l+4)+i).value=null,t.getCell(e.$getExcelColumnName(l+5)+n).value=t.getCell(e.$getExcelColumnName(l+5)+i).value,t.getCell(e.$getExcelColumnName(l+5)+n).numFmt="0.00%",t.mergeCells(e.$getExcelColumnName(l+5)+n+":"+(e.$getExcelColumnName(l+5)+(i-1))),t.getCell(e.$getExcelColumnName(l+5)+n).alignment={vertical:"middle",horizontal:"center"},t.getCell(e.$getExcelColumnName(l+5)+i).value=null,t.getCell(e.$getExcelColumnName(l+6)+n).value=t.getCell(e.$getExcelColumnName(l+6)+i).value,t.mergeCells(e.$getExcelColumnName(l+6)+n+":"+(e.$getExcelColumnName(l+6)+(i-1))),t.getCell(e.$getExcelColumnName(l+6)+n).alignment={vertical:"middle",horizontal:"center"},t.getCell(e.$getExcelColumnName(l+6)+i).value=null,t.getCell(e.$getExcelColumnName(l+7)+n).value=t.getCell(e.$getExcelColumnName(l+7)+i).value,t.mergeCells(e.$getExcelColumnName(l+7)+n+":"+(e.$getExcelColumnName(l+7)+(i-1))),t.getCell(e.$getExcelColumnName(l+7)+n).alignment={vertical:"middle",horizontal:"center"},t.getCell(e.$getExcelColumnName(l+7)+i).value=null,t.getCell(e.$getExcelColumnName(l+8)+n).value=t.getCell(e.$getExcelColumnName(l+8)+i).value,t.mergeCells(e.$getExcelColumnName(l+8)+n+":"+(e.$getExcelColumnName(l+8)+(i-1))),t.getCell(e.$getExcelColumnName(l+8)+n).alignment={vertical:"middle",horizontal:"center"},t.getCell(e.$getExcelColumnName(l+8)+i).value=null,t.getCell(e.$getExcelColumnName(l+9)+n).value=t.getCell(e.$getExcelColumnName(l+9)+i).value,t.mergeCells(e.$getExcelColumnName(l+9)+n+":"+(e.$getExcelColumnName(l+9)+(i-1))),t.getCell(e.$getExcelColumnName(l+9)+n).alignment={vertical:"middle",horizontal:"center"},t.getCell(e.$getExcelColumnName(l+9)+i).value=null,t.getCell(e.$getExcelColumnName(l+10)+n).value=t.getCell(e.$getExcelColumnName(l+10)+i).value,t.mergeCells(e.$getExcelColumnName(l+10)+n+":"+(e.$getExcelColumnName(l+10)+(i-1))),t.getCell(e.$getExcelColumnName(l+10)+n).alignment={vertical:"middle",horizontal:"center"},t.getCell(e.$getExcelColumnName(l+10)+i).value=null,t.getCell(e.$getExcelColumnName(l+11)+n).value=t.getCell(e.$getExcelColumnName(l+11)+i).value,t.mergeCells(e.$getExcelColumnName(l+11)+n+":"+(e.$getExcelColumnName(l+11)+(i-1))),t.getCell(e.$getExcelColumnName(l+11)+n).alignment={vertical:"middle",horizontal:"center"},t.getCell(e.$getExcelColumnName(l+11)+i).value=null;for(var r=n;r<i;r++)t.getCell(e.$getExcelColumnName(l+12)+r).value={formula:"".concat("H").concat(r,"*").concat(e.$getExcelColumnName(l+1)+r),result:0};t.getCell(e.$getExcelColumnName(l+12)+i).value={formula:"SUM(".concat(e.$getExcelColumnName(l+12)+n,":").concat(e.$getExcelColumnName(l+12)+(i-1),")"),result:0},t.getCell(e.$getExcelColumnName(l+13)+n).value=t.getCell(e.$getExcelColumnName(l+13)+i).value,t.mergeCells(e.$getExcelColumnName(l+13)+n+":"+(e.$getExcelColumnName(l+13)+(i-1))),t.getCell(e.$getExcelColumnName(l+13)+n).alignment={vertical:"middle",horizontal:"center"},t.getCell(e.$getExcelColumnName(l+13)+i).value=null,t.getCell(e.$getExcelColumnName(l+14)+n).value={formula:"((".concat(e.$getExcelColumnName(l+6)+n,"*(").concat(e.$getExcelColumnName(l+7)+n,"/60))+(").concat(e.$getExcelColumnName(l+8)+n,"*(").concat(e.$getExcelColumnName(l+9)+n,"/60))+(").concat(e.$getExcelColumnName(l+10)+n,"*(").concat(e.$getExcelColumnName(l+11)+n,"/60)))*").concat(e.$getExcelColumnName(l+13)+n),result:0},t.getCell(e.$getExcelColumnName(l+14)+n).numFmt="#,##0.00;[Red]-#,##0.00",t.mergeCells(e.$getExcelColumnName(l+14)+n+":"+(e.$getExcelColumnName(l+14)+(i-1))),t.getCell(e.$getExcelColumnName(l+14)+n).alignment={vertical:"middle",horizontal:"center"},t.getCell(e.$getExcelColumnName(l+14)+i).value={formula:e.$getExcelColumnName(l+12)+i+"-"+(e.$getExcelColumnName(l+14)+n),result:0},t.getCell(e.$getExcelColumnName(l+14)+i).numFmt="#,##0.00;[Red]-#,##0.00"}}))),i+=1}while(t.getCell("I"+i).value)}()}),{sheetName:"Sheet1",opts:{}},i);case 4:case"end":return a.stop()}}),a)})))()},exportKaikeiData:function(){var t=this;return Object(l.a)(regeneratorRuntime.mark((function e(){var a;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:a="Kaikei_data_"+t.kaikei.d_assy+(t.kaikei.line?"_"+t.kaikei.line:"")+(t.kaikei.ca?"_"+t.kaikei.ca:""),c.excelJSExport((function(e){var a={vertical:"middle",horizontal:"center"},i={style:"thin",color:{argb:"FFA6A6A6"}},n={type:"pattern",pattern:"solid",fgColor:{argb:"FF00FFFF"}},l=e.getRow(1),s=[{value:"D_ASSY",excelHeader:"D_ASSY"},{value:"C_LINE",excelHeader:"LINE"},{value:"C_CA",excelHeader:"CA"}].concat(Object(r.a)(t.kaikeiExp.kaikeiHeader));s.forEach((function(t,e){l.getCell(e+1).font={bold:!0},l.getCell(e+1).value=t.excelHeader,l.getCell(e+1).border={top:i,left:i,bottom:i,right:i},l.getCell(e+1).fill=n,l.getCell(e+1).alignment=a})),l.commit(),e.views=[{state:"frozen",ySplit:2}],t.kaikeiView.forEach((function(t,a){var n=e.getRow(2+a);s.forEach((function(e,a){n.getCell(a+1).value=t[e.value],n.getCell(a+1).border={top:i,left:i,bottom:i,right:i},"SUB_PERCENT"!=e.value&&"ASSY_PERCENT"!=e.value&&"QC_PERCENT"!=e.value&&"ALL_PERCENT"!=e.value||(n.getCell(a+1).numFmt="0.00%"),t.C_START||t.C_HIN||(n.getCell(a+1).font={bold:!0,size:12})})),n.commit()})),t.kaikeiExp.kaikeiHeader.forEach((function(t,a){var i=e.getColumn(a+1),n=i.values.map((function(t){return t.toString().length})),l=Math.max.apply(Math,Object(r.a)(n.filter((function(t){return"number"==typeof t}))));l=l>t.excelHeader.length?l+2:t.excelHeader.length+2,i.width=l})),e.addConditionalFormatting({ref:"A2:"+t.$getExcelColumnName(s.length)+(t.kaikeiView.length+1),rules:[{type:"expression",formulae:["AND(ISBLANK($D2),ISBLANK($P2))"],style:{fill:{type:"pattern",pattern:"solid",fgColor:{argb:"FFD7BF8F"},bgColor:{argb:"FFD7BF8F"}}}}]}),e.addConditionalFormatting({ref:"A2:"+t.$getExcelColumnName(s.length)+(t.kaikeiView.length+1),rules:[{type:"expression",formulae:["AND(ISBLANK($D2)=FALSE,ISBLANK($P2))"],style:{fill:{type:"pattern",pattern:"solid",fgColor:{argb:"FFEEECE1"},bgColor:{argb:"FFEEECE1"}}}}]})}),{sheetName:"Sheet1",opts:{}},a);case 2:case"end":return e.stop()}}),e)})))()}}),Object(n.a)(i,"beforeDestroy",(function(){})),i),S=C,m=(a(1030),a(82)),A=a(111),h=a.n(A),v=a(402),g=a(408),p=a(409),k=a(239),f=a(410),x=a(393),b=a(330),T=a(396),N=a(392),D=a(422),E=a(412),L=a(200),w=a(404),G=a(202),O=a(407),I=a(398),U=a(41),y=a(395),R=a(399),$=a(400),M=a(423),F=a(62),H=a(103),Y=a(162),B=a(421),P=Object(m.a)(S,(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{class:t.$nuxt.context.isMobile?"mobile":"",attrs:{id:"page-thuc-tich-ircs-hinban"}},[a("div",[a("v-alert",{attrs:{value:t.alert,type:"warning",border:"top",transition:"scale-transition"}},[t._v("\n\t\t\t\tLỗi!!\n\t\t\t")]),t._v(" "),a("v-toolbar",{attrs:{dark:"",height:"60px",color:"brown",dense:""}},[a("a",{attrs:{href:t.$nuxt.context.pkg.base+"/thuc-tich-ircs"}},[a("span",{staticStyle:{color:"greenyellow","font-size":"1rem"}},[a("span",[t._v("IRCS 実績")]),t.$nuxt.context.isMobile?t._e():a("span",[t._v("ページへ")])])]),t._v(" "),a("v-spacer"),t._v(" "),a("v-divider",{attrs:{vertical:""}}),t._v(" "),t.$nuxt.context.isMobile?t._e():a("div",{staticClass:"mx-2"},[a("v-menu",{attrs:{"close-on-content-click":!1,"nudge-right":40,disabled:t.loading,transition:"scale-transition","offset-y":""},scopedSlots:t._u([{key:"activator",fn:function(e){var i=e.on,n=e.attrs;return[a("v-text-field",t._g(t._b({attrs:{label:"作業日",readonly:"",disabled:t.loading,"hide-details":!0,clearable:!0},on:{"click:clear":t.onClearSGDate},model:{value:t.selectedSGDate,callback:function(e){t.selectedSGDate=e},expression:"selectedSGDate"}},"v-text-field",n,!1),i))]}}],null,!1,1789307646),model:{value:t.mSelectSGDate,callback:function(e){t.mSelectSGDate=e},expression:"mSelectSGDate"}},[t._v(" "),a("v-date-picker",{attrs:{"allowed-dates":t.allowedDatePicker,"show-week":!0,"show-adjacent-months":!1,locale:"jp-jp","day-format":t.dayFormat,"no-title":""},on:{input:function(e){t.mSelectSGDate=!1},change:t.onSGDateChanged},model:{value:t.selectedSGDate,callback:function(e){t.selectedSGDate=e},expression:"selectedSGDate"}})],1)],1),t._v(" "),t.$nuxt.context.isMobile?t._e():a("v-btn-toggle",{attrs:{color:"yellow",dense:"",group:"",mandatory:""},model:{value:t.selectedStatus,callback:function(e){t.selectedStatus=e},expression:"selectedStatus"}},[a("v-btn",{attrs:{disabled:t.loading||null!=t.selectedSGDate,value:"ALL",text:""}},[t._v("\n\t\t\t\t\t\tALL\n\t\t\t\t\t")]),t._v(" "),a("v-btn",{attrs:{disabled:t.loading||null!=t.selectedSGDate,value:"中",text:""}},[t._v("\n\t\t\t\t\t\t中\n\t\t\t\t\t")]),t._v(" "),a("v-btn",{attrs:{disabled:t.loading||null!=t.selectedSGDate,value:"完成",text:""}},[t._v("\n\t\t\t\t\t\t完成\n\t\t\t\t\t")]),t._v(" "),a("v-btn",{attrs:{disabled:t.loading||null!=t.selectedSGDate,value:"未完成",text:""}},[t._v("\n\t\t\t\t\t\t未完成\n\t\t\t\t\t")]),t._v(" "),a("v-btn",{attrs:{disabled:t.loading||null!=t.selectedSGDate,value:"まだ",text:""}},[t._v("\n\t\t\t\t\t\tまだ\n\t\t\t\t\t")])],1),t._v(" "),t.$nuxt.context.isMobile?a("v-select",{attrs:{items:t.statusOptionsItems},on:{change:t.onSatusChange},model:{value:t.selectedStatus,callback:function(e){t.selectedStatus=e},expression:"selectedStatus"}}):t._e(),t._v(" "),a("v-divider",{attrs:{vertical:""}}),t._v(" "),t.$nuxt.context.isMobile?t._e():a("div",{staticClass:"mx-2"},[a("v-menu",{attrs:{"close-on-content-click":!1,"nudge-right":40,disabled:t.loading,transition:"scale-transition","offset-y":""},scopedSlots:t._u([{key:"activator",fn:function(e){var i=e.on,n=e.attrs;return[a("v-text-field",t._g(t._b({attrs:{label:"ASSY日",readonly:"",disabled:t.loading,"hide-details":!0,clearable:!0},on:{"click:clear":t.onClearDate},model:{value:t.selectedDate,callback:function(e){t.selectedDate=e},expression:"selectedDate"}},"v-text-field",n,!1),i))]}}],null,!1,4156286871),model:{value:t.mSelectDate,callback:function(e){t.mSelectDate=e},expression:"mSelectDate"}},[t._v(" "),a("v-date-picker",{attrs:{"allowed-dates":t.allowedDatePicker,"show-week":!0,"show-adjacent-months":!1,locale:"jp-jp","day-format":t.dayFormat,"no-title":""},on:{input:function(e){t.mSelectDate=!1},change:t.onDateChanged},model:{value:t.selectedDate,callback:function(e){t.selectedDate=e},expression:"selectedDate"}})],1)],1),t._v(" "),a("v-divider",{attrs:{vertical:""}}),t._v(" "),t.$nuxt.context.isMobile?t._e():a("v-btn",{staticClass:"ma-2 white--text",attrs:{color:"green",disabled:t.ttIRCS_Data.length<=0||t.loading,small:t.$nuxt.context.isMobile},on:{click:function(e){return t.excelDownload()}}},[t._v("\n\t\t\t\t\tExcel\n\t\t\t\t\t"),a("v-icon",{attrs:{right:"",dark:""}},[t._v(" mdi-cloud-download ")])],1),t._v(" "),a("v-divider",{attrs:{vertical:""}}),t._v(" "),a("v-btn",{staticClass:"ma-2 white--text",attrs:{color:"pink",disabled:t.loading,small:t.$nuxt.context.isMobile},on:{click:t.getData}},[t._v("\n\t\t\t\t\t更新\n\t\t\t\t\t"),t.$nuxt.context.isMobile?t._e():a("v-icon",{class:t.loading?"mdi-spin":"",attrs:{right:"",dark:""}},[t._v("\n\t\t\t\t\t\tmdi-refresh-circle\n\t\t\t\t\t")])],1),t._v(" "),a("v-divider",{attrs:{vertical:""}}),t._v(" "),a("v-spacer"),t._v(" "),a("v-btn",{staticClass:"ma-2 white--text",attrs:{color:"red",small:t.$nuxt.context.isMobile},on:{click:t.openMasterKaikei}},[t._v("\n\t\t\t\t\tKaikei\n\t\t\t\t\t")])],1),t._v(" "),a("v-row",[a("v-col",{attrs:{sm:"12"}},[a("div",[a("v-data-table",{staticClass:"elevation-1",attrs:{headers:t.headers,"fixed-header":!0,items:t.ttIRCS_Data,"item-class":"rowClass",height:"75vh","multi-sort":!1,"disable-sort":!0,loading:t.loading,"hide-default-footer":!1,"hide-default-header":"","mobile-breakpoint":"0","show-expand":"","single-expand":"","items-per-page":500,"footer-props":{"items-per-page-options":[500,1e3,1500,-1]}},scopedSlots:t._u([{key:"header",fn:function(e){return[a("thead",{staticClass:"v-data-table-header"},[a("tr",t._l(t.headers,(function(e,i){return a("th",{key:i,class:e.class,staticStyle:{border:"1px solid black"},attrs:{rowspan:e.children?1:2,colspan:e.children?e.children.length:1,width:e.width}},[a("span",{domProps:{innerHTML:t._s(e.text)}})])})),0),t._v(" "),a("tr",t._l(t.getSubHeader(t.headers),(function(e,i){return a("th",{key:i,class:e.class,staticStyle:{border:"1px solid black"},attrs:{width:e.width}},[a("span",{domProps:{innerHTML:t._s(e.text)}})])})),0)])]}},{key:"item",fn:function(e){return[a("tr",{class:e.item.FAP品番?"":"row-sum"},t._l(t.getRows(e.item),(function(i,n){return a("td",{key:n,class:i.cellClass.concat(0==i.colVal?["cell-zero"]:[],i.colVal<0?["cell-negative"]:[],"FAP品番"==i.value&&"new-hin"==e.item.hinStatus?["cell-new-hin"]:[],"FAP品番"==i.value&&"comback-hin"==e.item.hinStatus?["cell-comback-hin"]:[]),style:e.item.FAP品番||t.selectedSGDate+"_残"!=i.value&&t.selectedDate+"_残"!=i.value?"border: 1px solid black":"border: 1px solid black;background-color: yellow"},[e.item.FAP品番||1!=n?i.colVal&&(e.item[i.value+"_CA4"]||e.item[i.value+"_CA3"])?a("v-badge",{attrs:{inline:"",overlap:"",left:"",color:e.item[i.value+"_CA4"]?"blue":"transparent",content:e.item[i.value+"_CA4"]}},[a("v-badge",{attrs:{inline:"",overlap:"",color:e.item[i.value+"_CA3"]?"red":"transparent",content:e.item[i.value+"_CA3"]}},[a("v-tooltip",{attrs:{bottom:""},scopedSlots:t._u([{key:"activator",fn:function(e){var n=e.on,l=e.attrs;return[a("span",t._g(t._b({},"span",l,!1),n),[t._v(t._s(i.colVal))])]}}],null,!0)},[t._v(" "),a("span",[t._v("\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tCA4 ->\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t"+t._s(e.item[i.value+"_CA4"])+"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t"),a("br"),t._v("\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tCA3 ->\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t"+t._s(e.item[i.value+"_CA3"])+"\n\t\t\t\t\t\t\t\t\t\t\t\t\t")]),t._v(" "),a("br"),t._v(" "),e.item["FAP品番"]?a("span",[t._v("\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t"+t._s(e.item[i.value+"_START"]||e.item.D_START)+"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t"),a("br"),t._v("\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t"+t._s(e.item[i.value+"_END"]||e.item.D_END)+"\n\t\t\t\t\t\t\t\t\t\t\t\t\t")]):t._e()])],1)],1):"ASSY日"==i.value||"D_START"==i.value||"D_END"==i.value?a("span",[t._v("\n\t\t\t\t\t\t\t\t\t\t\t"+t._s(i.colVal?i.colVal.substring(5):"")+"\n\t\t\t\t\t\t\t\t\t\t")]):"ST_SUB%CA4"==i.value||"ST_ASSY%CA4"==i.value||"ST_QC%CA4"==i.value||"ST_ALL%CA4"==i.value?a("span",{staticClass:"green--text font-weight-bold"},[t._v("\n\t\t\t\t\t\t\t\t\t\t\t"+t._s(i.colVal?t.percentFormatter.format(i.colVal):"")+"\n\t\t\t\t\t\t\t\t\t\t")]):"ST_SUB%CA3"==i.value||"ST_ASSY%CA3"==i.value||"ST_QC%CA3"==i.value||"ST_ALL%CA3"==i.value?a("span",{staticClass:"deep-orange--text font-weight-bold"},[t._v("\n\t\t\t\t\t\t\t\t\t\t\t"+t._s(i.colVal?t.percentFormatter.format(i.colVal):"")+"\n\t\t\t\t\t\t\t\t\t\t")]):"SUB"==i.value&&e.item["FAP品番"]?a("span",[a("v-tooltip",{attrs:{bottom:""},scopedSlots:t._u([{key:"activator",fn:function(i){var n=i.on,l=i.attrs;return[a("table",t._g(t._b({staticClass:"tbl-sub",attrs:{width:"100%"}},"table",l,!1),n),[a("tr",[a("td",[t._v("\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t"+t._s(e.item.S01||"-")+"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t")]),t._v(" "),a("td",[t._v("\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t"+t._s(e.item.S02||"-")+"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t")]),t._v(" "),a("td",[t._v("\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t"+t._s(e.item.S03||"-")+"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t")]),t._v(" "),a("td",[t._v("\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t"+t._s(e.item.S04||"-")+"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t")])]),t._v(" "),a("tr",[a("td",[t._v("\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t"+t._s(e.item.S05||"-")+"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t")]),t._v(" "),a("td",[t._v("\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t"+t._s(e.item.S06||"-")+"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t")]),t._v(" "),a("td",[t._v("\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t"+t._s(e.item.S07||"-")+"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t")]),t._v(" "),a("td",[t._v("\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t"+t._s(e.item.S08||"-")+"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t")])]),t._v(" "),a("tr",[a("td",[t._v("\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t"+t._s(e.item.S09||"-")+"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t")]),t._v(" "),a("td",[t._v("\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t"+t._s(e.item.S10||"-")+"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t")]),t._v(" "),a("td",[t._v("\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t"+t._s(e.item.S11||"-")+"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t")]),t._v(" "),a("td",[t._v("\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t"+t._s(e.item.S12||"-")+"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t")])]),t._v(" "),a("tr",[a("td",[t._v("\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t"+t._s(e.item.S13||"-")+"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t")]),t._v(" "),a("td",[t._v("\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t"+t._s(e.item.S14||"-")+"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t")]),t._v(" "),a("td",[t._v("\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t"+t._s(e.item.S15||"-")+"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t")]),t._v(" "),a("td",[t._v("\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t"+t._s(e.item.S16||"-")+"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t")])]),t._v(" "),e.item.S17?a("tr",[a("td",[t._v("\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t"+t._s(e.item.S17||"-")+"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t")]),t._v(" "),a("td",[t._v("\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t"+t._s(e.item.S18||"-")+"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t")]),t._v(" "),a("td",[t._v("\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t"+t._s(e.item.S19||"-")+"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t")]),t._v(" "),a("td",[t._v("\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t"+t._s(e.item.S20||"-")+"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t")])]):t._e()])]}}],null,!0)},[t._v(" "),a("span",[a("table",[a("tr",[a("td",[e.item.subTooltip1?a("v-banner",{staticClass:"px-2",attrs:{transition:"slide-y-transition",color:"purple lighten-3"},domProps:{innerHTML:t._s(e.item.subTooltip1||"")}}):t._e()],1),t._v(" "),a("td",[e.item.subTooltip2?a("v-banner",{staticClass:"px-2",attrs:{transition:"slide-y-transition",color:"purple lighten-3"},domProps:{innerHTML:t._s(e.item.subTooltip2||"")}}):t._e()],1),t._v(" "),a("td",[e.item.subTooltip3?a("v-banner",{staticClass:"px-2",attrs:{transition:"slide-y-transition",color:"purple lighten-3"},domProps:{innerHTML:t._s(e.item.subTooltip3||"")}}):t._e()],1),t._v(" "),a("td",[e.item.subTooltip4?a("v-banner",{staticClass:"px-2",attrs:{transition:"slide-y-transition",color:"purple lighten-3"},domProps:{innerHTML:t._s(e.item.subTooltip4||"")}}):t._e()],1)])])])])],1):a("span",[t._v("\n\t\t\t\t\t\t\t\t\t\t\t"+t._s(i.colVal)+"\n\t\t\t\t\t\t\t\t\t\t")]):a("v-chip",{staticClass:"text-h6 white--text",attrs:{small:"",color:"green accent-4"}},[t._v("\n\t\t\t\t\t\t\t\t\t\t\t"+t._s(i.colVal)+"\n\t\t\t\t\t\t\t\t\t\t")])],1)})),0)]}}])})],1)])],1)],1),t._v(" "),a("v-dialog",{attrs:{fullscreen:"","hide-overlay":"",transition:"dialog-bottom-transition"},model:{value:t.kaikeiDialog,callback:function(e){t.kaikeiDialog=e},expression:"kaikeiDialog"}},[a("v-card",[a("v-toolbar",{attrs:{dark:"",color:"red"}},[a("v-btn",{attrs:{icon:"",dark:""},on:{click:function(e){t.kaikeiDialog=!1,t.kaikei.masterRes=[],t.kaikei.selectedMasterItems=[],t.kaikeiExp.kaikeiRes=[]}}},[a("v-icon",[t._v("mdi-close")])],1),t._v(" "),a("v-spacer"),t._v(" "),a("v-toolbar-title",{},[t._v("会計 計算")]),t._v(" "),a("v-spacer")],1),t._v(" "),a("v-container",{attrs:{fluid:""}},[a("v-tabs",{attrs:{color:"pink",left:"","background-color":"black"}},[a("v-tab",{staticClass:"white--text"},[t._v("1.Master")]),t._v(" "),a("v-divider",{attrs:{vertical:""}}),t._v(" "),a("v-tab",{staticClass:"white--text"},[t._v("2.Kaikei Data")]),t._v(" "),a("v-tab-item",{staticClass:"grey lighten-4",staticStyle:{height:"85vh"}},[a("v-toolbar",{attrs:{dark:"",color:"black"}},[a("v-menu",{attrs:{"close-on-content-click":!1,"nudge-right":40,disabled:t.loading,transition:"scale-transition","offset-y":""},scopedSlots:t._u([{key:"activator",fn:function(e){var i=e.on,n=e.attrs;return[a("v-text-field",t._g(t._b({staticClass:"shrink mr-2",attrs:{label:"ASSY日",readonly:"",disabled:t.loading,"hide-details":!0,clearable:!0,outlined:"",dense:""},on:{"click:clear":function(e){t.kaikei.d_assy=null}},model:{value:t.kaikei.d_assy,callback:function(e){t.$set(t.kaikei,"d_assy",e)},expression:"kaikei.d_assy"}},"v-text-field",n,!1),i))]}}]),model:{value:t.mSelecMasterKaikeiDate,callback:function(e){t.mSelecMasterKaikeiDate=e},expression:"mSelecMasterKaikeiDate"}},[t._v(" "),a("v-date-picker",{attrs:{"allowed-dates":t.allowedDatePicker,"show-week":!0,"show-adjacent-months":!1,locale:"jp-jp","day-format":t.dayFormat,"no-title":""},on:{input:function(e){t.mSelecMasterKaikeiDate=!1}},model:{value:t.kaikei.d_assy,callback:function(e){t.$set(t.kaikei,"d_assy",e)},expression:"kaikei.d_assy"}})],1),t._v(" "),a("v-select",{staticClass:"shrink mr-2 search-field",attrs:{items:t.lineList,label:"chọn LINE",color:"pink",outlined:"",dense:"",clearable:"","hide-details":"auto"},model:{value:t.kaikei.line,callback:function(e){t.$set(t.kaikei,"line",e)},expression:"kaikei.line"}}),t._v(" "),a("v-select",{staticClass:"shrink mr-2 search-field",attrs:{items:["CA3","CA4"],label:"chọn CA",color:"pink",outlined:"",dense:"",clearable:"","hide-details":"auto"},model:{value:t.kaikei.ca,callback:function(e){t.$set(t.kaikei,"ca",e)},expression:"kaikei.ca"}}),t._v(" "),a("v-divider",{staticClass:"mx-2",attrs:{vertical:""}}),t._v(" "),a("v-btn",{staticClass:"mr-2",attrs:{color:"primary"},on:{click:function(e){return t.searchMasterKaikei()}}},[t._v("\n\t\t\t\t\t\t\t\t\tSEARCH\n\t\t\t\t\t\t\t\t")]),t._v(" "),a("v-spacer"),t._v(" "),a("v-divider",{staticClass:"mx-2",attrs:{vertical:""}}),t._v(" "),a("a",{attrs:{href:t.$nuxt.context.pkg.base+"/thuc-tich-ircs-hinban/F_import_master_kaikei.xls"}},[t._v("file mẫu")]),t._v(" "),a("input",{ref:"uploadKaikeiFile",attrs:{type:"file",hidden:"hidden"},on:{change:t.handleFileChange}}),t._v(" "),a("v-btn",{staticClass:"ml-2",attrs:{color:"green"},on:{click:t.btnMasterKaikeiIMPClick}},[t._v("\n\t\t\t\t\t\t\t\t\tIMPORT\n\t\t\t\t\t\t\t\t")])],1),t._v(" "),a("span",[a("v-btn",{staticClass:"my-1 white--text",attrs:{color:"red",densen:"",disabled:t.kaikei.selectedMasterItems.length<1},on:{click:t.deleteSelectedMasterKaikeiItems}},[t._v("\n\t\t\t\t\t\t\t\t\tXÓA\n\t\t\t\t\t\t\t\t\t"),a("v-icon",[t._v(" mdi-delete-circle ")])],1),t._v(" "),a("v-btn",{staticClass:"my-1 white--text",attrs:{color:"green",densen:"",disabled:!!t.kaikei.editingMasterItem.D_ASSY},on:{click:t.addNewMasterKaikei}},[t._v("\n\t\t\t\t\t\t\t\t\tThêm\n\t\t\t\t\t\t\t\t\t"),a("v-icon",[t._v(" mdi-plus-circle ")])],1)],1),t._v(" "),a("v-data-table",{staticClass:"elevation-1",attrs:{items:t.masterKaikeiView,"fixed-header":!0,"disable-sort":"",height:"70vh",dense:"","show-select":"","item-key":"id",headers:t.kaikei.masterHeader,"items-per-page":-1,"hide-default-footer":""},scopedSlots:t._u([{key:"item.ACTION",fn:function(e){var i=e.item;return[a("span",[a("span",{staticStyle:{display:"none"}},[t._v("\n\t\t\t\t\t\t\t\t\t\t\t"+t._s(i.state)+"\n\t\t\t\t\t\t\t\t\t\t")]),t._v(" "),i.D_UPDATE?a("v-tooltip",{attrs:{top:""},scopedSlots:t._u([{key:"activator",fn:function(e){var n=e.on,l=e.attrs;return[a("v-icon",t._g(t._b({staticClass:"mdi-24px",attrs:{small:"",color:"blue",disabled:0==!Object.keys(t.kaikei.editingMasterItem).length},on:{click:function(e){return t.editMasterKaikei(i)}}},"v-icon",l,!1),n),[t._v("\n\t\t\t\t\t\t\t\t\t\t\t\t\tmdi-pencil-circle\n\t\t\t\t\t\t\t\t\t\t\t\t")])]}}],null,!0)},[t._v(" "),a("span",[t._v("Chỉnh sửa")])]):t._e(),t._v(" "),i.state?a("v-tooltip",{attrs:{top:""},scopedSlots:t._u([{key:"activator",fn:function(e){var i=e.on,n=e.attrs;return[a("v-icon",t._g(t._b({staticClass:"mdi-24px",attrs:{small:"",color:"green"},on:{click:function(e){return t.saveEditingMasterKaikei()}}},"v-icon",n,!1),i),[t._v("\n\t\t\t\t\t\t\t\t\t\t\t\t\tmdi-content-save\n\t\t\t\t\t\t\t\t\t\t\t\t")])]}}],null,!0)},[t._v(" "),a("span",[t._v("Save")])]):t._e(),t._v(" "),i.state?a("v-tooltip",{attrs:{top:""},scopedSlots:t._u([{key:"activator",fn:function(e){var n=e.on,l=e.attrs;return[a("v-icon",t._g(t._b({staticClass:"mdi-18px",attrs:{small:"",color:"red"},on:{click:function(e){2==i.state?t.searchMasterKaikei():t.cancelEditMasterKaikei(i)}}},"v-icon",l,!1),n),[t._v("\n\t\t\t\t\t\t\t\t\t\t\t\t\tmdi-cancel\n\t\t\t\t\t\t\t\t\t\t\t\t")])]}}],null,!0)},[t._v(" "),a("span",[t._v("Hủy")])]):t._e()],1)]}},{key:"item.C_CA",fn:function(e){var i=e.item;return[a("span",[i.state?t._e():a("span",[t._v(t._s(i.C_CA))]),t._v(" "),i.state?a("span",[a("input",{directives:[{name:"model",rawName:"v-model",value:t.kaikei.editingMasterItem.C_CA,expression:"\n\t\t\t\t\t\t\t\t\t\t\t\t\tkaikei.editingMasterItem[\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t'C_CA'\n\t\t\t\t\t\t\t\t\t\t\t\t\t]\n\t\t\t\t\t\t\t\t\t\t\t\t"}],staticStyle:{border:"1px solid blue",width:"50px"},attrs:{type:"text"},domProps:{value:t.kaikei.editingMasterItem.C_CA},on:{input:function(e){e.target.composing||t.$set(t.kaikei.editingMasterItem,"C_CA",e.target.value)}}})]):t._e()])]}},{key:"item.C_START",fn:function(e){var i=e.item;return[a("span",[i.state&&1!=i.state?t._e():a("span",[t._v(t._s(i.C_START))]),t._v(" "),2==i.state?a("span",[a("input",{directives:[{name:"model",rawName:"v-model",value:t.kaikei.editingMasterItem.C_START,expression:"\n\t\t\t\t\t\t\t\t\t\t\t\t\tkaikei.editingMasterItem[\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t'C_START'\n\t\t\t\t\t\t\t\t\t\t\t\t\t]\n\t\t\t\t\t\t\t\t\t\t\t\t"},{name:"mask",rawName:"v-mask",value:t.timeRangeMask,expression:"timeRangeMask"}],staticStyle:{border:"1px solid blue",width:"100px"},attrs:{type:"text"},domProps:{value:t.kaikei.editingMasterItem.C_START},on:{input:function(e){e.target.composing||t.$set(t.kaikei.editingMasterItem,"C_START",e.target.value)}}})]):t._e()])]}},{key:"item.C_END",fn:function(e){var i=e.item;return[a("span",[i.state?t._e():a("span",[t._v(t._s(i.C_END))]),t._v(" "),i.state?a("span",[a("input",{directives:[{name:"model",rawName:"v-model",value:t.kaikei.editingMasterItem.C_END,expression:"\n\t\t\t\t\t\t\t\t\t\t\t\t\tkaikei.editingMasterItem[\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t'C_END'\n\t\t\t\t\t\t\t\t\t\t\t\t\t]\n\t\t\t\t\t\t\t\t\t\t\t\t"},{name:"mask",rawName:"v-mask",value:t.timeRangeMask,expression:"timeRangeMask"}],staticStyle:{border:"1px solid blue",width:"100px"},attrs:{type:"text"},domProps:{value:t.kaikei.editingMasterItem.C_END},on:{input:function(e){e.target.composing||t.$set(t.kaikei.editingMasterItem,"C_END",e.target.value)}}})]):t._e()])]}},{key:"item.SUB_NGUOI",fn:function(e){var i=e.item;return[a("span",[i.state?t._e():a("span",[t._v(t._s(i.SUB_NGUOI))]),t._v(" "),i.state?a("span",[a("input",{directives:[{name:"model",rawName:"v-model",value:t.kaikei.editingMasterItem.SUB_NGUOI,expression:"\n\t\t\t\t\t\t\t\t\t\t\t\t\tkaikei.editingMasterItem[\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t'SUB_NGUOI'\n\t\t\t\t\t\t\t\t\t\t\t\t\t]\n\t\t\t\t\t\t\t\t\t\t\t\t"}],staticStyle:{border:"1px solid blue",width:"60px"},attrs:{type:"number"},domProps:{value:t.kaikei.editingMasterItem.SUB_NGUOI},on:{input:function(e){e.target.composing||t.$set(t.kaikei.editingMasterItem,"SUB_NGUOI",e.target.value)}}})]):t._e()])]}},{key:"item.SUB_TG",fn:function(e){var i=e.item;return[a("span",[i.state?t._e():a("span",[t._v(t._s(i.SUB_TG))]),t._v(" "),i.state?a("span",[a("input",{directives:[{name:"model",rawName:"v-model",value:t.kaikei.editingMasterItem.SUB_TG,expression:"\n\t\t\t\t\t\t\t\t\t\t\t\t\tkaikei.editingMasterItem[\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t'SUB_TG'\n\t\t\t\t\t\t\t\t\t\t\t\t\t]\n\t\t\t\t\t\t\t\t\t\t\t\t"}],staticStyle:{border:"1px solid blue",width:"60px"},attrs:{type:"number"},domProps:{value:t.kaikei.editingMasterItem.SUB_TG},on:{input:function(e){e.target.composing||t.$set(t.kaikei.editingMasterItem,"SUB_TG",e.target.value)}}})]):t._e()])]}},{key:"item.ASSY_NGUOI",fn:function(e){var i=e.item;return[a("span",[i.state?t._e():a("span",[t._v(t._s(i.ASSY_NGUOI))]),t._v(" "),i.state?a("span",[a("input",{directives:[{name:"model",rawName:"v-model",value:t.kaikei.editingMasterItem.ASSY_NGUOI,expression:"\n\t\t\t\t\t\t\t\t\t\t\t\t\tkaikei.editingMasterItem[\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t'ASSY_NGUOI'\n\t\t\t\t\t\t\t\t\t\t\t\t\t]\n\t\t\t\t\t\t\t\t\t\t\t\t"}],staticStyle:{border:"1px solid blue",width:"60px"},attrs:{type:"number"},domProps:{value:t.kaikei.editingMasterItem.ASSY_NGUOI},on:{input:function(e){e.target.composing||t.$set(t.kaikei.editingMasterItem,"ASSY_NGUOI",e.target.value)}}})]):t._e()])]}},{key:"item.ASSY_TG",fn:function(e){var i=e.item;return[a("span",[i.state?t._e():a("span",[t._v(t._s(i.ASSY_TG))]),t._v(" "),i.state?a("span",[a("input",{directives:[{name:"model",rawName:"v-model",value:t.kaikei.editingMasterItem.ASSY_TG,expression:"\n\t\t\t\t\t\t\t\t\t\t\t\t\tkaikei.editingMasterItem[\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t'ASSY_TG'\n\t\t\t\t\t\t\t\t\t\t\t\t\t]\n\t\t\t\t\t\t\t\t\t\t\t\t"}],staticStyle:{border:"1px solid blue",width:"60px"},attrs:{type:"number"},domProps:{value:t.kaikei.editingMasterItem.ASSY_TG},on:{input:function(e){e.target.composing||t.$set(t.kaikei.editingMasterItem,"ASSY_TG",e.target.value)}}})]):t._e()])]}},{key:"item.QC_NGUOI",fn:function(e){var i=e.item;return[a("span",[i.state?t._e():a("span",[t._v(t._s(i.QC_NGUOI))]),t._v(" "),i.state?a("span",[a("input",{directives:[{name:"model",rawName:"v-model",value:t.kaikei.editingMasterItem.QC_NGUOI,expression:"\n\t\t\t\t\t\t\t\t\t\t\t\t\tkaikei.editingMasterItem[\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t'QC_NGUOI'\n\t\t\t\t\t\t\t\t\t\t\t\t\t]\n\t\t\t\t\t\t\t\t\t\t\t\t"}],staticStyle:{border:"1px solid blue",width:"60px"},attrs:{type:"number"},domProps:{value:t.kaikei.editingMasterItem.QC_NGUOI},on:{input:function(e){e.target.composing||t.$set(t.kaikei.editingMasterItem,"QC_NGUOI",e.target.value)}}})]):t._e()])]}},{key:"item.QC_TG",fn:function(e){var i=e.item;return[a("span",[i.state?t._e():a("span",[t._v(t._s(i.QC_TG))]),t._v(" "),i.state?a("span",[a("input",{directives:[{name:"model",rawName:"v-model",value:t.kaikei.editingMasterItem.QC_TG,expression:"\n\t\t\t\t\t\t\t\t\t\t\t\t\tkaikei.editingMasterItem[\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t'QC_TG'\n\t\t\t\t\t\t\t\t\t\t\t\t\t]\n\t\t\t\t\t\t\t\t\t\t\t\t"}],staticStyle:{border:"1px solid blue",width:"60px"},attrs:{type:"number"},domProps:{value:t.kaikei.editingMasterItem.QC_TG},on:{input:function(e){e.target.composing||t.$set(t.kaikei.editingMasterItem,"QC_TG",e.target.value)}}})]):t._e()])]}}]),model:{value:t.kaikei.selectedMasterItems,callback:function(e){t.$set(t.kaikei,"selectedMasterItems",e)},expression:"kaikei.selectedMasterItems"}})],1),t._v(" "),a("v-tab-item",{staticClass:"grey lighten-4",staticStyle:{height:"85vh"}},[a("v-toolbar",{attrs:{dark:"",color:"brown accent-4"}},[a("v-menu",{attrs:{"close-on-content-click":!1,"nudge-right":40,disabled:t.loading,transition:"scale-transition","offset-y":""},scopedSlots:t._u([{key:"activator",fn:function(e){var i=e.on,n=e.attrs;return[a("v-text-field",t._g(t._b({staticClass:"shrink mr-2",attrs:{label:"ASSY日",readonly:"",disabled:t.loading,"hide-details":!0,clearable:!0,outlined:"",dense:""},on:{"click:clear":function(e){t.kaikei.d_assy=null}},model:{value:t.kaikei.d_assy,callback:function(e){t.$set(t.kaikei,"d_assy",e)},expression:"kaikei.d_assy"}},"v-text-field",n,!1),i))]}}]),model:{value:t.mSelecKaikeiExpDate,callback:function(e){t.mSelecKaikeiExpDate=e},expression:"mSelecKaikeiExpDate"}},[t._v(" "),a("v-date-picker",{attrs:{"allowed-dates":t.allowedDatePicker,"show-week":!0,"show-adjacent-months":!1,locale:"jp-jp","day-format":t.dayFormat,"no-title":""},on:{input:function(e){t.mSelecKaikeiExpDate=!1}},model:{value:t.kaikei.d_assy,callback:function(e){t.$set(t.kaikei,"d_assy",e)},expression:"kaikei.d_assy"}})],1),t._v(" "),a("v-select",{staticClass:"shrink mr-2 search-field",attrs:{items:t.lineList,label:"chọn LINE",color:"pink",outlined:"",dense:"",clearable:"","hide-details":"auto"},model:{value:t.kaikei.line,callback:function(e){t.$set(t.kaikei,"line",e)},expression:"kaikei.line"}}),t._v(" "),a("v-select",{staticClass:"shrink mr-2 search-field",attrs:{items:["CA3","CA4"],label:"chọn CA",color:"pink",outlined:"",dense:"",clearable:"","hide-details":"auto"},model:{value:t.kaikei.ca,callback:function(e){t.$set(t.kaikei,"ca",e)},expression:"kaikei.ca"}}),t._v(" "),a("v-divider",{staticClass:"mx-2",attrs:{vertical:""}}),t._v(" "),a("v-btn",{staticClass:"mr-2",attrs:{color:"primary"},on:{click:function(e){return t.searchKaikei()}}},[t._v("\n\t\t\t\t\t\t\t\t\tSEARCH\n\t\t\t\t\t\t\t\t")]),t._v(" "),a("v-spacer"),t._v(" "),a("v-divider",{staticClass:"mx-2",attrs:{vertical:""}}),t._v(" "),a("v-btn",{staticClass:"ml-2",attrs:{color:"green",disabled:t.kaikeiExp.kaikeiRes.length<1},on:{click:t.exportKaikeiData}},[t._v("\n\t\t\t\t\t\t\t\t\tEXPORT\n\t\t\t\t\t\t\t\t")])],1),t._v(" "),a("v-data-table",{staticClass:"elevation-1",attrs:{items:t.kaikeiView,"fixed-header":!0,"disable-sort":"",height:"75vh",dense:"","item-key":"id","item-class":function(t){var e=[];return t.C_START||t.C_HIN?(t.C_HIN||e.push("row-kaikei-jikan"),e.push("row-kaikei-normal")):e.push("row-kaikei-all"),t.L_SAN_LUONG_IRCS>=0||e.push("row-note"),e},headers:t.kaikeiExp.kaikeiHeader,"items-per-page":-1,"hide-default-footer":""},scopedSlots:t._u([{key:"item.C_START",fn:function(e){var i=e.item;return[a("span",[i.C_START||i.C_HIN?a("span",[t._v("\n\t\t\t\t\t\t\t\t\t\t\t"+t._s(i.C_START)+"\n\t\t\t\t\t\t\t\t\t\t")]):a("span",[a("v-chip",{attrs:{color:"green"}},[a("b",[t._v(t._s(i.C_LINE))])])],1)])]}},{key:"item.C_END",fn:function(e){var i=e.item;return[a("span",[i.C_END||i.C_HIN?a("span",[t._v("\n\t\t\t\t\t\t\t\t\t\t\t"+t._s(i.C_END)+"\n\t\t\t\t\t\t\t\t\t\t")]):a("span",[a("v-chip",{attrs:{color:"CA4"==i.C_CA?"blue":"red"}},[a("b",[t._v(t._s(i.C_CA))])])],1)])]}},{key:"item.SUB_NGUOI",fn:function(e){var i=e.item;return[a("span",{},[i.C_HIN&&i.C_START?t._e():a("span",[t._v("\n\t\t\t\t\t\t\t\t\t\t\t"+t._s(i.SUB_NGUOI)+"\n\t\t\t\t\t\t\t\t\t\t")])])]}},{key:"item.SUB_TG",fn:function(e){var i=e.item;return[a("span",{},[i.C_HIN&&i.C_START?t._e():a("span",[t._v("\n\t\t\t\t\t\t\t\t\t\t\t"+t._s(i.SUB_TG)+"\n\t\t\t\t\t\t\t\t\t\t")])])]}},{key:"item.ASSY_NGUOI",fn:function(e){var i=e.item;return[a("span",{},[i.C_HIN&&i.C_START?t._e():a("span",[t._v("\n\t\t\t\t\t\t\t\t\t\t\t"+t._s(i.ASSY_NGUOI)+"\n\t\t\t\t\t\t\t\t\t\t")])])]}},{key:"item.ASSY_TG",fn:function(e){var i=e.item;return[a("span",{},[i.C_HIN&&i.C_START?t._e():a("span",[t._v("\n\t\t\t\t\t\t\t\t\t\t\t"+t._s(i.ASSY_TG)+"\n\t\t\t\t\t\t\t\t\t\t")])])]}},{key:"item.QC_NGUOI",fn:function(e){var i=e.item;return[a("span",{},[i.C_HIN&&i.C_START?t._e():a("span",[t._v("\n\t\t\t\t\t\t\t\t\t\t\t"+t._s(i.QC_NGUOI)+"\n\t\t\t\t\t\t\t\t\t\t")])])]}},{key:"item.QC_TG",fn:function(e){var i=e.item;return[a("span",{},[i.C_HIN&&i.C_START?t._e():a("span",[t._v("\n\t\t\t\t\t\t\t\t\t\t\t"+t._s(i.QC_TG)+"\n\t\t\t\t\t\t\t\t\t\t")])])]}},{key:"item.L_NHAN_CONG_ALL",fn:function(e){var i=e.item;return[a("span",{staticClass:"cell-kaikei-percent-all"},[t._v("\n\t\t\t\t\t\t\t\t\t\t"+t._s(i.L_NHAN_CONG_ALL)+"\n\t\t\t\t\t\t\t\t\t")])]}},{key:"item.ST_ALL",fn:function(e){var i=e.item;return[a("span",{class:i.C_HIN&&i.L_SAN_LUONG_IRCS>0?"":"cell-kaikei-percent-all"},[t._v("\n\t\t\t\t\t\t\t\t\t\t"+t._s(i.ST_ALL)+"\n\t\t\t\t\t\t\t\t\t")])]}},{key:"item.SUB_PERCENT",fn:function(e){var i=e.item;return[a("span",{staticClass:"cell-kaikei-percent"},[i.SUB_PERCENT>0?a("span",[t._v("\n\t\t\t\t\t\t\t\t\t\t\t"+t._s(i.SUB_PERCENT.toLocaleString(void 0,{style:"percent",minimumFractionDigits:2}))+"\n\t\t\t\t\t\t\t\t\t\t")]):t._e()])]}},{key:"item.ASSY_PERCENT",fn:function(e){var i=e.item;return[a("span",{staticClass:"cell-kaikei-percent"},[i.ASSY_PERCENT>0?a("span",[t._v("\n\t\t\t\t\t\t\t\t\t\t\t"+t._s(i.ASSY_PERCENT.toLocaleString(void 0,{style:"percent",minimumFractionDigits:2}))+"\n\t\t\t\t\t\t\t\t\t\t")]):t._e()])]}},{key:"item.QC_PERCENT",fn:function(e){var i=e.item;return[a("span",{staticClass:"cell-kaikei-percent"},[i.QC_PERCENT>0?a("span",[t._v("\n\t\t\t\t\t\t\t\t\t\t\t"+t._s(i.QC_PERCENT.toLocaleString(void 0,{style:"percent",minimumFractionDigits:2}))+"\n\t\t\t\t\t\t\t\t\t\t")]):t._e()])]}},{key:"item.ALL_PERCENT",fn:function(e){var i=e.item;return[a("span",{staticClass:"cell-kaikei-percent-all"},[i.ALL_PERCENT>0?a("span",[t._v("\n\t\t\t\t\t\t\t\t\t\t\t"+t._s(i.ALL_PERCENT.toLocaleString(void 0,{style:"percent",minimumFractionDigits:2}))+"\n\t\t\t\t\t\t\t\t\t\t")]):a("span",[t._v("\n\t\t\t\t\t\t\t\t\t\t\t"+t._s(i.ALL_PERCENT)+"\n\t\t\t\t\t\t\t\t\t\t")])])]}}])})],1)],1)],1)],1)],1)],1)}),[],!1,null,null,null);e.default=P.exports;h()(P,{VAlert:v.a,VBadge:g.a,VBanner:p.a,VBtn:k.a,VBtnToggle:f.a,VCard:x.a,VChip:b.a,VCol:T.a,VContainer:N.a,VDataTable:D.a,VDatePicker:E.a,VDialog:L.a,VDivider:w.a,VIcon:G.a,VMenu:O.a,VRow:I.a,VSelect:U.a,VSpacer:y.a,VTab:R.a,VTabItem:$.a,VTabs:M.a,VTextField:F.a,VToolbar:H.a,VToolbarTitle:Y.c,VTooltip:B.a})},970:function(t,e,a){var i=a(972),n=a(973),l=a(971);function r(t,e){var a=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),a.push.apply(a,i)}return a}function s(t){for(var e=1;e<arguments.length;e++){var a=null!=arguments[e]?arguments[e]:{};e%2?r(Object(a),!0).forEach((function(e){i(t,e,a[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(a)):r(Object(a)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(a,e))}))}return t}a(130),a(6),a(4),a(5),a(259),a(25),a(68),a(57),a(7),a(8),a(9),a(10);var o=a(968),c=a(237),_=function(){var t=l(regeneratorRuntime.mark((function t(e){var a,i,l,r,_,u,d,C,S,m,A=arguments;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return a=A.length>1&&void 0!==A[1]?A[1]:{sheetName:"sheet1",opts:{}},i=A.length>2&&void 0!==A[2]?A[2]:"Export",l=A.length>3&&void 0!==A[3]?A[3]:{expRaw:!1},r=new o.Workbook,_=r.addWorksheet(a.sheetName,a.opts),u={style:"thin",color:{argb:"974706"}},d={type:"pattern",pattern:"solid",fgColor:{argb:"FFFFFF00"}},Array.isArray(e)?e.length>0&&((C=Object.keys(e[0])).forEach((function(t,e){var a=_.getRow(1);a.getCell(e+1).font={bold:!0},a.getCell(e+1).value=t,a.getCell(e+1).border={top:u,left:u,bottom:u,right:u},a.getCell(e+1).fill=d,a.commit()})),_.views=[{state:"frozen",ySplit:1}],l.expRaw?e.forEach((function(t,e){var a=_.getRow(2+e);C.forEach((function(e,i){a.getCell(i+1).value=t[e]})),a.commit()})):(e.forEach((function(t,e){var a=_.getRow(2+e);C.forEach((function(e,i){a.getCell(i+1).value=t[e],a.getCell(i+1).border={top:u,left:u,bottom:u,right:u}})),a.commit()})),C.forEach((function(t,e){var a=_.getColumn(e+1),i=a.values.map((function(t){return t.toString().length})),l=Math.max.apply(Math,n(i.filter((function(t){return"number"==typeof t}))));l=l>t.length?l+5:t.length+5,a.width=l})))):e(_),t.next=10,r.xlsx.writeBuffer();case 10:if(S=t.sent,"string"!=typeof i){t.next=15;break}saveAs(new Blob([S]),i+".xlsx"),t.next=19;break;case 15:return t.next=17,c.post("http://172.25.216.213:3368/api/sendmail",{mailOpts:s({},i)});case 17:m=t.sent,console.log(m);case 19:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),u=function(){var t=l(regeneratorRuntime.mark((function t(e){var a,i,l,r,_,u,d,C,S,m=arguments;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(a=m.length>1&&void 0!==m[1]?m[1]:"Export",i=m.length>2&&void 0!==m[2]?m[2]:{sheetName:"sheet1",opts:{}},l=new o.Workbook,!Array.isArray(e)){t.next=10;break}r=l.addWorksheet(i.sheetName,i.opts),_={style:"thin",color:{argb:"974706"}},u={type:"pattern",pattern:"solid",fgColor:{argb:"FFFFFF00"}},e.length>0&&((d=Object.keys(e[0])).forEach((function(t,e){var a=r.getRow(1);a.getCell(e+1).font={bold:!0},a.getCell(e+1).value=t,a.getCell(e+1).border={top:_,left:_,bottom:_,right:_},a.getCell(e+1).fill=u,a.commit()})),r.views=[{state:"frozen",ySplit:1}],e.forEach((function(t,e){var a=r.getRow(2+e);d.forEach((function(e,i){a.getCell(i+1).value=t[e],a.getCell(i+1).border={top:_,left:_,bottom:_,right:_}})),a.commit()})),d.forEach((function(t,e){var a=r.getColumn(e+1),i=a.values.map((function(t){return t.toString().length})),l=Math.max.apply(Math,n(i.filter((function(t){return"number"==typeof t}))));l=l>t.length?l+5:t.length+5,a.width=l}))),t.next=12;break;case 10:return t.next=12,e(l);case 12:return t.next=14,l.xlsx.writeBuffer();case 14:if(C=t.sent,"string"!=typeof a){t.next=19;break}saveAs(new Blob([C]),a+".xlsx"),t.next=23;break;case 19:return t.next=21,c.post("http://172.25.216.213:3368/api/sendmail",{mailOpts:s({},a)});case 21:S=t.sent,console.log(S);case 23:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),d=function(){var t=l(regeneratorRuntime.mark((function t(e,a){var i,n;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:i=new FileReader,n=new o.Workbook,i.readAsArrayBuffer(e),i.onload=l(regeneratorRuntime.mark((function t(){var e;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e=i.result,t.next=3,n.xlsx.load(e);case 3:"function"==typeof a&&a(n);case 4:case"end":return t.stop()}}),t)})));case 4:case"end":return t.stop()}}),t)})));return function(e,a){return t.apply(this,arguments)}}();t.exports={excelJSExport:_,excelJSReadFile:d,excelJSExportWB:u}},982:function(t,e,a){var i=a(1031);i.__esModule&&(i=i.default),"string"==typeof i&&(i=[[t.i,i,""]]),i.locals&&(t.exports=i.locals);(0,a(13).default)("03d702f7",i,!0,{sourceMap:!1})}}]);
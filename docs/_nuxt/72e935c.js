(window.webpackJsonp=window.webpackJsonp||[]).push([[13],{1008:function(t,e,a){var n=a(971);a(130),a(4),a(558),a(559),a(560),a(561),a(562),a(563),a(564),a(565),a(566),a(567),a(568),a(569),a(570),a(571),a(572),a(573),a(574),a(575),a(576),a(577),a(578),a(579),a(580),a(581),a(582),a(583);var r=a(1009),l=function(){var t=n(regeneratorRuntime.mark((function t(e){var a,n,l,s,i,o,c=arguments;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return a=c.length>1&&void 0!==c[1]?c[1]:"Export",c.length>2&&void 0!==c[2]?c[2]:{sheetName:"sheet1",opts:{}},Array.isArray(e)&&e.length,n={name:"World",items:[]},t.next=6,fetch("/thuc-tich-ircs/f_set_h.xlsx");case 6:return l=t.sent,t.next=9,l.arrayBuffer();case 9:return s=t.sent,t.next=12,(new r.Renderer).renderFromArrayBuffer(s,n);case 12:return i=t.sent,t.next=15,i.xlsx.writeBuffer();case 15:o=t.sent,saveAs(new Blob([o]),a+".xlsx");case 17:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),s=function(){var t=n(regeneratorRuntime.mark((function t(e,a){var n,r,l,s,i,o=arguments;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=o.length>2&&void 0!==o[2]?o[2]:"Exported",o.length>3&&void 0!==o[3]?o[3]:"Export",o.length>4&&void 0!==o[4]?o[4]:null,{bookType:"xlsx",bookSST:!1,type:"binary"},t.next=6,fetch("/thuc-tich-ircs/f_set_h.xlsx");case 6:return r=t.sent,t.next=9,r.arrayBuffer();case 9:return l=t.sent,t.next=12,e.$XLSX.read(l,{type:"buffer"});case 12:return s=t.sent,console.log(s),t.next=16,e.$XLSX.write(s,{type:"buffer",bookType:"xlsx"});case 16:i=t.sent,saveAs(new Blob([i],{type:"application/octet-stream"}),n+".xlsx");case 18:case"end":return t.stop()}}),t)})));return function(e,a){return t.apply(this,arguments)}}();t.exports={xlsxRender:l,exportXLSX:s}},1028:function(t,e,a){"use strict";a(981)},1029:function(t,e,a){var n=a(12)(!1);n.push([t.i,'.select-sum{font-size:3.5rem;color:gold;background-color:#dc143c;padding:1rem;border-radius:2.5rem;font-family:tahoma;opacity:.8}#page-thuc-tich-ircs{font-family:ＭＳ Ｐゴシック}#page-thuc-tich-ircs .tbl-header{background-color:#deb887!important;font-size:medium!important;padding:0 8px!important;border:1px solid #000}#page-thuc-tich-ircs .cell-congdoan{text-align:left;font-weight:bolder}#page-thuc-tich-ircs .cell-normal{padding:0!important;border:1px solid #000!important}#page-thuc-tich-ircs .row-muc-tieu td{background-color:khaki;font-size:2.5rem!important}#page-thuc-tich-ircs .row-muc-tieu .khong-dat-muc-tieu{background-color:#ff69b4!important;display:block}#page-thuc-tich-ircs .row-muc-tieu .muc-tieu-incompleted{background-color:#90ee90!important;display:block}#page-thuc-tich-ircs .row-normal td{font-size:2.5rem!important}#page-thuc-tich-ircs .row-normal:contains("0"){color:#00f}#page-thuc-tich-ircs .cell-sum{color:#ff1493}#page-thuc-tich-ircs .cell-muc-tieu{color:red!important}#page-thuc-tich-ircs .blue--text{color:#00f!important}#page-thuc-tich-ircs table{border-collapse:collapse}#page-thuc-tich-ircs.mobile .tbl-header{font-size:.75rem!important}#page-thuc-tich-ircs.mobile .row-muc-tieu td{font-size:1.5rem!important}#page-thuc-tich-ircs.mobile .row-muc-tieu .khong-dat-muc-tieu{background-color:#ff69b4!important;display:block}#page-thuc-tich-ircs.mobile .row-muc-tieu .muc-tieu-incompleted{background-color:#90ee90!important;display:block}#page-thuc-tich-ircs.mobile .row-normal td{font-size:1.5rem!important}',""]),t.exports=n},1050:function(t,e,a){"use strict";a.r(e);a(8),a(9),a(10);var n=a(1),r=a(20),l=a(43);a(130),a(28),a(25),a(26),a(4),a(5),a(81),a(44),a(77),a(57),a(54),a(7),a(52),a(68),a(601),a(336),a(6),a(36),a(558),a(559),a(560),a(561),a(562),a(563),a(564),a(565),a(566),a(567),a(568),a(569),a(570),a(571),a(572),a(573),a(574),a(575),a(576),a(577),a(578),a(579),a(580),a(581),a(582),a(583);function s(t,e){var a=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),a.push.apply(a,n)}return a}function i(t){for(var e=1;e<arguments.length;e++){var a=null!=arguments[e]?arguments[e]:{};e%2?s(Object(a),!0).forEach((function(e){Object(n.a)(t,e,a[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(a)):s(Object(a)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(a,e))}))}return t}var o,c=a(970),u=(a(1008),{head:{title:"IRCS 実績"},data:function(){return{timer:null,timerTime:12e4,liveInterval:null,ttIrcsDataTbl:[],setHDialog:!1,initData:null,setTargetDialog:!1,selectedSumElement:null,ca4Hours:[{h:"0630",h1:"0730",val:"06",text:"06:30~07:30"},{h:"0730",h1:"0830",val:"07",text:"07:30~08:30"},{h:"0830",h1:"0930",val:"08",text:"08:30~09:30"},{h:"0930",h1:"1030",val:"09",text:"09:30~10:30"},{h:"1030",h1:"1130",val:"10",text:"10:30~11:30"},{h:"1130",h1:"1230",val:"11",text:"11:30~12:30"},{h:"1230",h1:"1330",val:"12",text:"12:30~13:30"},{h:"1330",h1:"1430",val:"13",text:"13:30~14:30"},{h:"1430",h1:"1530",val:"14",text:"14:30~15:30"},{h:"1530",h1:"1630",val:"15",text:"15:30~16:30"},{h:"1630",h1:"1730",val:"16",text:"16:30~17:30"},{h:"1730",h1:"1830",val:"17",text:"17:30~18:30"},{h:"1830",h1:"2000",val:"18+19",text:"18:30~19:30"}],ca3Hours:[{h:"2000",h1:"2100",val:"20",text:"20:00~21:00"},{h:"2100",h1:"2200",val:"21",text:"21:00~22:00"},{h:"2200",h1:"2300",val:"22",text:"22:00~23:00"},{h:"2300",h1:"2400",val:"23",text:"23:00~00:00"},{h:"0000",h1:"0100",val:"00",text:"00:00~01:00"},{h:"0100",h1:"0200",val:"01",text:"01:00~02:00"},{h:"0200",h1:"0300",val:"02",text:"02:00~03:00"},{h:"0300",h1:"0400",val:"03",text:"03:00~04:00"},{h:"0400",h1:"0500",val:"04",text:"04:00~05:00"},{h:"0500",h1:"0630",val:"05",text:"05:00~06:00"}],targetData:{d_assy:null,ca:null,line:null,t_gia_dong:null,l_ke_hoach:null,l_so_nguoi:null,rest_hour:"11",user:"SYS"},target_rules:{d_assy:[function(t){return(t||"").length>0||"Không được để trống!"}],ca:[function(t){return(t||"").length>0||"Không được để trống!"}],line:[function(t){return(t||"").length>0||"Không được để trống!"}],tgiadong:[function(t){return/^\d+(\.\d+)?$/.test(t||"")||"chỉ nhập số!"}],lkehoach:[],rest_hour:[]},selectedDateSH:null,isLive:!0,lastTime:"--:--:--",selectedCA:"",caOptionsItems:[{text:"一日中",value:"ALL"},{text:"CA4",value:"CA4"},{text:"CA3",value:"CA3"}],selectedDate:h(),mSelectDate:!1,title:"IRCS 実績 - Thực tích IRCS",loading:!1,pickerOptions:{disabledDate:function(t){var e=new Date,a=new Date;return e.setDate(e.getDate()-150),a.setDate(a.getDate()),t.getTime()<e.getTime()||t.getTime()>a.getTime()}},listSeisan:[]}},mounted:(o=Object(l.a)(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return this.$nuxt.$emit("page-info",{title:this.title,version:"1.0.0",options:{replace:!0}}),this.selectedCA="CA4",t.next=4,this.getInit();case 4:return this.selectedDateSH=this.$moment().format("YYYY-MM-DD"),t.next=7,this.getData((new Date).toISOString().substring(0,10));case 7:this.timer=this.$timerPoller(this.timerWork,this.timerTime),this.timer.start();case 9:case"end":return t.stop()}}),t,this)}))),function(){return o.apply(this,arguments)}),computed:{searchKey:function(){return this.keyWorld.toUpperCase()},today:function(){var t=this.now;return t.getHours()>6?t.toISOString().substring(0,10):t.setDate(t.getDate()+1).toISOString().substring(0,10)},selectedDateNext:function(){return this.selectedDate?this.$moment(this.selectedDate).add(1,"days").format("YYYY-MM-DD"):null},lineList:function(){var t=[];return this.initData&&this.initData.LIST_LINE&&(t=this.initData.LIST_LINE.map((function(t){return t.C_LINE}))),t},fullDayHours:function(){return"CA4"==this.targetData.ca?this.ca4Hours:"CA3"==this.targetData.ca?this.ca3Hours:[].concat(Object(r.a)(this.ca4Hours),Object(r.a)(this.ca3Hours))},headers:function(){var t=[{text:"LINE名",value:"REGISTLINENAME",width:100,class:["tbl-header"],cellClass:["cell-normal"],fixed:!0},{text:"工程",value:"C_CONG_DOAN_JP",width:85,class:["tbl-header"],cellClass:["cell-normal","cell-congdoan"],fixed:!0}],e=[{text:"06:30~\r\n07:30",value:"06",width:50,class:["tbl-header"],cellClass:["cell-normal"]},{text:"07:30~\r\n08:30",value:"07",width:50,class:["tbl-header"],cellClass:["cell-normal"]},{text:"08:30~\r\n09:30",value:"08",width:50,class:["tbl-header"],cellClass:["cell-normal"]},{text:"09:40~\r\n10:30",value:"09",width:50,class:["tbl-header"],cellClass:["cell-normal"]},{text:"10:30~\r\n11:30",value:"10",width:50,class:["tbl-header"],cellClass:["cell-normal"]},{text:"11:30~\r\n12:30",value:"11",width:50,class:["tbl-header"],cellClass:["cell-normal"]},{text:"12:30~\r\n13:30",value:"12",width:50,class:["tbl-header"],cellClass:["cell-normal"]},{text:"13:30~\r\n14:30",value:"13",width:50,class:["tbl-header"],cellClass:["cell-normal"]},{text:"14:40~\r\n15:30",value:"14",width:50,class:["tbl-header"],cellClass:["cell-normal"]},{text:"15:30~\r\n16:30",value:"15",width:50,class:["tbl-header"],cellClass:["cell-normal"]},{text:"16:30~\r\n17:30",value:"16",width:50,class:["tbl-header"],cellClass:["cell-normal"]},{text:"17:30~\r\n18:30",value:"17",width:50,class:["tbl-header"],cellClass:["cell-normal"]},{text:"18:30~\r\n19:30",value:"18+19",width:50,class:["tbl-header"],cellClass:["cell-normal"]}],a=[{text:"20:00~\r\n21:00",value:"20",width:50,class:["tbl-header"],cellClass:["cell-normal"]},{text:"21:00~\r\n21:50",value:"21",width:50,class:["tbl-header"],cellClass:["cell-normal"]},{text:"22:00~\r\n23:00",value:"22",width:50,class:["tbl-header"],cellClass:["cell-normal"]},{text:"23:00~\r\n00:00",value:"23",width:50,class:["tbl-header"],cellClass:["cell-normal"]},{text:"00:00~\r\n01:00",value:"00",width:50,class:["tbl-header"],cellClass:["cell-normal"]},{text:"01:00~\r\n01:50",value:"01",width:50,class:["tbl-header"],cellClass:["cell-normal"]},{text:"02:00~\r\n03:00",value:"02",width:50,class:["tbl-header"],cellClass:["cell-normal"]},{text:"03:00~\r\n04:00",value:"03",width:50,class:["tbl-header"],cellClass:["cell-normal"]},{text:"04:00~\r\n05:00",value:"04",width:50,class:["tbl-header"],cellClass:["cell-normal"]},{text:"05:00~\r\n06:00",value:"05",width:50,class:["tbl-header"],cellClass:["cell-normal"]}];return"CA4"==this.selectedCA?t.push.apply(t,e):("CA3"==this.selectedCA||t.push.apply(t,e),t.push.apply(t,a)),t.push({text:"総計",value:"l_sum",width:50,class:["tbl-header"],cellClass:["cell-normal","cell-sum"]}),t},ttIrcsData:function(){var t=this;return this.ttIrcsDataTbl.map((function(e){var a=0;if(e["18+19"]=(e[18]||0)+(e[19]||0),e.L_ORDER>=100);else if(0==e.L_ORDER){var n=0,r=0,l=t.ttCongDoanCuoi(e.REGISTLINENAME);e.L_KE_HOACH_CA4>0&&t.ca4Hours.forEach((function(a,r){t.selectedDate+" "+a.h1<t.$nuxt.context.current_hour_minute&&(0==l[a.val]&&(t.isLive||a.val<"07")||n>=e.L_KE_HOACH_CA4)&&(e[a.val]=0),a.val==e.C_REST_HOUR_CA4&&(e[a.val]=0);var s=e[a.val]+n-e.L_KE_HOACH_CA4;(s>0||r+1==t.ca4Hours.length)&&(e[a.val]=e[a.val]-s),n+=e[a.val],t.selectedDate+" "+a.h1<t.$nuxt.context.current_hour_minute?e[a.val+"_sai"]=l[a.val]-e[a.val]:e[a.val+"_incompleted"]=!0})),e.L_KE_HOACH_CA3>0&&t.ca3Hours.forEach((function(a,n){(a.val>"05"&&t.selectedDate+" "+a.h1<t.$nuxt.context.current_hour_minute||a.val<="05"&&t.selectedDateNext+" "+a.h1<t.$nuxt.context.current_hour_minute)&&(0==l[a.val]&&(t.isLive||a.val<"21"&&a.val>"05")||r>=e.L_KE_HOACH_CA3)&&(e[a.val]=0),a.val==e.C_REST_HOUR_CA3&&(e[a.val]=0);var s=e[a.val]+r-e.L_KE_HOACH_CA3;(s>0||n+1==t.ca3Hours.length)&&(e[a.val]=e[a.val]-s),r+=e[a.val],a.val>"05"&&t.selectedDate+" "+a.h1<t.$nuxt.context.current_hour_minute||a.val<="05"&&t.selectedDateNext+" "+a.h1<t.$nuxt.context.current_hour_minute?e[a.val+"_sai"]=l[a.val]-e[a.val]:e[a.val+"_incompleted"]=!0})),a="CA4"==t.selectedCA?n||0:"CA3"==t.selectedCA?r||0:t.$nuxt.context.current_hour>t.selectedDateNext+" 05"?n+r:(e.L_KE_HOACH_CA4||0)+(e.L_KE_HOACH_CA3||0),e.REGISTLINENAME_tooltip="<b>"+e.REGISTLINENAME+"</b>"+(e.T_GIA_DONG_CA4?"<br>稼働_CA4: <b>"+e.T_GIA_DONG_CA4+"</b>(分)":"")+(e.L_KE_HOACH_CA4?"<br>計画数_CA4: <b>"+e.L_KE_HOACH_CA4+"</b>(SET)":"")+(e.C_REST_HOUR_CA4?"<br>食事時間_CA4: <b>"+(t.ca4Hours.find((function(t){return t.val==e.C_REST_HOUR_CA4}))||{}).text+"</b>":"")+(e.T_GIA_DONG_CA3?"<hr/><br/>稼働_CA3: <b>"+e.T_GIA_DONG_CA3+"</b>(分)":"")+(e.L_KE_HOACH_CA3?"<br>計画数_CA3: <b>"+e.L_KE_HOACH_CA3+"</b>(SET)":"")+(e.C_REST_HOUR_CA3?"<br>食事時間_CA3: <b>"+(t.ca3Hours.find((function(t){return t.val==e.C_REST_HOUR_CA3}))||{}).text+"</b>":"")}else a=0,a="CA4"==t.selectedCA?a+(e["06"]||0)+(e["07"]||0)+(e["08"]||0)+(e["09"]||0)+(e[10]||0)+(e[11]||0)+(e[12]||0)+(e[13]||0)+(e[14]||0)+(e[15]||0)+(e[16]||0)+(e[17]||0)+(e[18]||0)+(e[19]||0):"CA3"==t.selectedCA?a+(e[20]||0)+(e[21]||0)+(e[22]||0)+(e[23]||0)+(e["00"]||0)+(e["01"]||0)+(e["02"]||0)+(e["03"]||0)+(e["04"]||0)+(e["05"]||0):a+(e["06"]||0)+(e["07"]||0)+(e["08"]||0)+(e["09"]||0)+(e[10]||0)+(e[11]||0)+(e[12]||0)+(e[13]||0)+(e[14]||0)+(e[15]||0)+(e[16]||0)+(e[17]||0)+(e[18]||0)+(e[19]||0)+(e[20]||0)+(e[21]||0)+(e[22]||0)+(e[23]||0)+(e["00"]||0)+(e["01"]||0)+(e["02"]||0)+(e["03"]||0)+(e["04"]||0)+(e["05"]||0);return i(i({},e),{},{l_sum:a})}))},setH_Data:function(){var t=this;if(0==this.listSeisan.length)return{};var e={};return this.listSeisan.forEach((function(a){a["18+19"]=(a[18]||0)+(a[19]||0),"UNKNOWN"!=a.C_LINE&&a.D_SAGYO>=t.selectedDateSH&&a.D_SAGYO<=t.selectedDateSH&&(e[a.C_LINE]?e[a.C_LINE].push(a):e[a.C_LINE]=[a])})),e}},created:function(){var t=this;setInterval((function(){t.$forceUpdate()}),1e3)},components:{},methods:{allowedDatePicker:function(t){return new Date(t)<new Date},weekdayFormat:function(t){switch(new Date(t).getDay()){case 0:return"日";case 1:return"月";case 2:return"火";case 3:return"水";case 4:return"木";case 5:return"金";case 6:return"土"}},dayFormat:function(t){return t.substring(t.length-2)},getInit:function(){var t=this;return Object(l.a)(regeneratorRuntime.mark((function e(){var a;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,t.$axios.get("/tt-ircs/init");case 3:a=e.sent,t.initData=a.data,console.log(t.initData),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(0),console.log(e.t0);case 11:return e.prev=11,e.finish(11);case 13:case"end":return e.stop()}}),e,null,[[0,8,11,13]])})))()},tableScroll:function(){this.selectedSumElement&&this.selectedSumElement.parentNode.removeChild(this.selectedSumElement)},mouseUpOnTable:function(t){var e=window.getSelection().toString().trim();if(e&&e.length>1){var a=e.split(/(\t|\n)/),n=0;a.forEach((function(t){/^\d+$/.test(t)&&(n+=parseFloat(t))}));var r=window.getSelection().getRangeAt(0).getBoundingClientRect();r.width>0&&(this.selectedSumElement&&this.selectedSumElement.parentNode.removeChild(this.selectedSumElement),this.selectedSumElement=document.createElement("div"),this.selectedSumElement.innerHTML='<span class="select-sum">'+n+"</span>",this.selectedSumElement.class="rect",this.selectedSumElement.style.position="fixed",this.selectedSumElement.style.top=t.clientY+"px",this.selectedSumElement.style.left=t.clientX+"px",this.selectedSumElement.style.height=r.height+"px",document.body.appendChild(this.selectedSumElement))}},clearSumSelect:function(t){this.selectedSumElement&&(this.selectedSumElement.parentNode.removeChild(this.selectedSumElement),this.selectedSumElement=null)},openMokuhyo:function(){this.targetData={d_assy:this.today,ca:this.selectedDate+" 2000">this.$nuxt.context.current_hour_minute?"CA4":"CA3",line:null,t_gia_dong:null,l_ke_hoach:null,l_so_nguoi:null,rest_hour:this.selectedDate+" 2000">this.$nuxt.context.current_hour_minute?"11":"00",user:"SYS"},this.setTargetDialog=!0},ttCongDoanCuoi:function(t){return this.ttIrcsDataTbl.filter((function(e){return e.REGISTLINENAME==t&&"PACKING"==e.C_CONG_DOAN}))[0]||{}},onMucTieuCaChanged:function(){var t=this.targetData.item||{};"CA4"==this.targetData.ca&&(this.targetData.rest_hour=t.C_REST_HOUR_CA4||"11"),"CA3"==this.targetData.ca&&(this.targetData.rest_hour=t.C_REST_HOUR_CA3||"00")},getData:function(t){var e=arguments,a=this;return Object(l.a)(regeneratorRuntime.mark((function n(){var l,s;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return e.length>1&&void 0!==e[1]?e[1]:"CA4",a.loading=!0,console.log("load data @ "+a.selectedCA),n.prev=3,a.$toast.show("Loading data..."),n.next=7,a.$axios.get("/tt-ircs?1=1&date="+t);case 7:l=n.sent,s=new Date,a.ttIrcsDataTbl=Object(r.a)(l.data.data),a.loading=!1,a.lastTime=(s.getHours()<10?"0":"")+s.getHours()+":"+(s.getMinutes()<10?"0":"")+s.getMinutes()+":"+(s.getSeconds()<10?"0":"")+s.getSeconds(),a.$toast.clear(),n.next=18;break;case 15:n.prev=15,n.t0=n.catch(3),console.log(n.t0);case 18:return n.prev=18,a.loading=!1,a.now=new Date,a.nowMoment=a.$moment(),n.finish(18);case 23:case"end":return n.stop()}}),n,null,[[3,15,18,23]])})))()},dblclickRow:function(t,e){if("目標"==e.item.C_CONG_DOAN_JP){for(var a=t.target;"TD"!=a.tagName;)a=a.parentNode;for(var n=a.parentNode,l=Object(r.a)(n.childNodes),s=0;s<l.length;s++)a===l[s]&&console.log(s,l[s])}},rowClass:function(t){var e=[];return"目標"==t.C_CONG_DOAN_JP?e.push("row-muc-tieu"):e.push("row-normal"),e},onDateChanged:function(t){this.timer.stop(),t!==this.today?this.isLive=!1:(this.isLive=!0,this.timer.start()),this.getData(t)},onCAChange:function(t){},onLiveToggle:function(t){this.timer.stop(),t&&(this.selectedDate=this.today,this.getData(this.selectedDate,this.selectedCA),this.timer.start())},timerWork:function(){this.isLive?(this.selectedDate=this.$nuxt.context.current_assy_date,"ALL"!=this.selectedCA&&(this.selectedCA=this.$nuxt.context.current_assy_ca),console.log("live",this.selectedDate,this.selectedCA),this.getData(this.selectedDate,this.selectedCA)):this.timer.stop()},editMucTieu:function(t){this.isLive&&(this.targetData={d_assy:this.selectedDate,ca:this.selectedDate+" 2000">this.$nuxt.context.current_hour_minute?"CA4":"CA3",line:t.REGISTLINENAME||null,t_gia_dong:this.selectedDate+" 2000">this.$nuxt.context.current_hour_minute?t.T_GIA_DONG_CA4:t.T_GIA_DONG_CA3,l_ke_hoach:this.selectedDate+" 2000">this.$nuxt.context.current_hour_minute?t.L_KE_HOACH_CA4:t.L_KE_HOACH_CA3,l_so_nguoi:this.selectedDate+" 2000">this.$nuxt.context.current_hour_minute?t.L_SO_NGUOI_CA4:t.L_SO_NGUOI_CA3,user:"SYS",rest_hour:this.selectedDate+" 2000">this.$nuxt.context.current_hour_minute?t.C_REST_HOUR_CA4||"11":t.C_REST_HOUR_CA3||"00",item:t},this.setTargetDialog=!0)},excelDownload:function(){var t=this,e=this.ttIrcsData.filter((function(t){return t.L_ORDER<100})).map((function(e){var a={REGISTDATE:e.REGISTDATE,REGISTLINENAME:e.REGISTLINENAME,C_CONG_DOAN_JP:e.C_CONG_DOAN_JP};return"CA4"==t.selectedCA?(a["06:30~"]=e["06"],a["07:30~"]=e["07"],a["08:30~"]=e["08"],a["09:30~"]=e["09"],a["10:30~"]=e[10],a["11:30~"]=e[11],a["12:30~"]=e[12],a["13:30~"]=e[13],a["14:40~"]=e[14],a["15:30~"]=e[15],a["16:30~"]=e[16],a["17:30~"]=e[17],a["18:30~"]=e["18+19"]):"CA3"==t.selectedCA?(a["20:00~"]=e[20],a["21:00~"]=e[21],a["22:00~"]=e[22],a["23:00~"]=e[23],a["00:00~"]=e["00"],a["01:00~"]=e["01"],a["02:00~"]=e["02"],a["03:00~"]=e["03"],a["04:00~"]=e["04"],a["05:00~"]=e["05"]):(a["06:30~"]=e["06"],a["07:30~"]=e["07"],a["08:30~"]=e["08"],a["09:30~"]=e["09"],a["10:30~"]=e[10],a["11:30~"]=e[11],a["12:30~"]=e[12],a["13:30~"]=e[13],a["14:40~"]=e[14],a["15:30~"]=e[15],a["16:30~"]=e[16],a["17:30~"]=e[17],a["18:30~"]=e["18+19"],a["20:00~"]=e[20],a["21:00~"]=e[21],a["22:00~"]=e[22],a["23:00~"]=e[23],a["00:00~"]=e["00"],a["01:00~"]=e["01"],a["02:00~"]=e["02"],a["03:00~"]=e["03"],a["04:00~"]=e["04"],a["05:00~"]=e["05"]),a.L_SUM=e.l_sum,a}));this.exportXLSX(e,"IRCS実績@"+this.selectedDate+"_"+this.selectedCA)},updateTarget:function(){var t=this;return Object(l.a)(regeneratorRuntime.mark((function e(){var a;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,t.loading=!0,e.next=4,t.$axios.post("tt-ircs/update-muc-tieu-ircs",t.targetData);case 4:if(a=e.sent,t.loading=!1,"success"!=a.data.message){e.next=14;break}return e.next=9,t.getData(t.selectedDate,t.selectedCA);case 9:t.$toast.show("Đã đăng lục xong!",{duration:3e3,position:"bottom-center"}),console.log(a),t.setTargetDialog=!1,e.next=16;break;case 14:t.$toast.show("ERROR!!",{duration:5e3,position:"bottom-center"}),console.log(a.data.message);case 16:e.next=22;break;case 18:e.prev=18,e.t0=e.catch(0),console.log(e.t0),t.loading=!1;case 22:return e.prev=22,t.getInit(),e.finish(22);case 25:case"end":return e.stop()}}),e,null,[[0,18,22,25]])})))()},exportXLSX:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"Exported";c.excelJSExport(t,{sheetName:"Sheet1",opts:{}},e)},exportXLSX_old:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"Exported",a={bookType:"xlsx",bookSST:!1,type:"binary"},n=this.$XLSX.utils.json_to_sheet(t),r={SheetNames:["Export"],Sheets:{},Props:{}};r.Sheets.Export=n;var l=this.$XLSX.write(r,a);if(this.$nuxt.context.isIE){var s=new Blob([d(l)],{type:"application/octet-stream"});navigator.msSaveBlob(s,e+".xlsx")}else{var i=new Blob([d(l)],{type:"application/octet-stream"}),o=document.createElement("a");document.body.appendChild(o),o.style="display: none";var c=window.URL.createObjectURL(i);o.href=c,o.download=e+".xlsx",o.click(),document.body.removeChild(o)}},downloadSetH_Data:function(){var t=this;return Object(l.a)(regeneratorRuntime.mark((function e(){var a;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,t.$axios.get("/tt-ircs/set-h-data?fDate=".concat(t.selectedDateSH,"&tDate=").concat(t.selectedDateSH));case 3:if(a=e.sent,t.listSeisan=a.data||[],console.log(a.data),!(Object.keys(t.setH_Data).length>0)){e.next=12;break}return e.next=9,c.excelJSExportWB(function(){var e=Object(l.a)(regeneratorRuntime.mark((function e(a){var n,r,l,s;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch(t.$nuxt.context.base+"thuc-tich-ircs/f_set_h.xlsx");case 2:return n=e.sent,e.next=5,n.blob();case 5:return r=e.sent,e.next=8,a.xlsx.load(r);case 8:(l=a.getWorksheet("F_MAU"))&&Object.keys(t.setH_Data).forEach((function(e){var n=a.addWorksheet("Sheet");n.model=l.model,n.name=e,t.setH_Data[e].forEach((function(t,a){0==a&&(n.getCell("C1").value=e,n.getCell("B3").value=t.D_SAGYO,n.getCell("B5").value=t.HIN_CA4||"",n.getCell("E5").value={formula:"".concat(t.T_GIA_DONG_CA4||0,"/60\n\t\t\t\t\t\t\t\t\t\t"),result:0},n.mergeCells("B4:D4"),n.mergeCells("B5:D5"),n.mergeCells("B7:D7"),n.getCell("G5").value=t.L_KE_HOACH_CA4||0,t["06"]&&(n.getCell("G8").value=t["06"]),t["07"]&&(n.getCell("G9").value=t["07"]),t["08"]&&(n.getCell("G10").value=t["08"]),t["09"]&&(n.getCell("G11").value=t["09"]),t[10]&&(n.getCell("G12").value=t[10]),t[11]&&(n.getCell("G13").value=t[11]),t[12]&&(n.getCell("G14").value=t[12]),t[13]&&(n.getCell("G15").value=t[13]),t[14]&&(n.getCell("G16").value=t[14]),t[15]&&(n.getCell("G17").value=t[15]),t[16]&&(n.getCell("G18").value=t[16]),t[17]&&(n.getCell("G19").value=t[17]),t["18+19"]&&(n.getCell("G20").value=t["18+19"]),n.getCell("N1").value=e,n.getCell("M3").value=t.D_SAGYO,n.getCell("M5").value=t.HIN_CA3||"",n.getCell("P5").value={formula:"".concat(t.T_GIA_DONG_CA3||0,"/60\n\t\t\t\t\t\t\t\t\t\t"),result:0},n.mergeCells("M4:O4"),n.mergeCells("M5:O5"),n.mergeCells("M7:O7"),n.getCell("R5").value=t.L_KE_HOACH_CA3||0,t[20]&&(n.getCell("R8").value=t[20]),t[21]&&(n.getCell("R9").value=t[21]),t[22]&&(n.getCell("R10").value=t[22]),t[23]&&(n.getCell("R11").value=t[23]),t["00"]&&(n.getCell("R12").value=t["00"]),t["01"]&&(n.getCell("R13").value=t["01"]),t["02"]&&(n.getCell("R14").value=t["02"]),t["03"]&&(n.getCell("R15").value=t["03"]),t["04"]&&(n.getCell("R16").value=t["04"]),t["05"]&&(n.getCell("R17").value=t["05"]))}))})),s=a.getWorksheet("Sheet1"),a.removeWorksheet(s.id);case 12:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),"Set-H_Data_"+t.selectedDateSH);case 9:t.setHDialog=!1,e.next=13;break;case 12:t.$toast.show("No Data!",{duration:4e3,position:"bottom-center"});case 13:e.next=18;break;case 15:e.prev=15,e.t0=e.catch(0),console.log(e.t0);case 18:case"end":return e.stop()}}),e,null,[[0,15]])})))()}},beforeDestroy:function(){this.timer.stop()}});function d(t){for(var e=new ArrayBuffer(t.length),a=new Uint8Array(e),n=0;n!=t.length;++n)a[n]=255&t.charCodeAt(n);return e}function h(){var t=new Date;return t.getHours()>6?t.toISOString().substring(0,10):t.setDate(t.getDate()+1).toISOString().substring(0,10)}var m=u,v=(a(1028),a(82)),_=a(111),p=a.n(_),g=a(409),f=a(239),x=a(410),b=a(393),C=a(98),D=a(330),k=a(396),y=a(392),w=a(422),A=a(412),S=a(200),E=a(404),O=a(202),R=a(407),H=a(398),N=a(41),T=a(395),I=a(419),L=a(62),G=a(103),$=a(421),M=Object(v.a)(m,(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{class:t.$nuxt.context.isMobile?"mobile":"",attrs:{id:"page-thuc-tich-ircs"},on:{mousedown:t.clearSumSelect}},[a("div",{staticStyle:{"text-align":"center"}},[a("v-toolbar",{attrs:{dark:"",height:"60px",color:"black",dense:"",bottom:""}},[t.$nuxt.context.isMobile?t._e():a("span",{staticStyle:{color:"yellow"}},[t._v("\n\t\t\t\t最終更新: "),a("b",[t._v(t._s(t.lastTime))])]),t._v(" "),a("v-divider",{attrs:{vertical:""}}),t._v(" "),a("a",{attrs:{href:t.$nuxt.context.pkg.base+"/thuc-tich-ircs-hinban"}},[a("span",{staticStyle:{color:"greenyellow","font-size":"1rem","padding-left":"5px"}},[a("span",[t._v("品番IRCS")]),t._v(" "),t.$nuxt.context.isMobile?t._e():a("span",[t._v("実績ページへ")])])]),t._v(" "),a("v-spacer"),t._v(" "),t.$nuxt.context.isMobile?t._e():a("div",{staticClass:"mx-4"},[a("v-menu",{attrs:{"close-on-content-click":!1,"nudge-right":40,transition:"scale-transition","offset-y":"","min-width":"auto"},scopedSlots:t._u([{key:"activator",fn:function(e){var n=e.on,r=e.attrs;return[a("v-text-field",t._g(t._b({attrs:{label:"日付","prepend-icon":"mdi-calendar",readonly:"","hide-details":!0},model:{value:t.selectedDate,callback:function(e){t.selectedDate=e},expression:"selectedDate"}},"v-text-field",r,!1),n))]}}],null,!1,776019353),model:{value:t.mSelectDate,callback:function(e){t.mSelectDate=e},expression:"mSelectDate"}},[t._v(" "),a("v-date-picker",{attrs:{"allowed-dates":t.allowedDatePicker,"show-week":!0,"show-adjacent-months":!1,locale:"jp-jp","day-format":t.dayFormat},on:{input:function(e){t.mSelectDate=!1},change:t.onDateChanged},model:{value:t.selectedDate,callback:function(e){t.selectedDate=e},expression:"selectedDate"}})],1)],1),t._v(" "),a("v-divider",{attrs:{vertical:""}}),t._v(" "),t.$nuxt.context.isMobile?t._e():a("v-btn-toggle",{attrs:{color:"yellow",dense:"",group:"",mandatory:""},on:{change:t.onCAChange},model:{value:t.selectedCA,callback:function(e){t.selectedCA=e},expression:"selectedCA"}},t._l(t.caOptionsItems,(function(e){return a("v-btn",{key:e.value,attrs:{value:e.value,text:""}},[t._v("\n\t\t\t\t\t"+t._s(e.text)+"\n\t\t\t\t")])})),1),t._v(" "),t.$nuxt.context.isMobile?a("v-select",{attrs:{items:t.caOptionsItems},model:{value:t.selectedCA,callback:function(e){t.selectedCA=e},expression:"selectedCA"}}):t._e(),t._v(" "),a("v-divider",{attrs:{vertical:""}}),t._v(" "),a("v-btn",{staticClass:"ma-2 white--text",attrs:{color:"green",disabled:t.ttIrcsData.length<=0,small:t.$nuxt.context.isMobile},on:{click:t.excelDownload}},[t._v("\n\t\t\t\tExcel\n\t\t\t\t"),t.$nuxt.context.isMobile?t._e():a("v-icon",{attrs:{right:"",dark:""}},[t._v("\n\t\t\t\t\tmdi-cloud-download\n\t\t\t\t")])],1),t._v(" "),a("v-divider",{attrs:{vertical:""}}),t._v(" "),a("v-btn",{staticClass:"ma-2 white--text",attrs:{color:"pink",disabled:t.ttIrcsData.length<=0,small:t.$nuxt.context.isMobile},on:{click:function(e){e.stopPropagation(),t.setHDialog=!0}}},[t._v("\n\t\t\t\tSET/H 出力\n\t\t\t\t"),t.$nuxt.context.isMobile?t._e():a("v-icon",{attrs:{right:"",dark:""}},[t._v("\n\t\t\t\t\tmdi-av-timer\n\t\t\t\t")])],1),t._v(" "),a("v-divider",{attrs:{vertical:""}}),t._v(" "),a("v-btn",{staticClass:"ma-2 white--text",attrs:{color:"yellow darken-3",small:t.$nuxt.context.isMobile},on:{click:function(e){return e.stopPropagation(),t.openMokuhyo.apply(null,arguments)}}},[t._v("\n\t\t\t\t目標入力\n\t\t\t\t"),t.$nuxt.context.isMobile?t._e():a("v-icon",{attrs:{right:"",dark:""}},[t._v("\n\t\t\t\t\tmdi-target\n\t\t\t\t")])],1),t._v(" "),a("v-spacer"),t._v(" "),t.$nuxt.context.isMobile?t._e():a("v-switch",{attrs:{label:"生動（毎2分更新）",color:"red",inset:"","hide-details":""},on:{change:t.onLiveToggle},model:{value:t.isLive,callback:function(e){t.isLive=e},expression:"isLive"}})],1),t._v(" "),a("v-row",[a("v-col",{attrs:{sm:"12"}},[a("div",{on:{mouseup:t.mouseUpOnTable}},[a("v-data-table",{staticClass:"elevation-1",attrs:{headers:t.headers,"fixed-header":!0,items:t.ttIrcsData.filter((function(t){return"L_WORK"!==t.C_CONG_DOAN})),"item-class":t.rowClass,height:"81vh","min-height":"700px","multi-sort":!1,"disable-sort":!0,loading:t.loading,"items-per-page":-1,"hide-default-footer":!0,"mobile-breakpoint":"0"},on:{"dblclick:row":t.dblclickRow,scroll:t.tableScroll},scopedSlots:t._u([{key:"item.REGISTLINENAME",fn:function(e){var n=e.isMobile,r=e.item;return["目標"==r.C_CONG_DOAN_JP||n?a("v-tooltip",{attrs:{bottom:""},scopedSlots:t._u([{key:"activator",fn:function(e){var n=e.on,l=e.attrs;return[a("v-chip",t._g(t._b({attrs:{color:"green"},on:{click:function(e){return t.editMucTieu(r)}}},"v-chip",l,!1),n),[a("b",[t._v(t._s(r.REGISTLINENAME))])])]}}],null,!0)},[t._v(" "),a("span",[a("v-banner",{staticClass:"px-2",attrs:{transition:"slide-y-transition",color:"yellow darken-3"},domProps:{innerHTML:t._s(r.REGISTLINENAME_tooltip)}})],1)]):t._e()]}},{key:"item.C_CONG_DOAN_JP",fn:function(e){var n=e.item;return[a("v-chip",{attrs:{color:"red",outlined:""}},[a("b",[t._v(t._s(n.C_CONG_DOAN_JP))])])]}},{key:"item.00",fn:function(e){var n=e.item;return[a("span",{class:[n["00_sai"]&&n["00_sai"]<0?"khong-dat-muc-tieu":"",n["00_incompleted"]?"muc-tieu-incompleted":"",0==n["00"]?"blue--text":""]},[a("span",[t._v("\n\t\t\t\t\t\t\t\t\t"+t._s(n["00"])+"\n\t\t\t\t\t\t\t\t")])])]}},{key:"item.01",fn:function(e){var n=e.item;return[a("span",{class:[n["01_sai"]&&n["01_sai"]<0?"khong-dat-muc-tieu":"",n["01_incompleted"]?"muc-tieu-incompleted":"",0==n["01"]?"blue--text":""]},[a("span",[t._v("\n\t\t\t\t\t\t\t\t\t"+t._s(n["01"])+"\n\t\t\t\t\t\t\t\t")])])]}},{key:"item.02",fn:function(e){var n=e.item;return[a("span",{class:[n["02_sai"]&&n["02_sai"]<0?"khong-dat-muc-tieu":"",n["02_incompleted"]?"muc-tieu-incompleted":"",0==n["02"]?"blue--text":""]},[a("span",[t._v("\n\t\t\t\t\t\t\t\t\t"+t._s(n["02"])+"\n\t\t\t\t\t\t\t\t")])])]}},{key:"item.03",fn:function(e){var n=e.item;return[a("span",{class:[n["03_sai"]&&n["03_sai"]<0?"khong-dat-muc-tieu":"",n["03_incompleted"]?"muc-tieu-incompleted":"",0==n["03"]?"blue--text":""]},[a("span",[t._v("\n\t\t\t\t\t\t\t\t\t"+t._s(n["03"])+"\n\t\t\t\t\t\t\t\t")])])]}},{key:"item.04",fn:function(e){var n=e.item;return[a("span",{class:[n["04_sai"]&&n["04_sai"]<0?"khong-dat-muc-tieu":"",n["04_incompleted"]?"muc-tieu-incompleted":"",0==n["04"]?"blue--text":""]},[a("span",[t._v("\n\t\t\t\t\t\t\t\t\t"+t._s(n["04"])+"\n\t\t\t\t\t\t\t\t")])])]}},{key:"item.05",fn:function(e){var n=e.item;return[a("span",{class:[n["05_sai"]&&n["05_sai"]<0?"khong-dat-muc-tieu":"",n["05_incompleted"]?"muc-tieu-incompleted":"",0==n["05"]?"blue--text":""]},[a("span",[t._v("\n\t\t\t\t\t\t\t\t\t"+t._s(n["05"])+"\n\t\t\t\t\t\t\t\t")])])]}},{key:"item.06",fn:function(e){var n=e.item;return[a("span",{class:[n["06_sai"]&&n["06_sai"]<0?"khong-dat-muc-tieu":"",n["06_incompleted"]?"muc-tieu-incompleted":"",0==n["06"]?"blue--text":""]},[a("span",[t._v("\n\t\t\t\t\t\t\t\t\t"+t._s(n["06"])+"\n\t\t\t\t\t\t\t\t")])])]}},{key:"item.07",fn:function(e){var n=e.item;return[a("span",{class:[n["07_sai"]&&n["07_sai"]<0?"khong-dat-muc-tieu":"",n["07_incompleted"]?"muc-tieu-incompleted":"",0==n["07"]?"blue--text":""]},[a("span",[t._v("\n\t\t\t\t\t\t\t\t\t"+t._s(n["07"])+"\n\t\t\t\t\t\t\t\t")])])]}},{key:"item.08",fn:function(e){var n=e.item;return[a("span",{class:[n["08_sai"]&&n["08_sai"]<0?"khong-dat-muc-tieu":"",n["08_incompleted"]?"muc-tieu-incompleted":"",0==n["08"]?"blue--text":""]},[a("span",[t._v("\n\t\t\t\t\t\t\t\t\t"+t._s(n["08"])+"\n\t\t\t\t\t\t\t\t")])])]}},{key:"item.09",fn:function(e){var n=e.item;return[a("span",{class:[n["09_sai"]&&n["09_sai"]<0?"khong-dat-muc-tieu":"",n["09_incompleted"]?"muc-tieu-incompleted":"",0==n["09"]?"blue--text":""]},[a("span",[t._v("\n\t\t\t\t\t\t\t\t\t"+t._s(n["09"])+"\n\t\t\t\t\t\t\t\t")])])]}},{key:"item.10",fn:function(e){var n=e.item;return[a("span",{class:[n["10_sai"]&&n["10_sai"]<0?"khong-dat-muc-tieu":"",n["10_incompleted"]?"muc-tieu-incompleted":"",0==n[10]?"blue--text":""]},[a("span",[t._v("\n\t\t\t\t\t\t\t\t\t"+t._s(n[10])+"\n\t\t\t\t\t\t\t\t")])])]}},{key:"item.11",fn:function(e){var n=e.item;return[a("span",{class:[n["11_sai"]&&n["11_sai"]<0?"khong-dat-muc-tieu":"",n["11_incompleted"]?"muc-tieu-incompleted":"",0==n[11]?"blue--text":""]},[a("span",[t._v("\n\t\t\t\t\t\t\t\t\t"+t._s(n[11])+"\n\t\t\t\t\t\t\t\t")])])]}},{key:"item.12",fn:function(e){var n=e.item;return[a("span",{class:[n["12_sai"]&&n["12_sai"]<0?"khong-dat-muc-tieu":"",n["12_incompleted"]?"muc-tieu-incompleted":"",0==n[12]?"blue--text":""]},[a("span",[t._v("\n\t\t\t\t\t\t\t\t\t"+t._s(n[12])+"\n\t\t\t\t\t\t\t\t")])])]}},{key:"item.13",fn:function(e){var n=e.item;return[a("span",{class:[n["13_sai"]&&n["13_sai"]<0?"khong-dat-muc-tieu":"",n["13_incompleted"]?"muc-tieu-incompleted":"",0==n[13]?"blue--text":""]},[a("span",[t._v("\n\t\t\t\t\t\t\t\t\t"+t._s(n[13])+"\n\t\t\t\t\t\t\t\t")])])]}},{key:"item.14",fn:function(e){var n=e.item;return[a("span",{class:[n["14_sai"]&&n["14_sai"]<0?"khong-dat-muc-tieu":"",n["14_incompleted"]?"muc-tieu-incompleted":"",0==n[14]?"blue--text":""]},[a("span",[t._v("\n\t\t\t\t\t\t\t\t\t"+t._s(n[14])+"\n\t\t\t\t\t\t\t\t")])])]}},{key:"item.15",fn:function(e){var n=e.item;return[a("span",{class:[n["15_sai"]&&n["15_sai"]<0?"khong-dat-muc-tieu":"",n["15_incompleted"]?"muc-tieu-incompleted":"",0==n[15]?"blue--text":""]},[a("span",[t._v("\n\t\t\t\t\t\t\t\t\t"+t._s(n[15])+"\n\t\t\t\t\t\t\t\t")])])]}},{key:"item.16",fn:function(e){var n=e.item;return[a("span",{class:[n["16_sai"]&&n["16_sai"]<0?"khong-dat-muc-tieu":"",n["16_incompleted"]?"muc-tieu-incompleted":"",0==n[16]?"blue--text":""]},[a("span",[t._v("\n\t\t\t\t\t\t\t\t\t"+t._s(n[16])+"\n\t\t\t\t\t\t\t\t")])])]}},{key:"item.17",fn:function(e){var n=e.item;return[a("span",{class:[n["17_sai"]&&n["17_sai"]<0?"khong-dat-muc-tieu":"",n["17_incompleted"]?"muc-tieu-incompleted":"",0==n[17]?"blue--text":""]},[a("span",[t._v("\n\t\t\t\t\t\t\t\t\t"+t._s(n[17])+"\n\t\t\t\t\t\t\t\t")])])]}},{key:"item.18",fn:function(e){var n=e.item;return[a("span",{class:[n["18_sai"]&&n["18_sai"]<0?"khong-dat-muc-tieu":"",n["18_incompleted"]?"muc-tieu-incompleted":"",0==n[18]?"blue--text":""]},[a("span",[t._v("\n\t\t\t\t\t\t\t\t\t"+t._s(n[18])+"\n\t\t\t\t\t\t\t\t")])])]}},{key:"item.18+19",fn:function(e){var n=e.item;return[a("span",{class:[n["18+19_sai"]&&n["18+19_sai"]<0?"khong-dat-muc-tieu":"",n["18+19_incompleted"]?"muc-tieu-incompleted":"",0==n["18+19"]?"blue--text":""]},[a("span",[t._v("\n\t\t\t\t\t\t\t\t\t"+t._s(n["18+19"])+"\n\t\t\t\t\t\t\t\t")])])]}},{key:"item.19",fn:function(e){var n=e.item;return[a("span",{class:[n["19_sai"]&&n["19_sai"]<0?"khong-dat-muc-tieu":"",n["19_incompleted"]?"muc-tieu-incompleted":"",0==n[19]?"blue--text":""]},[a("span",[t._v("\n\t\t\t\t\t\t\t\t\t"+t._s(n[19])+"\n\t\t\t\t\t\t\t\t")])])]}},{key:"item.20",fn:function(e){var n=e.item;return[a("span",{class:[n["20_sai"]&&n["20_sai"]<0?"khong-dat-muc-tieu":"",n["20_incompleted"]?"muc-tieu-incompleted":"",0==n[20]?"blue--text":""]},[a("span",[t._v("\n\t\t\t\t\t\t\t\t\t"+t._s(n[20])+"\n\t\t\t\t\t\t\t\t")])])]}},{key:"item.21",fn:function(e){var n=e.item;return[a("span",{class:[n["21_sai"]&&n["21_sai"]<0?"khong-dat-muc-tieu":"",n["21_incompleted"]?"muc-tieu-incompleted":"",0==n[21]?"blue--text":""]},[a("span",[t._v("\n\t\t\t\t\t\t\t\t\t"+t._s(n[21])+"\n\t\t\t\t\t\t\t\t")])])]}},{key:"item.22",fn:function(e){var n=e.item;return[a("span",{class:[n["22_sai"]&&n["22_sai"]<0?"khong-dat-muc-tieu":"",n["22_incompleted"]?"muc-tieu-incompleted":"",0==n[22]?"blue--text":""]},[a("span",[t._v("\n\t\t\t\t\t\t\t\t\t"+t._s(n[22])+"\n\t\t\t\t\t\t\t\t")])])]}},{key:"item.23",fn:function(e){var n=e.item;return[a("span",{class:[n["23_sai"]&&n["23_sai"]<0?"khong-dat-muc-tieu":"",n["23_incompleted"]?"muc-tieu-incompleted":"",0==n[23]?"blue--text":""]},[a("span",[t._v("\n\t\t\t\t\t\t\t\t\t"+t._s(n[23])+"\n\t\t\t\t\t\t\t\t")])])]}}])})],1)])],1),t._v(" "),a("v-dialog",{attrs:{"max-width":"40vw",persistent:""},model:{value:t.setHDialog,callback:function(e){t.setHDialog=e},expression:"setHDialog"}},[a("v-card",[a("v-card-title",{staticClass:"text-h5"},[t._v(" SET/H 出力 ")]),t._v(" "),a("v-card-text",[a("v-container",[a("v-toolbar",{attrs:{dark:"",height:"60px",color:"orange darken-3",dense:""}},[a("v-spacer"),t._v(" "),a("el-date-picker",{attrs:{type:"date",placeholder:"Select Date","value-format":"yyyy-MM-dd","picker-options":t.pickerOptions},on:{change:function(e){!t.selectedDateSH&&(t.listSeisan=[])}},model:{value:t.selectedDateSH,callback:function(e){t.selectedDateSH=e},expression:"selectedDateSH"}}),t._v(" "),a("v-spacer")],1)],1)],1),t._v(" "),a("v-card-actions",[a("v-spacer"),t._v(" "),a("v-btn",{attrs:{color:"grey darken-1",text:""},on:{click:function(e){t.setHDialog=!1}}},[t._v("\n\t\t\t\t\t\tCancel\n\t\t\t\t\t")]),t._v(" "),a("v-btn",{attrs:{color:"green darken-1",text:"",disabled:!t.selectedDateSH},on:{click:t.downloadSetH_Data}},[t._v("\n\t\t\t\t\t\tDownload\n\t\t\t\t\t")])],1)],1)],1),t._v(" "),a("v-dialog",{attrs:{"max-width":"40vw",persistent:""},model:{value:t.setTargetDialog,callback:function(e){t.setTargetDialog=e},expression:"setTargetDialog"}},[a("v-card",[a("v-card-title",{staticClass:"text-h4"},[t._v(" 目標 ")]),t._v(" "),a("v-card-text",[a("v-container",[a("v-row",{attrs:{"no-gutters":""}},[a("v-col",[a("el-date-picker",{attrs:{type:"date",placeholder:"Ngày Assy","value-format":"yyyy-MM-dd","picker-options":t.pickerOptions,rules:t.target_rules.ca,required:""},model:{value:t.targetData.d_assy,callback:function(e){t.$set(t.targetData,"d_assy",e)},expression:"targetData.d_assy"}})],1),t._v(" "),a("v-col",[a("v-select",{staticClass:"shrink mr-2 search-field",attrs:{items:["CA3","CA4"],label:"chọn CA",color:"pink",outlined:"",dense:"",clearable:"","hide-details":"auto",required:"",rules:t.target_rules.ca},on:{change:t.onMucTieuCaChanged},model:{value:t.targetData.ca,callback:function(e){t.$set(t.targetData,"ca",e)},expression:"targetData.ca"}})],1),t._v(" "),a("v-col",[a("v-select",{staticClass:"shrink mr-2 search-field",attrs:{items:t.lineList,label:"chọn LINE",color:"pink",outlined:"",dense:"",clearable:"","hide-details":"auto",required:"",rules:t.target_rules.line},model:{value:t.targetData.line,callback:function(e){t.$set(t.targetData,"line",e)},expression:"targetData.line"}})],1)],1),t._v(" "),a("v-row",[a("v-col",[a("v-text-field",{staticClass:"shrink",attrs:{label:"TG.Gia động(phút)",outlined:"",dense:"",clearable:"",required:"",rules:t.target_rules.tgiadong,type:"number"},model:{value:t.targetData.t_gia_dong,callback:function(e){t.$set(t.targetData,"t_gia_dong",e)},expression:"targetData.t_gia_dong"}})],1),t._v(" "),a("v-col",[a("v-text-field",{staticClass:"shrink",attrs:{label:"Kế Hoạch(SET)",outlined:"",dense:"",clearable:"",required:"",rules:t.target_rules.lkehoach,type:"number"},model:{value:t.targetData.l_ke_hoach,callback:function(e){t.$set(t.targetData,"l_ke_hoach",e)},expression:"targetData.l_ke_hoach"}})],1)],1),t._v(" "),a("v-row",[a("v-col",[a("v-select",{staticClass:"shrink mr-2 search-field",attrs:{items:t.fullDayHours,"item-text":"text","item-value":"val",label:"chọn giờ dùng cơm",color:"purple",outlined:"",dense:"",clearable:"","hide-details":"auto",required:"",rules:t.target_rules.rest_hour},model:{value:t.targetData.rest_hour,callback:function(e){t.$set(t.targetData,"rest_hour",e)},expression:"targetData.rest_hour"}})],1),t._v(" "),a("v-col")],1)],1)],1),t._v(" "),a("v-card-actions",[a("v-spacer"),t._v(" "),a("v-btn",{staticClass:"mr-4",attrs:{color:"grey darken-1",text:"",outlined:""},on:{click:function(e){t.setTargetDialog=!1}}},[t._v("\n\t\t\t\t\t\tCancel\n\t\t\t\t\t")]),t._v(" "),a("v-btn",{attrs:{color:"pink darken-1",text:"",outlined:"",disabled:!t.targetData.line||!t.targetData.ca||!t.targetData.d_assy},on:{click:t.updateTarget}},[t._v("\n\t\t\t\t\t\tSAVE\n\t\t\t\t\t")])],1)],1)],1)],1)])}),[],!1,null,null,null);e.default=M.exports;p()(M,{VBanner:g.a,VBtn:f.a,VBtnToggle:x.a,VCard:b.a,VCardActions:C.b,VCardText:C.d,VCardTitle:C.e,VChip:D.a,VCol:k.a,VContainer:y.a,VDataTable:w.a,VDatePicker:A.a,VDialog:S.a,VDivider:E.a,VIcon:O.a,VMenu:R.a,VRow:H.a,VSelect:N.a,VSpacer:T.a,VSwitch:I.a,VTextField:L.a,VToolbar:G.a,VTooltip:$.a})},970:function(t,e,a){var n=a(972),r=a(973),l=a(971);function s(t,e){var a=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),a.push.apply(a,n)}return a}function i(t){for(var e=1;e<arguments.length;e++){var a=null!=arguments[e]?arguments[e]:{};e%2?s(Object(a),!0).forEach((function(e){n(t,e,a[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(a)):s(Object(a)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(a,e))}))}return t}a(130),a(6),a(4),a(5),a(259),a(25),a(68),a(57),a(7),a(8),a(9),a(10);var o=a(968),c=a(237),u=function(){var t=l(regeneratorRuntime.mark((function t(e){var a,n,l,s,u,d,h,m,v,_,p=arguments;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return a=p.length>1&&void 0!==p[1]?p[1]:{sheetName:"sheet1",opts:{}},n=p.length>2&&void 0!==p[2]?p[2]:"Export",l=p.length>3&&void 0!==p[3]?p[3]:{expRaw:!1},s=new o.Workbook,u=s.addWorksheet(a.sheetName,a.opts),d={style:"thin",color:{argb:"974706"}},h={type:"pattern",pattern:"solid",fgColor:{argb:"FFFFFF00"}},Array.isArray(e)?e.length>0&&((m=Object.keys(e[0])).forEach((function(t,e){var a=u.getRow(1);a.getCell(e+1).font={bold:!0},a.getCell(e+1).value=t,a.getCell(e+1).border={top:d,left:d,bottom:d,right:d},a.getCell(e+1).fill=h,a.commit()})),u.views=[{state:"frozen",ySplit:1}],l.expRaw?e.forEach((function(t,e){var a=u.getRow(2+e);m.forEach((function(e,n){a.getCell(n+1).value=t[e]})),a.commit()})):(e.forEach((function(t,e){var a=u.getRow(2+e);m.forEach((function(e,n){a.getCell(n+1).value=t[e],a.getCell(n+1).border={top:d,left:d,bottom:d,right:d}})),a.commit()})),m.forEach((function(t,e){var a=u.getColumn(e+1),n=a.values.map((function(t){return t.toString().length})),l=Math.max.apply(Math,r(n.filter((function(t){return"number"==typeof t}))));l=l>t.length?l+5:t.length+5,a.width=l})))):e(u),t.next=10,s.xlsx.writeBuffer();case 10:if(v=t.sent,"string"!=typeof n){t.next=15;break}saveAs(new Blob([v]),n+".xlsx"),t.next=19;break;case 15:return t.next=17,c.post("http://172.25.216.213:3368/api/sendmail",{mailOpts:i({},n)});case 17:_=t.sent,console.log(_);case 19:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),d=function(){var t=l(regeneratorRuntime.mark((function t(e){var a,n,l,s,u,d,h,m,v,_=arguments;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(a=_.length>1&&void 0!==_[1]?_[1]:"Export",n=_.length>2&&void 0!==_[2]?_[2]:{sheetName:"sheet1",opts:{}},l=new o.Workbook,!Array.isArray(e)){t.next=10;break}s=l.addWorksheet(n.sheetName,n.opts),u={style:"thin",color:{argb:"974706"}},d={type:"pattern",pattern:"solid",fgColor:{argb:"FFFFFF00"}},e.length>0&&((h=Object.keys(e[0])).forEach((function(t,e){var a=s.getRow(1);a.getCell(e+1).font={bold:!0},a.getCell(e+1).value=t,a.getCell(e+1).border={top:u,left:u,bottom:u,right:u},a.getCell(e+1).fill=d,a.commit()})),s.views=[{state:"frozen",ySplit:1}],e.forEach((function(t,e){var a=s.getRow(2+e);h.forEach((function(e,n){a.getCell(n+1).value=t[e],a.getCell(n+1).border={top:u,left:u,bottom:u,right:u}})),a.commit()})),h.forEach((function(t,e){var a=s.getColumn(e+1),n=a.values.map((function(t){return t.toString().length})),l=Math.max.apply(Math,r(n.filter((function(t){return"number"==typeof t}))));l=l>t.length?l+5:t.length+5,a.width=l}))),t.next=12;break;case 10:return t.next=12,e(l);case 12:return t.next=14,l.xlsx.writeBuffer();case 14:if(m=t.sent,"string"!=typeof a){t.next=19;break}saveAs(new Blob([m]),a+".xlsx"),t.next=23;break;case 19:return t.next=21,c.post("http://172.25.216.213:3368/api/sendmail",{mailOpts:i({},a)});case 21:v=t.sent,console.log(v);case 23:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),h=function(){var t=l(regeneratorRuntime.mark((function t(e,a){var n,r;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:n=new FileReader,r=new o.Workbook,n.readAsArrayBuffer(e),n.onload=l(regeneratorRuntime.mark((function t(){var e;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e=n.result,t.next=3,r.xlsx.load(e);case 3:"function"==typeof a&&a(r);case 4:case"end":return t.stop()}}),t)})));case 4:case"end":return t.stop()}}),t)})));return function(e,a){return t.apply(this,arguments)}}();t.exports={excelJSExport:u,excelJSReadFile:h,excelJSExportWB:d}},981:function(t,e,a){var n=a(1029);n.__esModule&&(n=n.default),"string"==typeof n&&(n=[[t.i,n,""]]),n.locals&&(t.exports=n.locals);(0,a(13).default)("084d0ea3",n,!0,{sourceMap:!1})}}]);
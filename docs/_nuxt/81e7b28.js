(window.webpackJsonp=window.webpackJsonp||[]).push([[15],{1032:function(t,e,a){"use strict";a(983)},1033:function(t,e,a){var n=a(12)(!1);n.push([t.i,"#page-thuc-tich-san-xuat-line{font-family:BIZ UDゴシック}#page-thuc-tich-san-xuat-line .tbl-header{background-color:#d9d9d9!important;font-size:1.1rem!important;padding:0 8px!important;color:#00008b;border:1px solid #000;text-align:center}#page-thuc-tich-san-xuat-line .cell-sunday{background-color:#d3d3d3!important}#page-thuc-tich-san-xuat-line .header-sunday{color:red!important}#page-thuc-tich-san-xuat-line .cell-ke-hoach{background-color:#e2efda!important;font-weight:700;border-top:2px solid #000!important}#page-thuc-tich-san-xuat-line .cell-thuc-tich{font-weight:700}#page-thuc-tich-san-xuat-line .cell-sai{background-color:#fff2cc!important;font-weight:700}#page-thuc-tich-san-xuat-line .cell-ruikei{background-color:#c6e0b4!important;font-weight:700}#page-thuc-tich-san-xuat-line .text--center{text-align:center!important}#page-thuc-tich-san-xuat-line .cell-boilder{text-align:left;font-weight:bolder}#page-thuc-tich-san-xuat-line .cell-normal{border-color:#000;border-style:dashed solid;border-width:1px;padding:0 3px!important;text-align:left;font-size:1.3rem;height:20px!important}#page-thuc-tich-san-xuat-line .cell-number{padding:0 3px!important;text-align:right;font-size:1.3rem}#page-thuc-tich-san-xuat-line .cell-shiji{text-align:right;font-size:1.8rem;color:#dc143c;background-color:#fdf5e6}#page-thuc-tich-san-xuat-line .cell-total{text-align:right;font-size:1.8rem;color:green;background-color:#fdf5e6}#page-thuc-tich-san-xuat-line .row-normal td{font-size:1.8rem!important}#page-thuc-tich-san-xuat-line .row-sum td{background-color:#d3d3d3}#page-thuc-tich-san-xuat-line .cell-zero{color:#00f}#page-thuc-tich-san-xuat-line .cell-negative{color:red}#page-thuc-tich-san-xuat-line .cell-num-over{color:#00f!important}#page-thuc-tich-san-xuat-line table{border-collapse:collapse}#page-thuc-tich-san-xuat-line .v-data-footer__select .v-select{margin-top:1px!important;margin-bottom:1px!important}#page-thuc-tich-san-xuat-line .v-badge__badge{font-size:10px!important}.v-tooltip__content.menuable__content__active{opacity:1!important}#page-thuc-tich-san-xuat-line.mobile .tbl-header{font-size:.6rem!important}#page-thuc-tich-san-xuat-line.mobile .lineHeader{min-width:50px}#page-thuc-tich-san-xuat-line.mobile .assyDateHeader{min-width:65px}#page-thuc-tich-san-xuat-line.mobile .cell-normal{font-size:.7rem}#page-thuc-tich-san-xuat-line.mobile .cell-hinban{min-width:110px}#page-thuc-tich-san-xuat-line.mobile .cell-number{font-size:.7rem}#page-thuc-tich-san-xuat-line.mobile .cell-shiji,#page-thuc-tich-san-xuat-line.mobile .cell-total{font-size:.8rem;font-weight:700}#page-thuc-tich-san-xuat-line.mobile .row-normal td{font-size:.7rem!important}",""]),t.exports=n},1052:function(t,e,a){"use strict";a.r(e);a(6),a(8),a(9),a(10);var n,r=a(1),i=a(20),l=a(43);a(4),a(5),a(25),a(163),a(7),a(584),a(52),a(585),a(586),a(587),a(588),a(589),a(590),a(591),a(592),a(593),a(594),a(595),a(596),a(597),a(598),a(599),a(600),a(68),a(28),a(36),a(259),a(57),a(130);function o(t,e){var a=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),a.push.apply(a,n)}return a}function c(t){for(var e=1;e<arguments.length;e++){var a=null!=arguments[e]?arguments[e]:{};e%2?o(Object(a),!0).forEach((function(e){Object(r.a)(t,e,a[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(a)):o(Object(a)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(a,e))}))}return t}var s,u=a(970),d=(n={head:{title:"生産実績サマリー"},data:function(){return{kameStyle:!1,ttIrcsHinbanData:[],ttSXData:[],selectedDate:null,ruikeiStartDate:null,editedRuikei:{},dialog_Edit_Ruikei:!1,selectedDates:null,selectedIrcsTime:null,selectedLine:null,pageInit:null,lineAmDetail:{},dateScope:[],rawFile:null,title:"生産実績サマリー ● Thực tích sản xuất - LINE",loading:!1,today:(new Date).toISOString().substring(0,10),maxNichiCol:3,selectedStatus:"ALL",pickerOptions:{disabledDate:function(t){var e=new Date,a=new Date;return e.setDate(e.getDate()-150),a.setDate(a.getDate()+4),t.getTime()<e.getTime()||t.getTime()>a.getTime()}}}},components:{},created:function(){},mounted:(s=Object(l.a)(regeneratorRuntime.mark((function t(){var e;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return this.$nuxt.$emit("page-info",{title:this.title,version:"1.0.0",options:{replace:!0}}),t.prev=1,t.next=4,this.$axios.get("tt-sx/init");case 4:e=t.sent,this.pageInit=e.data,t.next=11;break;case 8:t.prev=8,t.t0=t.catch(1),console.log(t.t0);case 11:return t.prev=11,t.finish(11);case 13:return this.shijiMaxDate?this.selectedDates=[this.$moment().add(-10,"day").format("YYYY-MM-DD"),this.shijiMaxDate]:this.selectedDates=[this.$moment().add(-10,"day").format("YYYY-MM-DD"),this.$moment().add(2,"day").format("YYYY-MM-DD")],t.next=16,this.getData();case 16:if("ruikeiDaily"!=this.$route.query.type){t.next=19;break}return t.next=19,this.excelDownload();case 19:case"end":return t.stop()}}),t,this,[[1,8,11,13]])}))),function(){return s.apply(this,arguments)}),computed:{searchKey:function(){return this.keyWorld.toUpperCase()},shijiMaxDate:function(){return this.pageInit&&this.pageInit.SIJI_INFO.length>0?this.pageInit.SIJI_INFO[0].D_SIJI_MAX:null},headers:function(){var t=this,e=[{text:"LINE NO.",value:"ラインNO",width:80,minWidth:80,excelWidth:15,class:["tbl-header"],fixed:!0},{text:"顧客",value:"C_MKCOD",width:100,minWidth:100,excelWidth:15,class:["tbl-header"],fixed:!0},{text:"車種",value:"C_SAJYU",width:100,minWidth:100,excelWidth:15,class:["tbl-header"],fixed:!0},{text:"WH種類",value:"C_HARNESSJYU",width:100,minWidth:100,excelWidth:15,class:["tbl-header"],fixed:!0},{text:"",value:"C_NAME",width:80,minWidth:80,excelWidth:10,class:["tbl-header"],fixed:!0}];return this.dayRange.forEach((function(a){e.push(t.createHeaderCol(a.substring(5),a,50))})),e},excelHeader:function(){excelH=[]},ttSX_Data:function(){var t=this,e=this.ttSXData.map((function(e,a,n){var r={C_SAJYU:e.C_SAJYU,C_HARNESSJYU:e.C_HARNESSJYU,"ラインNO":e.ラインNO,C_NAME:e.C_NAME,l_order:t.getRowOrder(e.C_NAME)};return t.dayRangeRuikei.forEach((function(a){var n=t.$moment(a);"計画"!=e.C_NAME&&"実績"!=e.C_NAME||0==n.day()?r[a]=e[a]:r[a]=e[a]||0,"実績"==e.C_NAME&&(r[a+"_C_HIN"]=e[a+"_C_HIN"])})),r}));e.push.apply(e,Object(i.a)(this.createAdditionRow("差",5))),e.push.apply(e,Object(i.a)(this.createAdditionRow("累計",6))),e.sort((function(t,e){return t.ラインNO.substring(1,3)>e.ラインNO.substring(1,3)?1:t.ラインNO.substring(1,3)<e.ラインNO.substring(1,3)?-1:t.ラインNO.length>e.ラインNO.length?1:t.ラインNO.length<e.ラインNO.length?-1:t.ラインNO>e.ラインNO?1:t.ラインNO<e.ラインNO?-1:t.l_order>e.l_order?1:t.l_order<e.l_order?-1:0}));var a={},n={};return this.lineAmDetail={},e.map((function(e){return"差"==e.C_NAME&&t.dayRange.forEach((function(n){t.lineAmDetail[n]||(t.lineAmDetail[n]={}),e[n]<0&&(a[n]?a[n]=a[n]+1:a[n]=1,e[n+"_sttAm"]=a[n],t.lineAmDetail[n]["差"]=(t.lineAmDetail[n]["差"]||"差")+"<br/>"+a[n]+". "+e.ラインNO+': <span style="color:red;font-weight:bold">'+e[n]+"</span>",t.lineAmDetail[n]["差_copy"]=(t.lineAmDetail[n]["差_copy"]||"差")+"\n"+e.ラインNO+": "+e[n])})),"累計"==e.C_NAME&&t.dayRange.forEach((function(a){t.lineAmDetail[a]||(t.lineAmDetail[a]={}),e[a]<0&&(n[a]?n[a]=n[a]+1:n[a]=1,e[a+"_sttAm"]=n[a],t.lineAmDetail[a]["累計"]=(t.lineAmDetail[a]["累計"]||"累計")+"<br/>"+n[a]+". "+e.ラインNO+': <span style="color:red;font-weight:bold">'+e[a]+"</span>",t.lineAmDetail[a]["累計_copy"]=(t.lineAmDetail[a]["累計_copy"]||"累計")+"\n"+e.ラインNO+": "+e[a])})),e}))},ttExcelData:function(){return this.ttSX_Data.filter((function(t){return"RUIKEI"!=t.C_NAME}))},dayRange:function(){var t=[];if(this.selectedDates&&2==this.selectedDates.length&&this.ttSXData.length>0){var e=this.$moment(this.selectedDates[0]),a=this.$moment(this.selectedDates[1]).diff(e,"days");t.push(e.format("YYYY-MM-DD"));for(var n=0;n<a;n++)e.add(1,"day"),t.push(e.format("YYYY-MM-DD"))}return t},dayRangeRuikei:function(){var t=[];if(this.selectedDates&&2==this.selectedDates.length&&this.ttSXData.length>0){var e=this.$moment(this.ruikeiStartDate),a=this.$moment(this.selectedDates[1]).diff(e,"days");t.push(e.format("YYYY-MM-DD"));for(var n=0;n<a;n++)e.add(1,"day"),t.push(e.format("YYYY-MM-DD"))}return t},lines:function(){var t=this.ttSXData.map((function(t){return t.ラインNO}));return Object(i.a)(new Set(t))}}},Object(r.a)(n,"created",(function(){})),Object(r.a)(n,"components",{}),Object(r.a)(n,"methods",{onHeaderClicked:function(t){var e=this;return Object(l.a)(regeneratorRuntime.mark((function a(){return regeneratorRuntime.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:if(!/^\d+-\d+-\d+$/.test(t.value)){a.next=9;break}if(!e.lineAmDetail[t.value]){a.next=7;break}return a.next=4,e.$copyText((e.lineAmDetail[t.value].差_copy||"")+"\n"+(e.lineAmDetail[t.value].累計_copy||""));case 4:e.$root.$Snackbar.show({message:"Đã Copy!!"}),a.next=9;break;case 7:return a.next=9,e.$copyText("");case 9:case"end":return a.stop()}}),a)})))()},copyContent:function(t){var e=this;return Object(l.a)(regeneratorRuntime.mark((function a(){return regeneratorRuntime.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,e.$copyText(t);case 2:e.$root.$Snackbar.show({message:"Đã Copy!!"});case 3:case"end":return a.stop()}}),a)})))()},createHeaderCol:function(t,e,a){var n={text:t,excellText:e,excelWidth:10,value:e,width:a||"100%",class:["tbl-header"],rowClass:["cell-number"],type:"number"};return this.isStringSunday(e)&&(n.class.push("header-sunday"),n.rowClass.push("cell-sunday")),n.lAm=this.ttSX_Data.reduce((function(t,a){return"差"==a.C_NAME&&a[e]<0?t+1:t}),0),n.lRuikeiAm=this.ttSX_Data.reduce((function(t,a){return"累計"==a.C_NAME&&a[e]<0?t+1:t}),0),n},createAdditionRow:function(t,e){var a=this;return this.lines.map((function(n){var r={"ラインNO":n,C_NAME:t,l_order:e};return a.dayRangeRuikei.forEach((function(e,i){"差"==t?r[e]=a.ttSXData.reduce((function(t,a){return a.ラインNO==n&&"実績"==a.C_NAME?t+(a[e]||0):t}),0)-a.ttSXData.reduce((function(t,a){return a.ラインNO==n&&"計画"==a.C_NAME?t+(a[e]||0):t}),0):"累計"==t&&(r[e]=0==i?a.ttSXData.reduce((function(t,a){return a.ラインNO==n&&"実績"==a.C_NAME?t+(a[e]||0):t}),0)-a.ttSXData.reduce((function(t,a){return a.ラインNO==n&&"計画"==a.C_NAME?t+(a[e]||0):t}),0):r[a.dayRangeRuikei[i-1]]+a.ttSXData.reduce((function(t,a){return a.ラインNO==n&&"実績"==a.C_NAME?t+(a[e]||0):t}),0)-a.ttSXData.reduce((function(t,a){return a.ラインNO==n&&"計画"==a.C_NAME?t+(a[e]||0):t}),0),a.ttSXData.forEach((function(t){t.ラインNO==n&&"RUIKEI"==t.C_NAME&&"number"==typeof t[e]&&(r[e]=t[e],r[e+"_RUIKEI"]=t[e])})))})),r}))},rowClass:function(t){var e=["cell-normal"];return"計画"==t.C_NAME&&e.push("cell-ke-hoach"),"差"==t.C_NAME&&e.push("cell-sai"),"累計"==t.C_NAME&&e.push("cell-ruikei"),"実績"==t.C_NAME&&e.push("cell-thuc-tich"),e},isStringSunday:function(t){var e=this.$moment(t);return!!e.isValid()&&0==e.day()},getRows:function(t){var e=[];return this.headers.forEach((function(a,n){var r;a.children?a.children.forEach((function(a,n){r=t[a.value],e.push(c(c({},a),{},{colVal:r}))})):(r=t[a.value],e.push(c(c({},a),{},{colVal:r})))})),e},getData:function(){var t=this;return Object(l.a)(regeneratorRuntime.mark((function e(){var a,n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.ttSXData=[],t.selectedDates&&2==t.selectedDates.length){e.next=3;break}return e.abrupt("return");case 3:return t.loading=!0,a="/tt-sx-line?1=1",t.selectedDates&&t.selectedDates.length&&t.selectedDates.length>0&&(a=a+"&dStart="+t.selectedDates[0]+"&dEnd="+t.selectedDates[1]),t.selectedIrcsTime&&""!==t.selectedIrcsTime&&(a=a+"&dIrcs="+t.selectedIrcsTime),e.prev=7,e.next=10,t.$axios.get(a);case 10:n=e.sent,new Date,console.log(n.data.data),t.ttSXData=Object(i.a)(n.data.data),t.ruikeiStartDate=n.data.startDate,e.next=20;break;case 17:e.prev=17,e.t0=e.catch(7),console.log(e.t0);case 20:return e.prev=20,t.loading=!1,e.finish(20);case 23:case"end":return e.stop()}}),e,null,[[7,17,20,23]])})))()},getRowOrder:function(t){switch(t){case"計画":return 1;case"昼勤実績":return 2;case"夜勤実績":return 3;case"実績":return 4;case"差":return 5;case"累計":return 6}},onDateChanged:function(t){this.getData()},onClearDate:function(){this.selectedDate="",this.getData()},tryUpdateRuikei:function(){console.log(this.$route.name),this.$nuxt.context.appConfig.secretCODE[this.$route.name]!=this.editedRuikei.pass&&this.$root.$Snackbar.show({message:"Sai mật khẩu!!!"})},handleUploadBtnClick:function(){this.$refs.uploadFile.value=null,this.$refs.uploadFile.click()},handleFileChange:function(t){this.$refs.uploadFile.value&&(this.rawFile=t.target.files[0],console.log(this.rawFile))},excelDownload:function(){var t=this;return Object(l.a)(regeneratorRuntime.mark((function e(){var a;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:a="TT_SX_LINE_"+(t.selectedDates[0]||"")+"_"+t.selectedDates[1],u.excelJSExport((function(e){var a={style:"thin",color:{argb:"FF000000"}},n={style:"hair",color:{argb:"FF000000"}},r={type:"pattern",pattern:"solid",fgColor:{argb:"FFD9D9D9"}},l={vertical:"middle",horizontal:"center"},o={vertical:"middle",horizontal:"center"};e.properties.defaultRowHeight=18.75,e.properties.defaultColWidth=10;var c=e.getRow(3);t.headers.forEach((function(t,e){c.getCell(e+2).font={bold:!0},/^\d+-\d+-\d+$/.test(t.excellText||t.text)?c.getCell(e+2).value=new Date(Date.parse(t.excellText)):c.getCell(e+2).value=t.excellText||t.text,c.getCell(e+2).border={top:a,left:a,bottom:a,right:a},c.getCell(e+2).fill=r,c.getCell(e+2).numFmt="mm/dd",c.getCell(e+2).alignment=o})),c.font={name:"BIZ UDゴシック"},c.commit(),e.views=[{state:"frozen",ySplit:3,xSplit:6,showGridLines:!1}],t.ttExcelData.forEach((function(r,i){var l=e.getRow(4+i);t.headers.forEach((function(t,e){l.getCell(e+2).value=r[t.value],"C_NAME"==t.value&&(l.getCell(e+2).alignment=o),"計画"==r.C_NAME?l.getCell(e+2).border={top:a,left:a,bottom:n,right:a}:"累計"==r.C_NAME?l.getCell(e+2).border={top:n,left:a,bottom:a,right:a}:l.getCell(e+2).border={top:n,left:a,bottom:n,right:a},"number"==t.type&&(l.getCell(e+2).numFmt="#,##0")})),l.font={name:"BIZ UDゴシック"},l.commit()})),t.headers.forEach((function(t,a){var n=e.getColumn(a+2);if(t.excelWidth)n.width=t.excelWidth;else{var r=n.values.map((function(t){return t.toString().length})),l=Math.max.apply(Math,Object(i.a)(r.filter((function(t){return"number"==typeof t}))));l=l>t.value.length?l+2:t.value.length+2,n.width=l}}));for(var s=7;s<7+t.dayRange.length;s++)e.getCell(t.$getExcelColumnName(s)+1).value={formula:'COUNTIFS($F:$F,"差",'+t.$getExcelColumnName(s)+":"+t.$getExcelColumnName(s)+',"<0")',result:0},e.getCell(t.$getExcelColumnName(s)+2).value={formula:'COUNTIFS($F:$F,"累計",'+t.$getExcelColumnName(s)+":"+t.$getExcelColumnName(s)+',"<0")',result:0};var u=4;do{e.mergeCells("A"+u+":A"+(u+5)),e.getCell("A"+u).alignment=l,e.mergeCells("B"+u+":B"+(u+5)),e.getCell("B"+u).alignment=l,e.mergeCells("C"+u+":C"+(u+5)),e.getCell("C"+u).alignment=l,e.mergeCells("D"+u+":D"+(u+5)),e.getCell("D"+u).alignment=l,e.mergeCells("E"+u+":E"+(u+5)),e.getCell("E"+u).alignment=l,u+=6}while(u<t.ttExcelData.length);e.addConditionalFormatting({ref:"F".concat(3,":")+t.$getExcelColumnName(t.headers.length+2-1)+(t.ttExcelData.length+3),rules:[{type:"expression",formulae:["$F".concat(3,'="計画"')],style:{fill:{type:"pattern",pattern:"solid",fgColor:{argb:"FFE2EFDA"},bgColor:{argb:"FFE2EFDA"}}}}]}),e.addConditionalFormatting({ref:"F".concat(3,":")+t.$getExcelColumnName(t.headers.length+2-1)+(t.ttExcelData.length+3),rules:[{type:"expression",formulae:["$F".concat(3,'="差"')],style:{fill:{type:"pattern",pattern:"solid",fgColor:{argb:"FFFFF2CC"},bgColor:{argb:"FFFFF2CC"}}}}]}),e.addConditionalFormatting({ref:"F".concat(3,":")+t.$getExcelColumnName(t.headers.length+2-1)+(t.ttExcelData.length+3),rules:[{type:"expression",formulae:["$F".concat(3,'="累計"')],style:{fill:{type:"pattern",pattern:"solid",fgColor:{argb:"FFC6E0B4"},bgColor:{argb:"FFC6E0B4"}}}}]}),e.addConditionalFormatting({ref:"G".concat(3,":")+t.$getExcelColumnName(t.headers.length+2-1)+(t.ttExcelData.length+3),rules:[{type:"expression",formulae:["WEEKDAY(G$".concat(3,")=1")],style:{fill:{type:"pattern",pattern:"solid",fgColor:{argb:"FFD9D9D9"},bgColor:{argb:"FFD9D9D9"}}}}]}),e.addConditionalFormatting({ref:"G".concat(3,":")+t.$getExcelColumnName(t.headers.length+2-1)+(t.ttExcelData.length+3),rules:[{type:"expression",formulae:["G".concat(3,"<0")],style:{font:{color:{argb:"FFFF0000"}}}}]}),e.addConditionalFormatting({ref:"G".concat(3,":")+t.$getExcelColumnName(t.headers.length+2-1)+3,rules:[{type:"expression",formulae:["WEEKDAY(G".concat(3,")=1")],style:{font:{color:{argb:"FFFF0000"}}}}]})}),{sheetName:"生産実績サマリー",opts:{pageSetup:{fitToPage:!0,fitToHeight:1,fitToWidth:1,paperSize:8,printArea:"B3:"+t.$getExcelColumnName(t.headers.length+2)+(t.ttExcelData.length+3)}}},a);case 2:case"end":return e.stop()}}),e)})))()}}),Object(r.a)(n,"beforeDestroy",(function(){})),n),h=d,p=(a(1032),a(82)),g=a(111),m=a.n(g),f=a(408),v=a(409),x=a(239),b=a(393),C=a(98),_=a(396),D=a(392),y=a(422),E=a(200),w=a(404),k=a(416),A=a(202),N=a(398),O=a(395),S=a(62),R=a(103),F=a(421),M=Object(p.a)(h,(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{class:t.$nuxt.context.isMobile?"mobile":"",attrs:{id:"page-thuc-tich-san-xuat-line"}},[a("v-toolbar",{attrs:{dark:"",height:"60px",color:"orange darken-3",dense:""}},[a("v-spacer"),t._v(" "),a("v-divider",{staticClass:"mx-2",attrs:{vertical:""}}),t._v(" "),a("el-date-picker",{attrs:{type:"daterange","range-separator":"To","start-placeholder":"Start date","end-placeholder":"End date","value-format":"yyyy-MM-dd","picker-options":t.pickerOptions},on:{change:t.getData},model:{value:t.selectedDates,callback:function(e){t.selectedDates=e},expression:"selectedDates"}}),t._v(" "),a("v-divider",{staticClass:"mx-2",attrs:{vertical:""}}),t._v(" "),a("v-hover",{scopedSlots:t._u([{key:"default",fn:function(e){var n=e.hover;return[t.$nuxt.context.isMobile?t._e():a("v-btn",{staticClass:"white--text",class:"elevation-"+(n?24:6),attrs:{color:"green",disabled:t.ttSX_Data.length<=0||t.loading,small:t.$nuxt.context.isMobile},on:{click:t.excelDownload}},[t._v("\n\t\t\t\t\tExcel\n\t\t\t\t\t"),a("v-icon",{attrs:{right:"",dark:""}},[t._v(" mdi-cloud-download ")])],1)]}}])}),t._v(" "),a("v-divider",{staticClass:"mx-2",attrs:{vertical:""}}),t._v(" "),a("v-btn",{staticClass:"white--text",attrs:{color:"blue",disabled:t.loading,small:t.$nuxt.context.isMobile,elevation:"5"},on:{click:t.getData}},[t._v("\n\t\t\tSearch\n\t\t\t"),t.$nuxt.context.isMobile?t._e():a("v-icon",{class:t.loading?"mdi-spin":"",attrs:{right:"",dark:""}},[t._v("\n\t\t\t\tmdi-refresh-circle\n\t\t\t")])],1),t._v(" "),a("v-spacer")],1),t._v(" "),a("v-row",[a("v-col",{attrs:{sm:"12"}},[a("div",[a("v-data-table",{staticClass:"elevation-1",attrs:{headers:t.headers,"fixed-header":!0,items:t.ttExcelData,"item-class":"rowClass",height:"75vh","multi-sort":!1,"disable-sort":!0,loading:t.loading,"hide-default-footer":!1,"hide-default-header":"","mobile-breakpoint":"0","items-per-page":500,"footer-props":{"items-per-page-options":[100,200,500,1e3,1500,-1]}},scopedSlots:t._u([{key:"header",fn:function(e){return[a("thead",{staticClass:"v-data-table-header"},[a("tr",t._l(t.headers,(function(e,n){return a("th",{key:n,class:e.class,style:e.minWidth?"min-width:"+e.minWidth+"px":"",attrs:{width:e.width},on:{click:function(a){return t.onHeaderClicked(e)}}},[e.lAm>0||e.lRuikeiAm?a("v-badge",{attrs:{elevation:25,bottom:"",content:e.lRuikeiAm,color:"blue"}},[e.lAm>0||e.lRuikeiAm?a("v-badge",{attrs:{inline:!1,overlap:!1,content:e.lAm,color:e.lAm?"purple":"transparent"}},[a("v-tooltip",{attrs:{bottom:"","allow-overflow":""},scopedSlots:t._u([{key:"activator",fn:function(n){var r=n.on,i=n.attrs;return[a("span",t._g(t._b({},"span",i,!1),r),[t._v("\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t"+t._s(e.text)+"\n\t\t\t\t\t\t\t\t\t\t\t\t\t")])]}}],null,!0)},[t._v(" "),t.lineAmDetail[e.value]?a("span",[a("v-row",[t.lineAmDetail[e.value]["差"]?a("v-col",[a("v-banner",{staticClass:"px-2",attrs:{transition:"slide-y-transition",color:"purple lighten-3"},domProps:{innerHTML:t._s(t.lineAmDetail[e.value]["差"]||"")}})],1):t._e(),t._v(" "),t.lineAmDetail[e.value]["累計"]?a("v-col",[a("v-banner",{staticClass:"px-2",attrs:{transition:"slide-y-transition",color:"blue lighten-3"},domProps:{innerHTML:t._s(t.lineAmDetail[e.value]["累計"]||"")}})],1):t._e()],1)],1):t._e()])],1):t._e()],1):a("span",[t._v("\n\t\t\t\t\t\t\t\t\t\t"+t._s(e.text)+"\n\t\t\t\t\t\t\t\t\t")])],1)})),0)])]}},{key:"item",fn:function(e){return[a("tr",{class:""},t._l(t.getRows(e.item),(function(n,r){return a("td",{key:r,class:t.rowClass(e.item).concat(n.rowClass||[],[n.colVal<0||e.item[n.value+"_hs"]<0&&"実績"==e.item.C_NAME?"cell-negative":e.item[n.value+"_hs"]>0&&"実績"==e.item.C_NAME?"cell-num-over":""])},["計画"==e.item.C_NAME||r>3?a("span",[(e.item.C_NAME,t._e()),t._v(" "),"差"!=e.item.C_NAME&&"累計"!=e.item.C_NAME||!e.item[n.value+"_sttAm"]?"実績"==e.item.C_NAME&&e.item[n.value+"_C_HIN"]?a("span",[a("v-tooltip",{attrs:{top:""},scopedSlots:t._u([{key:"activator",fn:function(r){var i=r.on,l=r.attrs;return[a("span",t._g(t._b({on:{click:function(a){t.copyContent(e.item[n.value+"_C_HIN"].replaceAll(",","\n"))}}},"span",l,!1),i),[t._v("\n\t\t\t\t\t\t\t\t\t\t\t\t\t"+t._s(n.type&&"number"==n.type&&n.colVal?(""+n.colVal).replace(/(\d)(?=(\d{3})+(?!\d))/g,"$1,"):n.colVal)+"\n\t\t\t\t\t\t\t\t\t\t\t\t")])]}}],null,!0)},[t._v(" "),a("p",{domProps:{innerHTML:t._s(e.item[n.value+"_C_HIN"].replaceAll(",","<br/>"))}})])],1):a("span",[t._v("\n\t\t\t\t\t\t\t\t\t\t"+t._s(n.type&&"number"==n.type&&n.colVal?(""+n.colVal).replace(/(\d)(?=(\d{3})+(?!\d))/g,"$1,"):n.colVal)+"\n\t\t\t\t\t\t\t\t\t")]):a("v-badge",{attrs:{inline:!1,overlap:!1,content:e.item[n.value+"_sttAm"],color:"差"==e.item.C_NAME?"purple":"blue"}},[t._v("\n\t\t\t\t\t\t\t\t\t\t"+t._s(n.type&&"number"==n.type&&n.colVal?(""+n.colVal).replace(/(\d)(?=(\d{3})+(?!\d))/g,"$1,"):n.colVal)+"\n\t\t\t\t\t\t\t\t\t")])],1):t._e()])})),0)]}}])})],1)])],1),t._v(" "),a("v-dialog",{attrs:{"max-width":"500px"},model:{value:t.dialog_Edit_Ruikei,callback:function(e){t.dialog_Edit_Ruikei=e},expression:"dialog_Edit_Ruikei"}},[a("v-card",[a("v-card-title",[a("span",{staticClass:"text-h5"},[t._v("Chỉnh Sửa Lũy Kế")])]),t._v(" "),a("v-card-text",[a("v-container",[a("v-row",[a("v-col",{attrs:{cols:"12",sm:"6"}},[a("v-text-field",{attrs:{label:"LINE",disabled:""},model:{value:t.editedRuikei.C_LINE,callback:function(e){t.$set(t.editedRuikei,"C_LINE",e)},expression:"editedRuikei.C_LINE"}})],1),t._v(" "),a("v-col",{attrs:{cols:"12",sm:"6"}},[a("v-text-field",{attrs:{label:"Ngày Assy",disabled:""},model:{value:t.editedRuikei.DT_ASSY,callback:function(e){t.$set(t.editedRuikei,"DT_ASSY",e)},expression:"editedRuikei.DT_ASSY"}})],1),t._v(" "),a("v-col",{attrs:{cols:"12",sm:"6"}},[a("v-text-field",{attrs:{label:"Số Lũy Kế",clearable:""},model:{value:t.editedRuikei.RUIKEI,callback:function(e){t.$set(t.editedRuikei,"RUIKEI",e)},expression:"editedRuikei.RUIKEI"}})],1),t._v(" "),a("v-col",{attrs:{cols:"12",sm:"6"}},[a("v-text-field",{attrs:{label:"PASSWORD",clearable:"",type:"password"},model:{value:t.editedRuikei.pass,callback:function(e){t.$set(t.editedRuikei,"pass",e)},expression:"editedRuikei.pass"}})],1)],1)],1)],1),t._v(" "),a("v-card-actions",[a("v-spacer"),t._v(" "),a("v-btn",{attrs:{color:"gray darken-1",text:""},on:{click:function(e){t.dialog_Edit_Ruikei=!1}}},[t._v("\n\t\t\t\t\tCancel\n\t\t\t\t")]),t._v(" "),a("v-btn",{attrs:{color:"red darken-1",text:""},on:{click:t.tryUpdateRuikei}},[t._v("\n\t\t\t\t\tSave\n\t\t\t\t")])],1)],1)],1)],1)}),[],!1,null,null,null);e.default=M.exports;m()(M,{VBadge:f.a,VBanner:v.a,VBtn:x.a,VCard:b.a,VCardActions:C.b,VCardText:C.d,VCardTitle:C.e,VCol:_.a,VContainer:D.a,VDataTable:y.a,VDialog:E.a,VDivider:w.a,VHover:k.a,VIcon:A.a,VRow:N.a,VSpacer:O.a,VTextField:S.a,VToolbar:R.a,VTooltip:F.a})},970:function(t,e,a){var n=a(972),r=a(973),i=a(971);function l(t,e){var a=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),a.push.apply(a,n)}return a}function o(t){for(var e=1;e<arguments.length;e++){var a=null!=arguments[e]?arguments[e]:{};e%2?l(Object(a),!0).forEach((function(e){n(t,e,a[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(a)):l(Object(a)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(a,e))}))}return t}a(130),a(6),a(4),a(5),a(259),a(25),a(68),a(57),a(7),a(8),a(9),a(10);var c=a(968),s=a(237),u=function(){var t=i(regeneratorRuntime.mark((function t(e){var a,n,i,l,u,d,h,p,g,m,f=arguments;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return a=f.length>1&&void 0!==f[1]?f[1]:{sheetName:"sheet1",opts:{}},n=f.length>2&&void 0!==f[2]?f[2]:"Export",i=f.length>3&&void 0!==f[3]?f[3]:{expRaw:!1},l=new c.Workbook,u=l.addWorksheet(a.sheetName,a.opts),d={style:"thin",color:{argb:"974706"}},h={type:"pattern",pattern:"solid",fgColor:{argb:"FFFFFF00"}},Array.isArray(e)?e.length>0&&((p=Object.keys(e[0])).forEach((function(t,e){var a=u.getRow(1);a.getCell(e+1).font={bold:!0},a.getCell(e+1).value=t,a.getCell(e+1).border={top:d,left:d,bottom:d,right:d},a.getCell(e+1).fill=h,a.commit()})),u.views=[{state:"frozen",ySplit:1}],i.expRaw?e.forEach((function(t,e){var a=u.getRow(2+e);p.forEach((function(e,n){a.getCell(n+1).value=t[e]})),a.commit()})):(e.forEach((function(t,e){var a=u.getRow(2+e);p.forEach((function(e,n){a.getCell(n+1).value=t[e],a.getCell(n+1).border={top:d,left:d,bottom:d,right:d}})),a.commit()})),p.forEach((function(t,e){var a=u.getColumn(e+1),n=a.values.map((function(t){return t.toString().length})),i=Math.max.apply(Math,r(n.filter((function(t){return"number"==typeof t}))));i=i>t.length?i+5:t.length+5,a.width=i})))):e(u),t.next=10,l.xlsx.writeBuffer();case 10:if(g=t.sent,"string"!=typeof n){t.next=15;break}saveAs(new Blob([g]),n+".xlsx"),t.next=19;break;case 15:return t.next=17,s.post("http://172.25.216.213:3368/api/sendmail",{mailOpts:o({},n)});case 17:m=t.sent,console.log(m);case 19:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),d=function(){var t=i(regeneratorRuntime.mark((function t(e){var a,n,i,l,u,d,h,p,g,m=arguments;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(a=m.length>1&&void 0!==m[1]?m[1]:"Export",n=m.length>2&&void 0!==m[2]?m[2]:{sheetName:"sheet1",opts:{}},i=new c.Workbook,!Array.isArray(e)){t.next=10;break}l=i.addWorksheet(n.sheetName,n.opts),u={style:"thin",color:{argb:"974706"}},d={type:"pattern",pattern:"solid",fgColor:{argb:"FFFFFF00"}},e.length>0&&((h=Object.keys(e[0])).forEach((function(t,e){var a=l.getRow(1);a.getCell(e+1).font={bold:!0},a.getCell(e+1).value=t,a.getCell(e+1).border={top:u,left:u,bottom:u,right:u},a.getCell(e+1).fill=d,a.commit()})),l.views=[{state:"frozen",ySplit:1}],e.forEach((function(t,e){var a=l.getRow(2+e);h.forEach((function(e,n){a.getCell(n+1).value=t[e],a.getCell(n+1).border={top:u,left:u,bottom:u,right:u}})),a.commit()})),h.forEach((function(t,e){var a=l.getColumn(e+1),n=a.values.map((function(t){return t.toString().length})),i=Math.max.apply(Math,r(n.filter((function(t){return"number"==typeof t}))));i=i>t.length?i+5:t.length+5,a.width=i}))),t.next=12;break;case 10:return t.next=12,e(i);case 12:return t.next=14,i.xlsx.writeBuffer();case 14:if(p=t.sent,"string"!=typeof a){t.next=19;break}saveAs(new Blob([p]),a+".xlsx"),t.next=23;break;case 19:return t.next=21,s.post("http://172.25.216.213:3368/api/sendmail",{mailOpts:o({},a)});case 21:g=t.sent,console.log(g);case 23:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),h=function(){var t=i(regeneratorRuntime.mark((function t(e,a){var n,r;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:n=new FileReader,r=new c.Workbook,n.readAsArrayBuffer(e),n.onload=i(regeneratorRuntime.mark((function t(){var e;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e=n.result,t.next=3,r.xlsx.load(e);case 3:"function"==typeof a&&a(r);case 4:case"end":return t.stop()}}),t)})));case 4:case"end":return t.stop()}}),t)})));return function(e,a){return t.apply(this,arguments)}}();t.exports={excelJSExport:u,excelJSReadFile:h,excelJSExportWB:d}},983:function(t,e,a){var n=a(1033);n.__esModule&&(n=n.default),"string"==typeof n&&(n=[[t.i,n,""]]),n.locals&&(t.exports=n.locals);(0,a(13).default)("298aacd3",n,!0,{sourceMap:!1})}}]);